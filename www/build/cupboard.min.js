!function(t){var e=window.webpackHotUpdate;window.webpackHotUpdate=function(t,i){!function(t,e){if(!v[t]||!y[t])return;for(var i in y[t]=!1,e)Object.prototype.hasOwnProperty.call(e,i)&&(p[i]=e[i]);0==--m&&0===x&&I()}(t,i),e&&e(t,i)};var i,n=!0,a="f22063cac0ad2f94ef84",r=1e4,s={},o=[],h=[];function A(t){var e=T[t];if(!e)return P;var n=function(n){return e.hot.active?(T[n]?-1===T[n].parents.indexOf(t)&&T[n].parents.push(t):(o=[t],i=n),-1===e.children.indexOf(n)&&e.children.push(n)):(console.warn("[HMR] unexpected require("+n+") from disposed module "+t),o=[]),P(n)},a=function(t){return{configurable:!0,enumerable:!0,get:function(){return P[t]},set:function(e){P[t]=e}}};for(var r in P)Object.prototype.hasOwnProperty.call(P,r)&&"e"!==r&&"t"!==r&&Object.defineProperty(n,r,a(r));return n.e=function(t){return"ready"===d&&c("prepare"),x++,P.e(t).then(e,function(t){throw e(),t});function e(){x--,"prepare"===d&&(b[t]||E(t),0===x&&0===m&&I())}},n.t=function(t,e){return 1&e&&(t=n(t)),P.t(t,-2&e)},n}function l(t){var e={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:i!==t,active:!0,accept:function(t,i){if(void 0===t)e._selfAccepted=!0;else if("function"==typeof t)e._selfAccepted=t;else if("object"==typeof t)for(var n=0;n<t.length;n++)e._acceptedDependencies[t[n]]=i||function(){};else e._acceptedDependencies[t]=i||function(){}},decline:function(t){if(void 0===t)e._selfDeclined=!0;else if("object"==typeof t)for(var i=0;i<t.length;i++)e._declinedDependencies[t[i]]=!0;else e._declinedDependencies[t]=!0},dispose:function(t){e._disposeHandlers.push(t)},addDisposeHandler:function(t){e._disposeHandlers.push(t)},removeDisposeHandler:function(t){var i=e._disposeHandlers.indexOf(t);i>=0&&e._disposeHandlers.splice(i,1)},check:w,apply:C,status:function(t){if(!t)return d;u.push(t)},addStatusHandler:function(t){u.push(t)},removeStatusHandler:function(t){var e=u.indexOf(t);e>=0&&u.splice(e,1)},data:s[t]};return i=void 0,e}var u=[],d="idle";function c(t){d=t;for(var e=0;e<u.length;e++)u[e].call(null,t)}var f,p,g,m=0,x=0,b={},y={},v={};function _(t){return+t+""===t?+t:t}function w(t){if("idle"!==d)throw new Error("check() is only allowed in idle status");return n=t,c("check"),(e=r,e=e||1e4,new Promise(function(t,i){if("undefined"==typeof XMLHttpRequest)return i(new Error("No browser support"));try{var n=new XMLHttpRequest,r=P.p+""+a+".hot-update.json";n.open("GET",r,!0),n.timeout=e,n.send(null)}catch(t){return i(t)}n.onreadystatechange=function(){if(4===n.readyState)if(0===n.status)i(new Error("Manifest request to "+r+" timed out."));else if(404===n.status)t();else if(200!==n.status&&304!==n.status)i(new Error("Manifest request to "+r+" failed."));else{try{var e=JSON.parse(n.responseText)}catch(t){return void i(t)}t(e)}}})).then(function(t){if(!t)return c("idle"),null;y={},b={},v=t.c,g=t.h,c("prepare");var e=new Promise(function(t,e){f={resolve:t,reject:e}});p={};return E(0),"prepare"===d&&0===x&&0===m&&I(),e});var e}function E(t){v[t]?(y[t]=!0,m++,function(t){var e=document.createElement("script");e.charset="utf-8",e.src=P.p+""+t+"."+a+".hot-update.js",document.head.appendChild(e)}(t)):b[t]=!0}function I(){c("ready");var t=f;if(f=null,t)if(n)Promise.resolve().then(function(){return C(n)}).then(function(e){t.resolve(e)},function(e){t.reject(e)});else{var e=[];for(var i in p)Object.prototype.hasOwnProperty.call(p,i)&&e.push(_(i));t.resolve(e)}}function C(e){if("ready"!==d)throw new Error("apply() is only allowed in ready status");var i,n,r,h,A;function l(t){for(var e=[t],i={},n=e.slice().map(function(t){return{chain:[t],id:t}});n.length>0;){var a=n.pop(),r=a.id,s=a.chain;if((h=T[r])&&!h.hot._selfAccepted){if(h.hot._selfDeclined)return{type:"self-declined",chain:s,moduleId:r};if(h.hot._main)return{type:"unaccepted",chain:s,moduleId:r};for(var o=0;o<h.parents.length;o++){var A=h.parents[o],l=T[A];if(l){if(l.hot._declinedDependencies[r])return{type:"declined",chain:s.concat([A]),moduleId:r,parentId:A};-1===e.indexOf(A)&&(l.hot._acceptedDependencies[r]?(i[A]||(i[A]=[]),u(i[A],[r])):(delete i[A],e.push(A),n.push({chain:s.concat([A]),id:A})))}}}}return{type:"accepted",moduleId:t,outdatedModules:e,outdatedDependencies:i}}function u(t,e){for(var i=0;i<e.length;i++){var n=e[i];-1===t.indexOf(n)&&t.push(n)}}e=e||{};var f={},m=[],x={},b=function(){console.warn("[HMR] unexpected require("+w.moduleId+") to disposed module")};for(var y in p)if(Object.prototype.hasOwnProperty.call(p,y)){var w;A=_(y);var E=!1,I=!1,C=!1,M="";switch((w=p[y]?l(A):{type:"disposed",moduleId:y}).chain&&(M="\nUpdate propagation: "+w.chain.join(" -> ")),w.type){case"self-declined":e.onDeclined&&e.onDeclined(w),e.ignoreDeclined||(E=new Error("Aborted because of self decline: "+w.moduleId+M));break;case"declined":e.onDeclined&&e.onDeclined(w),e.ignoreDeclined||(E=new Error("Aborted because of declined dependency: "+w.moduleId+" in "+w.parentId+M));break;case"unaccepted":e.onUnaccepted&&e.onUnaccepted(w),e.ignoreUnaccepted||(E=new Error("Aborted because "+A+" is not accepted"+M));break;case"accepted":e.onAccepted&&e.onAccepted(w),I=!0;break;case"disposed":e.onDisposed&&e.onDisposed(w),C=!0;break;default:throw new Error("Unexception type "+w.type)}if(E)return c("abort"),Promise.reject(E);if(I)for(A in x[A]=p[A],u(m,w.outdatedModules),w.outdatedDependencies)Object.prototype.hasOwnProperty.call(w.outdatedDependencies,A)&&(f[A]||(f[A]=[]),u(f[A],w.outdatedDependencies[A]));C&&(u(m,[w.moduleId]),x[A]=b)}var S,F=[];for(n=0;n<m.length;n++)A=m[n],T[A]&&T[A].hot._selfAccepted&&F.push({module:A,errorHandler:T[A].hot._selfAccepted});c("dispose"),Object.keys(v).forEach(function(t){!1===v[t]&&function(t){delete installedChunks[t]}(t)});for(var D,R,B=m.slice();B.length>0;)if(A=B.pop(),h=T[A]){var j={},O=h.hot._disposeHandlers;for(r=0;r<O.length;r++)(i=O[r])(j);for(s[A]=j,h.hot.active=!1,delete T[A],delete f[A],r=0;r<h.children.length;r++){var N=T[h.children[r]];N&&((S=N.parents.indexOf(A))>=0&&N.parents.splice(S,1))}}for(A in f)if(Object.prototype.hasOwnProperty.call(f,A)&&(h=T[A]))for(R=f[A],r=0;r<R.length;r++)D=R[r],(S=h.children.indexOf(D))>=0&&h.children.splice(S,1);for(A in c("apply"),a=g,x)Object.prototype.hasOwnProperty.call(x,A)&&(t[A]=x[A]);var L=null;for(A in f)if(Object.prototype.hasOwnProperty.call(f,A)&&(h=T[A])){R=f[A];var H=[];for(n=0;n<R.length;n++)if(D=R[n],i=h.hot._acceptedDependencies[D]){if(-1!==H.indexOf(i))continue;H.push(i)}for(n=0;n<H.length;n++){i=H[n];try{i(R)}catch(t){e.onErrored&&e.onErrored({type:"accept-errored",moduleId:A,dependencyId:R[n],error:t}),e.ignoreErrored||L||(L=t)}}}for(n=0;n<F.length;n++){var Q=F[n];A=Q.module,o=[A];try{P(A)}catch(t){if("function"==typeof Q.errorHandler)try{Q.errorHandler(t)}catch(i){e.onErrored&&e.onErrored({type:"self-accept-error-handler-errored",moduleId:A,error:i,originalError:t}),e.ignoreErrored||L||(L=i),L||(L=t)}else e.onErrored&&e.onErrored({type:"self-accept-errored",moduleId:A,error:t}),e.ignoreErrored||L||(L=t)}}return L?(c("fail"),Promise.reject(L)):(c("idle"),new Promise(function(t){t(m)}))}var T={};function P(e){if(T[e])return T[e].exports;var i=T[e]={i:e,l:!1,exports:{},hot:l(e),parents:(h=o,o=[],h),children:[]};return t[e].call(i.exports,i,i.exports,A(e)),i.l=!0,i.exports}P.m=t,P.c=T,P.d=function(t,e,i){P.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},P.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},P.t=function(t,e){if(1&e&&(t=P(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(P.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)P.d(i,n,function(e){return t[e]}.bind(null,n));return i},P.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return P.d(e,"a",e),e},P.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},P.p="build/",P.h=function(){return a},A(30)(P.s=30)}([function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){"use strict";(function(t){i.d(e,"a",function(){return s});var n=i(11),a=i(12);function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=function(){function e(i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.type="CPGron";var s=this;this.par=i,this.fun=r,this.idArr=-1,this.uuid=calc.generateRendom(2),this._boolOut=!1,this._width=100,this._height=100,this.content3d=new THREE.Object3D,this.par.content3d.add(this.content3d);var o=new THREE.AxesHelper(50);this.content3d.add(o),this.geometry=new a.a,this.mesh=new THREE.Mesh(this.geometry,t.pm.mat.getId("m_6",function(){})),this.content3d.add(this.mesh),this.mesh.rotation.x=-Math.PI/2,this.draw=function(){this.geometry._rect.w===this._width&&this.geometry._rect.h===this._height||this.geometry.setRect(0,0,this._width,this._height),null!=this.outlin&&(this.outlin.content3d.position.z=-this._height,this.outlin.content3d.position.x=this._width/2,this.outlin.content3d.rotation.x=Math.PI,this.outlin.content3d.rotation.y=Math.PI/2,this.outlin.width=this._width,this.outlin.height=this._height)},this.outlin=void 0,this.initOut=function(){null==this.outlin&&(this.outlin=new n.a(this),this.outlin.materialName="m_4",t.pm.getId(19,function(t){for(var e,i,n,a=0;a<t.children.length;a++)"m_0_"==t.children[a].name&&(e=t.children[a].geometry),"m_1_"==t.children[a].name&&(i=t.children[a].geometry),"m_2_"==t.children[a].name&&(n=t.children[a].geometry);s.outlin.setGeometrys(e,i,n),s.outlin.setWH(s._width,s._height),s.fun("dragMy")}))}}var i,s,o;return i=e,(s=[{key:"boolOut",set:function(t){this._boolOut!=t&&(this._boolOut=t,this.initOut(),this.outlin.content3d.visible=t,this.draw())},get:function(){return this._boolOut}},{key:"width",set:function(t){this._width!=t&&(this._width=t,this.draw())},get:function(){return this._width}},{key:"height",set:function(t){this._height!=t&&(this._height=t,this.draw())},get:function(){return this._height}}])&&r(i.prototype,s),o&&r(i,o),e}()}).call(this,i(0))},function(t,e,i){"use strict";function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}i.d(e,"a",function(){return a});var a=function(){function t(e,i,n,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="Blok",this.typeConst="Blok";var r,s,o=this;this.uuid=Math.random(),this.children=[],this.boolDinColor=!1,this.object=i,this._material=e.mat2.idObj.id,this.idArr=n,this.fun=a,this.mO=e,this.id=i.id,this.link="resources/data/"+this.id+"/original.png",this.aa=["copy","clear"],this.funDrag=void 0,this.funInitMod=void 0,this.durXY=void 0,this.durRect=void 0,this.content3d=new THREE.Object3D,this.content3d.blok=this,this.c3dNa=new THREE.Object3D,this.content3d.add(this.c3dNa),this.clear=function(t){},this.rect=[],this.rect1=[];for(var h=0;h<i.mod.r.length;h++)this.rect[h]=i.mod.r[h];for(h=0;h<i.mod.r1.length;h++)this.rect1[h]=i.mod.r1[h];this.setXYPosit=function(t,e,i){o.content3d.position.x=t,o.content3d.position.y=e,o.content3d.position.z=i},this.dragObjNWD=function(){this.fun("tickInfo"),null!=this.funDrag&&this.funDrag(),this.fun("visi3d")},this.dragObjHA=function(t,e){},this.dragColor=function(){},this.funInit=void 0,this.modelObj,this.init=function(t){null!=o.funInitMod&&o.funInitMod()},this.dragObjNWD(),this.add=function(t){this.remove(t),this.content3d.add(t.content3d),this.children.push(t),t.parent=this},this.remove=function(t){for(var e=-1,i=null,n=0;n<this.children.length;n++)this.children[n].idArr==t.idArr&&(e=n);return-1!=e&&(i=this.children.splice(e,1)[0],this.content3d.remove(t.content3d),i.parent=void 0),i},this.funSetInfo=void 0,this.objInfo={},this.objInfo.type=this.type,this.objInfo.id=this.id,this.objInfo.object=this.object,this.getArrayInfo=function(t){this.funSetInfo&&this.funSetInfo(),t.push(this.objInfo);for(var e=0;e<this.children.length;e++)this.children[e].getArrayInfo(t)},this.getObj=function(){var t={};t.type=this.type,t.id=this.id,t.x=o.content3d.position.x,t.y=o.content3d.position.y,t.z=o.content3d.position.z,t.children=[];for(var e=0;e<this.children.length;e++)t.children[e]=this.children[e].getObj();return t},this.setObj=function(t){this.setXYPosit(t.x,t.y,t.z),t.children;for(var i=0;i<t.children.length;i++)s=e.getIdObj(t.children[i].id),(r=e.getBlok(s.obj)).setObj(t.children[i]),this.add(r);return t},this.sobKey=function(t,e,i){}}var e,i,a;return e=t,(i=[{key:"x",set:function(t){this._x!=t&&(this._x=t)},get:function(){return this._x}},{key:"material",set:function(t){if(this._material!=t){this._material=t;for(var e=0;e<this.children.length;e++)this.children[e].material=t;this.dragColor()}},get:function(){return this._material}},{key:"parent",set:function(t){this._parent!=t&&(this._parent=t,null==this._parent?this.mO.visi3D.event3DArr.removeChild(this.content3d):this.mO.visi3D.event3DArr.addChild(this.content3d))},get:function(){return this._parent}}])&&n(e.prototype,i),a&&n(e,a),t}()},function(t,e,i){"use strict";i.d(e,"a",function(){return n});var n=function(t){THREE.DataTextureLoader.call(this,t),this.type=THREE.UnsignedByteType};n.prototype=Object.assign(Object.create(THREE.DataTextureLoader.prototype),{constructor:n,parse:function(t){var e=function(t,e){switch(t){case 1:console.error("RGBELoader Read Error: "+(e||""));break;case 2:console.error("RGBELoader Write Error: "+(e||""));break;case 3:console.error("RGBELoader Bad File Format: "+(e||""));break;default:case 4:console.error("RGBELoader: Error: "+(e||""))}return-1},i=function(t,e,i){e=e||1024;for(var n=t.pos,a=-1,r=0,s="",o=String.fromCharCode.apply(null,new Uint16Array(t.subarray(n,n+128)));0>(a=o.indexOf("\n"))&&r<e&&n<t.byteLength;)s+=o,r+=o.length,n+=128,o+=String.fromCharCode.apply(null,new Uint16Array(t.subarray(n,n+128)));return-1<a&&(!1!==i&&(t.pos+=r+a+1),s+o.slice(0,a))},n=function(){var t=new Float32Array(1),e=new Int32Array(t.buffer);function i(i){t[0]=i;var n=e[0],a=n>>16&32768,r=n>>12&2047,s=n>>23&255;return s<103?a:s>142?(a|=31744,a|=(255==s?0:1)&&8388607&n):s<113?a|=((r|=2048)>>114-s)+(r>>113-s&1):(a|=s-112<<10|r>>1,a+=1&r)}return function(t,e,n,a){var r=t[e+3],s=Math.pow(2,r-128)/255;n[a+0]=i(t[e+0]*s),n[a+1]=i(t[e+1]*s),n[a+2]=i(t[e+2]*s)}}(),a=new Uint8Array(t);a.pos=0;var r,s,o,h,A,l,u=function(t){var n,a,r=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,o=/^\s*FORMAT=(\S+)\s*$/,h=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,A={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(t.pos>=t.byteLength||!(n=i(t)))return e(1,"no header found");if(!(a=n.match(/^#\?(\S+)$/)))return e(3,"bad initial token");for(A.valid|=1,A.programtype=a[1],A.string+=n+"\n";!1!==(n=i(t));)if(A.string+=n+"\n","#"!==n.charAt(0)){if((a=n.match(r))&&(A.gamma=parseFloat(a[1],10)),(a=n.match(s))&&(A.exposure=parseFloat(a[1],10)),(a=n.match(o))&&(A.valid|=2,A.format=a[1]),(a=n.match(h))&&(A.valid|=4,A.height=parseInt(a[1],10),A.width=parseInt(a[2],10)),2&A.valid&&4&A.valid)break}else A.comments+=n+"\n";return 2&A.valid?4&A.valid?A:e(3,"missing image size specifier"):e(3,"missing format specifier")}(a);if(-1!==u){var d=u.width,c=u.height,f=function(t,i,n){var a,r,s,o,h,A,l,u,d,c,f,p,g,m=i,x=n;if(m<8||m>32767||2!==t[0]||2!==t[1]||128&t[2])return new Uint8Array(t);if(m!==(t[2]<<8|t[3]))return e(3,"wrong scanline width");if(!(a=new Uint8Array(4*i*n))||!a.length)return e(4,"unable to allocate buffer space");for(r=0,s=0,u=4*m,g=new Uint8Array(4),A=new Uint8Array(u);x>0&&s<t.byteLength;){if(s+4>t.byteLength)return e(1);if(g[0]=t[s++],g[1]=t[s++],g[2]=t[s++],g[3]=t[s++],2!=g[0]||2!=g[1]||(g[2]<<8|g[3])!=m)return e(3,"bad rgbe scanline format");for(l=0;l<u&&s<t.byteLength;){if((p=(o=t[s++])>128)&&(o-=128),0===o||l+o>u)return e(3,"bad scanline data");if(p)for(h=t[s++],d=0;d<o;d++)A[l++]=h;else A.set(t.subarray(s,s+o),l),l+=o,s+=o}for(c=m,d=0;d<c;d++)f=0,a[r]=A[d+f],f+=m,a[r+1]=A[d+f],f+=m,a[r+2]=A[d+f],f+=m,a[r+3]=A[d+f],r+=4;x--}return a}(a.subarray(a.pos),d,c);if(-1!==f){switch(this.type){case THREE.UnsignedByteType:var p=f,g=THREE.RGBEFormat,m=THREE.UnsignedByteType;break;case THREE.FloatType:for(var x=f.length/4*3,b=new Float32Array(x),y=0;y<x;y++)o=b,h=3*y,A=void 0,l=void 0,A=(r=f)[(s=4*y)+3],l=Math.pow(2,A-128)/255,o[h+0]=r[s+0]*l,o[h+1]=r[s+1]*l,o[h+2]=r[s+2]*l;p=b,g=THREE.RGBFormat,m=THREE.FloatType;break;case THREE.HalfFloatType:x=f.length/4*3;var v=new Uint16Array(x);for(y=0;y<x;y++)n(f,4*y,v,3*y);p=v,g=THREE.RGBFormat,m=THREE.HalfFloatType;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:d,height:c,data:p,header:u.string,gamma:u.gamma,exposure:u.exposure,format:g,type:m}}}return null},setDataType:function(t){return this.type=t,this},load:function(t,e,i,n){return THREE.DataTextureLoader.prototype.load.call(this,t,function(t,i){switch(t.type){case THREE.UnsignedByteType:t.encoding=THREE.RGBEEncoding,t.minFilter=THREE.NearestFilter,t.magFilter=THREE.NearestFilter,t.generateMipmaps=!1,t.flipY=!0;break;case THREE.FloatType:case THREE.HalfFloatType:t.encoding=THREE.LinearEncoding,t.minFilter=THREE.LinearFilter,t.magFilter=THREE.LinearFilter,t.generateMipmaps=!1,t.flipY=!0}e&&e(t,i)},i,n)}})},function(t,e,i){"use strict";var n=i(6);function a(t,e){this.fun=t;var i,n=this;this.object,this.key=e||"shirt",this.object,this.initLoad=function(){i=!0,this.object=window.localStorage[this.key],"undefined"==this.object&&(i=!1),null==this.object&&(i=!1),this.object=0==i?this.getStartObj():jQuery.parseJSON(this.object),this.fun&&n.fun()},this.getStartObj=function(){return{activ:!1,dubag:!1,menu:{},xz:{}}},this.save=function(){window.localStorage[this.key]=JSON.stringify(n.object)},this.clear=function(){window.localStorage[this.key]=void 0},n.initLoad()}i.d(e,"a",function(){return r});var r=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="LMain",this.fun=e;var i=this;this.glaf=null,this._width=100,this._height=100,i.resolution=1,i.objectBase=null,i.confText=null,this.localStorage=void 0,this.debug=!1,this.contentHTML=document.createElement("div"),this.contentHTML.style.position="fixed",this.contentHTML.style.top="0px",this.contentHTML.style.left="0px",document.body.appendChild(this.contentHTML),this.param={},this.param.otstup=5,this.param.wh=64,this.param.debug=!0,this.start=function(){for(var t in this.tick(),this.localStorage=new a(null,"localStorage111"),null==i.localStorage.object.debug&&(i.localStorage.object.debug=!1),i.localStorage.object)null!=this.param[t]&&(this.param[t]=i.localStorage.object[t]);this.debug=i.localStorage.object.debug,this.fina()},this.fina=function(){i.localStorage.object.debug=!0,i.glaf=new n.a(i),sizeWindow(),e("init")};var r,s=!0;this.tick=function(){1==(s=!s)&&(TWEEN.update(),i.glaf&&i.glaf.update()),requestAnimationFrame(i.tick)},this.boolCTRL=!1,this.keydown=function(t){null!=i.glaf&&(17==event.keyCode&&(i.boolCTRL=!0),81==event.keyCode&&i.boolCTRL&&(i.localStorage.object.debug=!i.localStorage.object.debug,i.localStorage.save()),i.glaf.keydown(t))},this.keyup=function(t){null!=i.glaf&&(17==event.keyCode&&(i.boolCTRL=!1),i.glaf.keyup(t))},window.addEventListener("keydown",this.keydown),window.addEventListener("keyup",this.keyup),this.scale=1,this.sizeWindow=function(t,e){i._width=t,i._height=e,i._width<800&&(i._width=800),i._height<600&&(i._height=600),(r=t/i._width)>e/i._height&&(r=e/i._height),this.scale=r,this.scale=1,1==dcmParam.isIE&&(this.scale=1),i.glaf&&i.glaf.sizeWindow(t,e,this.scale)},$.ajax({url:"resources/config.json",success:function(t){if("string"==typeof t){var e=JSON.parse(t);i.objectBase=e}else i.objectBase=t;i.start()},error:function(t){console.log("Что то случилось с конфигом")}})}},function(t,e,i){"use strict";i.d(e,"a",function(){return a});var n=i(3);function a(){var t,e=this;this.type="CubeMap",this.LINK="null",this.EXPOSURE=-1,this.GAMMA=-1,this._link="nullXZ",this._exposure=this.EXPOSURE,this._gamma=this.GAMMA,this.exposureStart=-1,this.gammaStart=-1,this._activDiz=!1,this._layer=1,this.otherLayer=31,this.renderer=void 0,this.scene=void 0,this.cubeCamera=new THREE.CubeCamera(1,1e4,512),this.geometry=new THREE.SphereBufferGeometry(1500,32,32),this.mesh=new THREE.Mesh(this.geometry),this.loader=void 0,this.loader=new n.a,this.init=function(t,e){void 0!==t&&void 0!==e&&(this.renderer=t,this.scene=e,this.scene.add(this.cubeCamera),this.scene.add(this.mesh),this.link="null")},this.setLayers=function(t){e.mesh.layers.set(t),e.cubeCamera.layers.set(t),e.cubeCamera.traverse(function(e){e.layers.set(t)})},this.upDate=function(t){this.setLayers(this.otherLayer),this.cubeCamera.update(t||this.renderer,this.scene),this.setLayers(this._layer)},this.material=void 0,this.dragMaterial=function(t){this.material=t,i==t.sahMin&&(this.mesh.material=t,this.upDate())},this.arrMat=[],this.testBD=function(t){for(var e=0;e<this.arrMat.length;e++)if(this.arrMat[e].linkMy==t)return this.arrMat[e];return null};var i=0;this.loadFun=function(){var n=++i,r=this._link+"";if(null!=(t=this.testBD(this._link))&&(t.sahMin=i,this.dragMaterial(t)),"null"!=this._link&&null!=this._link)-1==this._link.indexOf(".png")&&-1==this._link.indexOf(".jpg")&&-1==this._link.indexOf(".jpeg")?null!=this.loader?this.loader.load(this._link,function(t,i){var s=new THREE.ShaderMaterial({uniforms:{tDiffuse:{type:"t",value:t},exposure:{type:"f",value:i.exposure},gamma:{type:"f",value:i.gamma},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)}},vertexShader:a.vertex,fragmentShader:a.fragment});t.minFilter=THREE.LinearFilter,t.magFilter=THREE.NearestFilter,t.flipY=!0,t.wrapS=t.wrapT=THREE.RepeatWrapping,t.anisotropy=e.renderer.capabilities.getMaxAnisotropy(),s.side=THREE.BackSide,s.linkMy=r,s.sahMin=n,e.arrMat.push(s),e.dragMaterial(s),e.exposureStart=i.exposure,e.gammaStart=i.gamma,1==e._activDiz&&(e._exposure=i.exposure,e._gamma=i.gamma)}):console.log("Подключи в загрущик RGBELoader токо если надо hdr загрузить!!!"):(new THREE.TextureLoader).load(this._link,s);else{(new THREE.TextureLoader).load("data:image/jpeg;base64,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UmdzTWJvb2wAAAAAAENybkNib29sAAAAAABDbnRDYm9vbAAAAAAATGJsc2Jvb2wAAAAAAE5ndHZib29sAAAAAABFbWxEYm9vbAAAAAAASW50cmJvb2wAAAAAAEJja2dPYmpjAAAAAQAAAAAAAFJHQkMAAAADAAAAAFJkICBkb3ViQG/gAAAAAAAAAAAAR3JuIGRvdWJAb+AAAAAAAAAAAABCbCAgZG91YkBv4AAAAAAAAAAAAEJyZFRVbnRGI1JsdAAAAAAAAAAAAAAAAEJsZCBVbnRGI1JsdAAAAAAAAAAAAAAAAFJzbHRVbnRGI1B4bEBSAAAAAAAAAAAACnZlY3RvckRhdGFib29sAQAAAABQZ1BzZW51bQAAAABQZ1BzAAAAAFBnUEMAAAAATGVmdFVudEYjUmx0AAAAAAAAAAAAAAAAVG9wIFVudEYjUmx0AAAAAAAAAAAAAAAAU2NsIFVudEYjUHJjQFkAAAAAAAAAAAAQY3JvcFdoZW5QcmludGluZ2Jvb2wAAAAADmNyb3BSZWN0Qm90dG9tbG9uZwAAAAAAAAAMY3JvcFJlY3RMZWZ0bG9uZwAAAAAAAAANY3JvcFJlY3RSaWdodGxvbmcAAAAAAAAAC2Nyb3BSZWN0VG9wbG9uZwAAAAAAOEJJTQPtAAAAAAAQAEgAAAABAAIASAAAAAEAAjhCSU0EJgAAAAAADgAAAAAAAAAAAAA/gAAAOEJJTQQNAAAAAAAEAAAAeDhCSU0EGQAAAAAABAAAAB44QklNA/MAAAAAAAkAAAAAAAAAAAEAOEJJTScQAAAAAAAKAAEAAAAAAAAAAjhCSU0D9QAAAAAASAAvZmYAAQBsZmYABgAAAAAAAQAvZmYAAQChmZoABgAAAAAAAQAyAAAAAQBaAAAABgAAAAAAAQA1AAAAAQAtAAAABgAAAAAAAThCSU0D+AAAAAAAcAAA/////////////////////////////wPoAAAAAP////////////////////////////8D6AAAAAD/////////////////////////////A+gAAAAA/////////////////////////////wPoAAA4QklNBAAAAAAAAAIAQzhCSU0EAgAAAAAAiAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA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Lm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDE4LTEwLTA1VDE2OjMzOjQwKzAzOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE4LTEwLTA1VDE2OjMzOjQwKzAzOjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOC0xMC0wNVQxNjozMzo0MCswMzowMCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpBNDI1QjQxNkEzQzhFODExODIxNzhEQTQ1NUFCNTJGMCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpBMzI1QjQxNkEzQzhFODExODIxNzhEQTQ1NUFCNTJGMCIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOkEzMjVCNDE2QTNDOEU4MTE4MjE3OERBNDU1QUI1MkYwIiBkYzpmb3JtYXQ9ImltYWdlL2pwZWciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6QTMyNUI0MTZBM0M4RTgxMTgyMTc4REE0NTVBQjUyRjAiIHN0RXZ0OndoZW49IjIwMTgtMTAtMDVUMTY6MzM6NDArMDM6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDUzYgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpBNDI1QjQxNkEzQzhFODExODIxNzhEQTQ1NUFCNTJGMCIgc3RFdnQ6d2hlbj0iMjAxOC0xMC0wNVQxNjozMzo0MCswMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDw/eHBhY2tldCBlbmQ9InciPz7/4gxYSUNDX1BST0ZJTEUAAQEAAAxITGlubwIQAABtbnRyUkdCIFhZWiAHzgACAAkABgAxAABhY3NwTVNGVAAAAABJRUMgc1JHQgAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLUhQICAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABFjcHJ0AAABUAAAADNkZXNjAAABhAAAAGx3dHB0AAAB8AAAABRia3B0AAACBAAAABRyWFlaAAACGAAAABRnWFlaAAACLAAAABRiWFlaAAACQAAAABRkbW5kAAACVAAAAHBkbWRkAAACxAAAAIh2dWVkAAADTAAAAIZ2aWV3AAAD1AAAACRsdW1p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",s)}function s(t){t.minFilter=THREE.LinearFilter,t.magFilter=THREE.NearestFilter,t.flipY=!0,t.wrapS=t.wrapT=THREE.RepeatWrapping,t.anisotropy=e.renderer.capabilities.getMaxAnisotropy();var i=new THREE.MeshBasicMaterial({map:t,side:THREE.BackSide});i.linkMy=r,i.sahMin=n,e.arrMat.push(i),e.dragMaterial(i)}},this.getTexture=function(){return this.cubeCamera.renderTarget.texture};var a={vertex:["uniform vec4 offsetRepeat;","varying vec2 vUv;","void main() {","    // vUv  = uv;","    vUv = uv * offsetRepeat.zw + offsetRepeat.xy;","    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 3);","}"].join("\n"),fragment:["uniform sampler2D   tDiffuse;","uniform float       exposure;","uniform float       gamma;","varying vec2  vUv;","vec3 decode_pnghdr( const in vec4 color ) {","    vec4 rgbcolor = vec4( 0.0, 0.0, 0.0, 0.0 );","    if ( color.w > 0.0 ) {","        float f = pow(2.0, 127.0*(color.w-0.5));","        rgbcolor.xyz = color.xyz * f;","    }","    return rgbcolor.xyz;","    /*","    // remove gamma correction","    vec4 res = color * color;","    // decoded RI","    float ri = pow( 2.0, res.w * 32.0 - 16.0 );","    // decoded HDR pixel","    res.xyz = res.xyz * ri;","    return res.xyz;","    */","}","void main() {","    vec4 color = texture2D( tDiffuse, vUv );","    color.xyz  = decode_pnghdr( color );","    // apply gamma correction and exposure","    //gl_FragColor = vec4( pow( exposure * color.xyz, vec3( 0.474 ) ), 1.0 );","    // Perform tone-mapping","    float Y = dot(vec4(0.30, 0.59, 0.11, 0.0), color);","    float YD = exposure * (exposure/gamma + 1.0) / (exposure + 1.0);","    color *= YD;","    gl_FragColor = vec4( color.xyz, 1.0 );","}"].join("\n")};this.debug=!1}Object.defineProperties(a.prototype,{link:{set:function(t){this._link!=t&&(this._link=t,this.loadFun())},get:function(){return this._link}},activDiz:{set:function(t){this._activDiz!=t&&(this._activDiz=t)},get:function(){return this._activDiz}},exposure:{set:function(t){this._exposure!=t&&(this._exposure=t,this.material&&null!=this.material.uniforms&&(this.material.uniforms.exposure.value=t,this.upDate()))},get:function(){return this._exposure}},gamma:{set:function(t){this._gamma!=t&&(this._gamma=t,this.material&&null!=this.material.uniforms&&(this.material.uniforms.gamma.value=t,this.upDate()))},get:function(){return this._gamma}},debug:{set:function(t){this._debug!=t&&(this._debug=t,this._layer=t?0:31,this.setLayers(this._layer))},get:function(){return this._debug}}})},function(t,e,i){"use strict";(function(t){i.d(e,"a",function(){return A});var n=i(7),a=i(14),r=i(29),s=i(19),o=i(21),h=i(22);var A=function e(i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.type="Glaf";var A=this;this.par=i,this.sizeMax=1e4,this.dCont=new DCont(document.body),this._intRend=-60,this.render=function(){A.visi3D.intRend=1},this.param=this.par.param,t.calc=new h.a,this.div=document.createElement("div"),this.div.style.position="fixed",this.div.style.top="0px",this.div.style.left="0px",this.content3D=new THREE.Object3D,this.visi3D=new s.a(this.div,null,!1,!0,!1,!0,!1),this.visi3D.sizeWindow(0,0,window.innerWidth,window.innerHeight),this.visi3D.groupObject.add(this.content3D),this.visi3D.isDragPan=!0,this.dCont.div.appendChild(this.div);var l=this.par.objectBase.scene;this.sceneSB=new o.a(this.visi3D);for(var u=0;u<this.sceneSB.array.length;u++)void 0===l[this.sceneSB.array[u].name]&&(l[this.sceneSB.array[u].name]={}),this.sceneSB.array[u].setBasa(l[this.sceneSB.array[u].name]);this.menu=new a.a(this,function(t,e,i){"material"==t&&(A.world.material=e),A.render()}),this.world=new n.a(this,function(t,e,i){if("render"!=t)if("activeObject"!=t){if("getInfo"!==t)return"initDone"==t?(trace(A.menu.transferObj,e),void A.menu.transferObj(e)):void A.render();A.menu.mMani.setInfoArr(e)}else A.menu.setActiveObject(e);else A.visi3D.intRend=e||1}),this.viewServer=new r.a(function(t,e,i,n){"setObj"!=t?"message"!=t||A.menu.setMessage(e,i):null==e?A.menu.setMessage("message","ErrorПроект id ="+A.viewServer.id+" не создан. json еще не сохранен и нечего открывать"):A.world.setObj(e)}),this.dragParam=function(){A.menu.dragParam()},this.update=function(){this.visi3D.upDate()},this.sizeWindow=function(t,e,i){this.scale=i,this.dCont.scale=i,this.menu.sizeWindow(t,e,i),this.visi3D.sizeWindow(0,0,t,e)},this.keydown=function(t){this.menu.keydown(t)},this.keyup=function(t){this.menu.keyup(t)},this.dragParam(),this.viewServer.openURL()}}).call(this,i(0))},function(t,e,i){"use strict";(function(t){i.d(e,"a",function(){return s});var n=i(8),a=i(25);function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=function(){function e(i,r){var s=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o,h,A=this;this.type="Cupboard",this.fun=r,this.par=i,this.dCont=this.par.dCont,this.array=[],this.arrInfo=[],this.children=this.array,this._active=!0,this._width=100,this._height=100,this.visi3D=i.visi3D,this.content3d=new THREE.Object3D,this.par.content3D.add(this.content3d),t.pm=this.pm=new a.a(this.visi3D,this.par.par.objectBase),this._material=pm.getThreeName("defolt_mat").id,this.menedsher=new n.a(this,function(t,e,i){A.fun(t,e,i),"visi3d"==t&&s.render(),"tickInfo"===t&&A.startTickInfo()}),this.render=function(){A.fun("render")},this.create=function(t,e){return(o=this.menedsher.menedsherObject.getIdObj(t))&&((h=this.menedsher.menedsherObject.getBlok(o.obj)).init(),e&&h.setObj(e),this.add(h),A.fun("activeObject",h)),null},this.init=function(){var t=window.location.search;if(null==new URLSearchParams(t).get("id")){o=this.menedsher.menedsherObject.getIdObj(2);var e=this.menedsher.menedsherObject.getBlok(o.obj);this.add(e),e.init()}},this.add=function(t){this.remove(t),this.content3d.add(t.content3d),this.children.push(t),t.parent=this},this.remove=function(t){for(var e=-1,i=null,n=0;n<this.children.length;n++)this.children[n].idArr==t.idArr&&(e=n);return-1!=e&&(i=this.children.splice(e,1)[0],this.content3d.remove(t.content3d),i.parent=void 0),i},this.setObj=function(t){for(var e=0;e<t.children.length;e++)this.create(t.children[e].id,t.children[e])},this.getObj=function(){for(var t={children:[]},e=0;e<this.array.length;e++)t.children[e]=this.array[e].getObj();return t},this.getArrayInfo=function(){var t=this;this.arrInfo.length=0,this.array.forEach(function(e){return e.getArrayInfo(t.arrInfo)}),this.fun("getInfo",this.arrInfo)},this.sah=0,this.startTickInfo=function(t){var e=this;null==t&&(t=500),this.sah++;var i=this.sah;setTimeout(function(){e.sah==i&&e.getArrayInfo()},t)},this.init(),this.fun("initDone",this)}var i,s,o;return i=e,(s=[{key:"active",set:function(t){this._active!=t&&(this._active=t,this.render())},get:function(){return this._active}},{key:"width",set:function(t){this._width!=t&&(this._width=t)},get:function(){return this._width}},{key:"height",set:function(t){this._height!=t&&(this._height=t)},get:function(){return this._height}},{key:"material",set:function(t){if(this._material!=t){this._material=t;for(var e=0;e<this.children.length;e++)this.children[e].material=t}},get:function(){return this._material}}])&&r(i.prototype,s),o&&r(i,o),e}()}).call(this,i(0))},function(t,e,i){"use strict";(function(t){i.d(e,"a",function(){return A});var n=i(2),a=i(9),r=i(10);i(31);function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function h(t,e,i){return e&&o(t.prototype,e),i&&o(t,i),t}var A=function(){function e(i,n){s(this,e),this.type="Menedsher";var a=this;this.fun=n,this.par=i,this.whDrag=2500,this._materialBase=null,this.matNull=new THREE.MeshPhongMaterial({color:255,transparent:!0,opacity:.3}),this.matNull1=new THREE.MeshPhongMaterial({color:65280,transparent:!0,opacity:.3}),this.mPanel=new THREE.Mesh(new THREE.BoxBufferGeometry(this.whDrag,this.whDrag,.001),this.matNull),this.mPanel.layers.set(31),this.mPNa=new THREE.Mesh(new THREE.BoxBufferGeometry(this.whDrag,this.whDrag,.001),this.matNull1),this.mPanel.layers.set(31),this.mPanel1=new THREE.Mesh(new THREE.BoxBufferGeometry(this.whDrag,this.whDrag,.001),this.matNull1),this.mPanel1.layers.set(31);var r,o,h=new THREE.AxesHelper(15);this.mPanel.add(h),this.content3d=new THREE.Object3D,this.par.content3d.add(this.content3d),this.glaf=this.par.par,this.visi3D=this.par.visi3D,this.object=void 0,a.objectOld=void 0,this.content3d.add(this.mPNa),this.menedsherObject=new l(this,function(t,e){n(t,e)}),this.menedsherObject.setOB(this.par.par.par.objectBase),this.clear=function(t){null!=t.parent&&t.parent.remove(t),a.fun("visi3d")},this.copy=function(t){},this.dragPriceScane=function(){this.par.par.par.menuDiv&&this.dragTime()},this.sah=0,this.dragTime=function(){this.sah++;var t=this.sah;setTimeout(function(){a.sah==t&&a.par.par.par.menuDiv.mani.dragPriceScane2(a.menedsherObject.array)},100)},this.startObj=function(t){this.menedsherObject.csvTest(t.obj),this.start(this.menedsherObject.getBlok(t.obj))},this.start=function(t){this.stop(),this.visi3D.position3d.pause=!0,this.object=t,this.visi3D.addEvent("move",this.move),0==dcmParam.mobile?document.addEventListener("mouseup",a.mouseup):document.addEventListener("touchend",a.mouseup)},this.stop=function(){this.pointZdvig.set(0,0,0),null!=a.mPanel.parent&&a.mPanel.parent.remove(a.mPanel),this.object&&null!=this.object.stopDrag&&this.object.stopDrag(),this.visi3D.position3d.pause=!1,this.object&&null==this.object.parent&&this.object.clear(),this.par.name3d="null",this.object=void 0,this.visi3D.removeEvent("move",this.move),0==dcmParam.mobile?document.removeEventListener("mouseup",a.mouseup):document.removeEventListener("touchend",a.mouseup)},this.mouseup=function(t){a.stop()},this.sten,this.pointZdvig=new THREE.Vector3(0,0,0),this.pointReal=new THREE.Vector3(0,0,0),this.move=function(t){t.target&&null!=a.object&&null!=a.object.parent&&a.object.setpositLocel&&(a.object.setpositLocel(t.point.x,t.point.y,t.point.z),a.fun("visi3d"))},this.out=function(e){o=null,e.target&&(null!=a.object&&(trace(e.target),null!=a.object.parent&&(a.object.parent.remove(a.object),t.dragPic.start(64,"resources/data/"+a.object.object.id+"/64.png",a.object.object))),a.fun("visi3d"))},this.over=function(e){if(e&&e.target){if(o=e.target,null==a.object&&null!=t.dragPic.object){if("number"==typeof t.dragPic.object.id){var i=a.menedsherObject.getIdObj(3),n=a.menedsherObject.getBlok(i.obj);n.init(),a.start(n)}return}if(null!=a.object){var r=a.poiscParam(e.target,"xzPar");null!=r&&(t.dragPic.stop(),r.add(a.object)),a.fun("visi3d")}}},this.clik1=function(t){a.menedsherObject.activIndex=-1};var A={x:0,y:0};this.getPNa=function(){return null==(r=a.par.par.par.visi3D.event3DArr.raycaster.intersectObjects([a.mPanel1],!0))[0]?null:(A.x=(r[0].uv.x-.5)*a.whDrag,A.y=(r[0].uv.y-.5)*a.whDrag,A)},this.getLink=function(t){var e="resources/data/"+t.id+"/100.png"+this.plus;if(t.resurs&&t.resurs.array&&0!=t.resurs.array.length)for(var i=0;i<t.resurs.array.length;i++)if(null!=t.resurs.array[i].b&&"icon"==t.resurs.array[i].i){e="resources/data/"+t.id+"/resources/"+t.resurs.array[i].name+this.plus;break}return e};var u,d,c=null;this.down=function(t){t&&t.target&&null!=(c=a.poiscParam(t.target,"blok"))&&(c.notDown||(a.fun("activeObject",c),a.start(c)))},this.setBlokActiv=function(t){c=t},this.pointOld=new THREE.Vector3,this.downZdig=function(t,e){null!=e.parent&&(null!=e.parent.pozZdvig?(e.parent,0==e.parent.idArr&&(d=0,a.par.children[2].width>a.par.children[0].width&&(d=-(a.par.children[2].width-a.par.children[0].width)/2),u=e.parent.width/2+d,this.mPanel.position.x=u-t.point.z,this.mPanel.position.y=t.point.y+this.par._height/2,this.mPanel.position.z=this.par.niz.ww/2+t.point.x),1==e.parent.idArr&&(this.mPanel.position.x=t.point.x+e.parent.width/2,this.mPanel.position.y=t.point.y+this.par._height/2,this.mPanel.position.z=this.par.niz.hh2/2+t.point.z,1==this.par.niz.bbb&&(this.mPanel.position.z=t.point.z)),2==e.parent.idArr&&(d=0,a.par.children[0].width>a.par.children[2].width&&(d=(a.par.children[0].width-a.par.children[2].width)/2),u=e.parent.width/2+d,this.mPanel.position.x=t.point.z+u,this.mPanel.position.y=t.point.y+this.par._height/2,this.mPanel.position.z=this.par.niz.ww/2-t.point.x),e.parent.content3d.add(this.mPanel),this.pointZdvig.x=e.content3d.position.x,this.pointZdvig.y=e.content3d.position.y):null!=e.parent.parent.pozZdvig&&(e.parent.parent,0==e.parent.parent.idArr&&(d=0,a.par.children[2].width>a.par.children[0].width&&(d=-(a.par.children[2].width-a.par.children[0].width)/2),u=e.parent.parent.width/2+d,this.mPanel.position.x=u-t.point.z,this.mPanel.position.y=t.point.y+this.par._height/2,this.mPanel.position.z=this.par.niz.ww/2+t.point.x),1==e.parent.parent.idArr&&(this.mPanel.position.x=t.point.x+e.parent.parent.width/2,this.mPanel.position.y=t.point.y+this.par._height/2,this.mPanel.position.z=this.par.niz.hh/2+t.point.z,1==this.par.niz.bbb&&(this.mPanel.position.z=this.par.niz.hh/2+t.point.z,this.mPanel.position.z=-4+t.point.z)),2==e.parent.parent.idArr&&(d=0,a.par.children[0].width>a.par.children[2].width&&(d=(a.par.children[0].width-a.par.children[2].width)/2),u=e.parent.parent.width/2+d,this.mPanel.position.x=t.point.z+u,this.mPanel.position.y=t.point.y+this.par._height/2,this.mPanel.position.z=this.par.niz.ww/2-t.point.x),e.parent.parent.content3d.add(this.mPanel),this.pointZdvig.x=e.content3d.position.x+e.parent.content3d.position.x,this.pointZdvig.y=e.content3d.position.y+e.parent.content3d.position.y))},this.clik=function(){a.objectOld.setAA(a.aroundButton),a.fun("visi3d")},a.testActSten=function(t){null==t.sten?null!=t.parent&&a.testActSten(t.parent):i.indexAct=t.sten.idArr},this.poiscParam=function(t,e){return null!=t[e]?t[e]:null!=t.parent?this.poiscParam(t.parent,e):null},this.visi3D.event3DArr.activ=!0,this.visi3D.addEvent("out",this.out),this.visi3D.addEvent("over",this.over),this.visi3D.addEvent("down",this.down),t.dragPic.addFunAp(function(){o&&dragPic.object&&dragPic.object.id&&("m"==dragPic.object.id.split("_")[0]&&null!=(c=a.poiscParam(o,"blok"))&&(c.material=dragPic.object.id,"CBoard"==c.parent.type&&c.notDown&&(c.parent.material=dragPic.object.id),trace("333333",c)))}),this.setIdColor=function(t,e){null==e&&(e="idMatObject"),this.menedsherObject.setIdColor(t,e)},this.objectL,this.setObj=function(t){this.menedsherObject.clear(),this.objectLoad=t,1==this.testLoad()&&this.setObjPostLoad(),a.dragPriceScane();for(var e=0;e<10;e++)setTimeout(function(){a.dragPriceScane()},750*e)},this.testLoad=function(t){for(var e=[],i=0;i<this.objectLoad.children.length;i++)for(var n=0;n<this.objectLoad.children[i].children.length;n++){e.push(this.objectLoad.children[i].children[n].id);for(var r=0;r<this.objectLoad.children[i].children[n].children.length;r++)e.push(this.objectLoad.children[i].children[n].children[r].id)}return-1==this.menedsherObject.testIdObj(e)||(this.menedsherObject.loadID(e,function(){a.setObjPostLoad()}),!1)},this.setObjPostLoad=function(){for(var t=0;t<this.objectLoad.children.length;t++){this.par.array[t].collision.activ=!1;for(var e=0;e<this.objectLoad.children[t].children.length;e++){var i=this.menedsherObject.getIdObj(this.objectLoad.children[t].children[e].id);null!=i&&((c=this.menedsherObject.getBlok(i.obj)).setObj(this.objectLoad.children[t].children[e]),this.par.array[t].add(c,!1))}this.par.array[t].collision.activ=!0,this.par.array[t].collision.drawDegug()}a.dragPriceScane(),setTimeout(function(){a.dragPriceScane()},1e3)},this.sobKey=function(t,e,i){this.menedsherObject.sobKey(t,e,i)}}return h(e,[{key:"materialBase",set:function(t){this._materialBase=t,this.menedsherObject.materialBase=t,this.mMaterial.materialBase=t},get:function(){return this._materialBase}}]),e}(),l=function(){function t(e,i){s(this,t),this.type="MenedsherObject";var o=this;this.par=e,this.visi3D=e.par.par.visi3D,this.fun=i,this.array=[],this.arrayHron=[],this._materialBase=void 0,this.objectBase=void 0,this.arrayKey=["fbx","3ds","gltf"],this.wN=[50,75,100],this.hN=[58],this.stepKey=2,this.activObject=void 0,this._visiMark=!1,this.loaderFBX,this.loaderTDS,this.loaderGLTF=new THREE.GLTFLoader,this.material=new THREE.MeshPhongMaterial({color:16711680}),this.boolClone=!1,this.gBox=new THREE.BoxBufferGeometry(1,1,1),this.matNull=new THREE.MeshPhongMaterial({color:16777215,transparent:!0,opacity:.3}),this.matRed=new THREE.MeshPhongMaterial({color:4679797,transparent:!0,opacity:.3}),this.matRed1=new THREE.MeshPhongMaterial({color:16711680,transparent:!0,opacity:.7});var h,A,l,d=pm.getThreeName("defolt_mat");this.mat2=pm.mat.getId(d.id),this.dragPriceScane=function(){this.par.dragPriceScane()},this.testIdObj=function(t){for(var e=0;e<this.objectBase.bd.length;e++)for(var i=0;i<t.length;i++)if(t[i]==this.objectBase.bd[e].id&&null==this.objectBase.bd[e].obj)return e;return-1},this.fDrag,this.loadID=function(t,e){null!=e&&(o.fDrag=e);var i=o.testIdObj(t);-1!=i?o.loadID2(t,o.objectBase.bd[i]):o.fDrag()},this.loadID2=function(t,e){$.ajax({url:"resources/data/"+e.id+"/config.json"+this.par.plus,success:function(i){if("string"==typeof i){var n=JSON.parse(i);e.obj=o.csvTest(n)}else e.obj=o.csvTest(i);o.loadID(t)},error:function(t){console.log("Что то случилось с конфигом")}})},this.csvTest=function(t){if(null==this.par.csvConfigArray)return t;for(var e=0;e<this.par.csvConfigArray.length;e++)if(1*this.par.csvConfigArray[e].id==1*t.id)return t.info=this.par.csvConfigArray[e],t;return t},this.setObjArr=function(t,e){t&&t.plus&&(e[3]&&(t.plus[0]=e[2],t.plus[3]=e[3]),e[5]&&(t.plus1[0]=e[4],t.plus1[3]=e[5]))},this.objA={},this.getRendomID=function(t){if(null==this.objA[t]){this.objA[t]={},this.objA[t].sah=0,this.objA[t].array=[],this.objA[t].arsah=[];for(var e=0;e<this.objectBase.bd.length;e++)t==this.objectBase.bd[e].title&&(this.objA[t].array.push(this.objectBase.bd[e]),this.objA[t].arsah.push(0))}h=[];for(e=0;e<this.objA[t].arsah.length;e++)this.objA[t].arsah[e]==this.objA[t].sah&&h.push(e);if(0==h.length){this.objA[t].sah++;for(e=0;e<this.objA[t].arsah.length;e++)this.objA[t].arsah[e]==this.objA[t].sah&&h.push(e)}if(0!=h.length){var i=Math.round(Math.random()*(h.length-1));return this.objA[t].arsah[h[i]]++,this.objA[t].array[h[i]]}return null},this.getInTEXT=function(t,e){return!!((A=this.getIdObj(t))&&A.obj&&A.obj.info&&-1!=A.obj.info.text.indexOf(e))},this.getIdObj=function(t){return this.getIdRecurs(t,this.objectBase.bd)},this.getIdRecurs=function(t,e){for(var i=null,n=0;n<e.length;n++){if(e[n].id==t)return e[n];if(e[n].array&&null!=(i=this.getIdRecurs(t,e[n].array)))return i}return null},this.blokTumba,this.btBox,this.btBoxDin,this.objB2={},this.setOB=function(t){this.objectBase=t;for(var e=0;e<this.objectBase.bd.length;e++)this.objB2[this.objectBase.bd[e].id]=this.objectBase.bd[e];for(e=0;e<this.objectBase.bd.length;e++)if("tumbaBase"==this.objectBase.bd[e].title){var i=e;$.ajax({url:"resources/data/"+this.objectBase.bd[i].id+"/config.json"+o.par.plus,success:function(t){if("string"==typeof t){var e=JSON.parse(t);o.objectBase.bd[i].obj=o.csvTest(e)}else o.objectBase.bd[i].obj=o.csvTest(t);o.blokTumba=new BTumba(o,o.objectBase.bd[i].obj,-1,o.sob),o.blokTumba.init()},error:function(t){console.log("Что то случилось с конфигом")}}),e=99999;break}for(e=0;e<this.objectBase.bd.length;e++)if("BTBoxDin"==this.objectBase.bd[e].title){i=e;$.ajax({url:"resources/data/"+this.objectBase.bd[i].id+"/config.json"+o.par.plus,success:function(t){if("string"==typeof t){var e=JSON.parse(t);o.objectBase.bd[i].obj=o.csvTest(e)}else o.objectBase.bd[i].obj=o.csvTest(t);o.btBoxDin=new BTBoxDin(o,o.objectBase.bd[i].obj,-1,o.sob),o.btBoxDin.init()},error:function(t){console.log("Что то случилось с конфигом")}}),e=99999;break}for(e=0;e<this.objectBase.bd.length;e++)if("pieceTop"==this.objectBase.bd[e].title){var n=e;$.ajax({url:"resources/data/"+this.objectBase.bd[n].id+"/config.json"+o.par.plus,success:function(t){if("string"==typeof t){var e=JSON.parse(t);o.objectBase.bd[n].obj=o.csvTest(e)}else o.objectBase.bd[n].obj=o.csvTest(t);o.pieceTop=new BPieceTop(o,o.objectBase.bd[n].obj,-1,o.sob),o.pieceTop.init()},error:function(t){console.log("Что то случилось с конфигом")}}),e=99999;break}},this.korektActiv=function(t){setTimeout(function(){o.par.par.visiActiv.korektActiv(t)},1)},this.clear=function(){for(var t=0;t<this.array.length;t++)this.array[t].clear()},this.matBTBDV=new THREE.MeshPhongMaterial({color:16711680,transparent:!0,opacity:.3}),this.activBTBDV=function(t){for(var e=0;e<this.array.length;e++)this.array[e].activBTBDV&&this.array[e].activBTBDV(t)},this.sob=function(t,e){i(t,e)},this.getBigobj=function(t){for(var e=0;e<this.objectBase.bd.length;e++)if(this.objectBase.bd[e].id==t)return this.objectBase.bd[e];return null},this.getBlok=function(t){return l=null,"CBoard"==t.str[0]&&(l=new a.a(this,t,this.array.length,this.sob)),"CPalka"==t.str[0]&&(l=new r.a(this,t,this.array.length,this.sob)),null==l&&(l=new n.a(this,t,this.array.length,this.sob)),this.array.push(l),this.array[this.array.length-1]},this.getGroup=function(t){for(var e=t.str[1].split("|"),i=e[0],n=1;n<e.length;n++)i+='"'+e[n];var a=JSON.parse(i),r=this.getIdObj(a.id),s=this.getBlok(r.obj);return s.setObj(a),s},this.getModel=function(t,e,i){for(var n=0;n<this.arrayHron.length;n++)if(this.arrayHron[n].link==t)return void this.arrayHron[n].setFun(i);this.arrayHron.push(new u(this,t,e,i))},this.setIdColor=function(t,e){for(var i=0;i<this.array.length;i++)this.array[i].idCT==e&&this.array[i].setColorId(t)},this.sobKey=function(t,e,i){17==e.keyCode&&"down"==t&&(this.boolClone=!0),17==e.keyCode&&"up"==t&&(this.boolClone=!1),this.activObject&&this.activObject.sobKey(t,e,i)},this._activTime=-1}return h(t,[{key:"materialBase",set:function(t){this._materialBase=t;for(var e=0;e<this.array.length;e++)this.array[e].material=this._materialBase},get:function(){return this._materialBase}},{key:"visiMark",set:function(t){if(this._visiMark!=t){this._visiMark=t;for(var e=0;e<this.array.length;e++)this.array[e].visiMark=this._visiMark;this.fun("visi3d")}},get:function(){return this._visiMark}},{key:"activIndex",set:function(t){if(this._activIndex!=t){this._activIndex=t;for(var e=0;e<this.array.length;e++)e==this._activIndex?this.array[e].activTime=!0:this.array[e].activTime=!1;null!=this.array[t]?(this.par.visi3D.arrOut=this.array[t].c3dNa,this.par.par.visiActiv.setObject(this.array[t]),this.activObject=this.array[t]):(this.par.visi3D.arrOut=null,this.par.par.visiActiv.setObject(null),this.activObject=void 0),this.par.fun("visi3d")}},get:function(){return this._activIndex}}]),t}(),u=function t(e,i,n,a){s(this,t),this.type="Hron";var r=this;this.link=i,this.content3d=void 0,this.array=[],this.array.push(a),this.setFun=function(t){null==this.content3d?this.array.push(t):t(this.content3d.clone())},this.finalLoad=function(t){this.content3d=new THREE.Object3D,this.content3d.add(t);for(var e=0;e<this.array.length;e++)this.array[e](this.content3d.clone())},"gltf"!=n&&"glb"!=n||e.loaderGLTF.load(i,function(t){var n;-1!=i.indexOf("resources/data/65/")&&(n="m_8"),e.par.mMaterial.geterMat.getTestTitleObj(t.scene,n),t.scene.rotation.x=Math.PI/2,r.finalLoad(t.scene)}),this.getObj3D=function(t){var e=new THREE.Object3D;e.position.set(t.position.x,t.position.y,t.position.z),e.rotation.set(t.rotation.x,t.rotation.y,t.rotation.z),e.scale.set(t.scale.x,t.scale.y,t.scale.z);for(var i=t.children.length-1;i>=0;i++)if("Mesh"==t.children[i].type)e.add(t.children[i]);else if("Default_light"!=e.name){var n=this.getObj3D(t.children[i]);t.remove(t.children[i]),e.add(n)}return e}}}).call(this,i(0))},function(t,e,i){"use strict";i.d(e,"a",function(){return A});var n=i(2);function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var A=function(t){function e(t,i,n,r){var o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=function(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?h(t):e}(this,s(e).call(this,t,i,n,r));var A=h(h(o));o.type="CBoard",o._width=100,o._height=100,o._depth=100,o._cDepth=10,o._boolInt=100;var l,u,d,c=new THREE.AxesHelper(100);return c.position.x=20,o.content3d.add(c),o.arrPalka=[],o.funDrag=function(){this.arrPalka&&this.arrPalka[0]&&(this.arrPalka[0].width=this._cDepth,this.arrPalka[0].setXYPosit(this._width/2,-this._depth/2+this._cDepth/2,-this._height/2),this.arrPalka[0].height=this._height,this.arrPalka[0].depth=this._width,this.arrPalka[1].setXYPosit(-this._width/2+this.arrPalka[1]._width/2,-this._depth/2+this._cDepth,-this._height/2),this.arrPalka[1].height=this._height,this.arrPalka[1].depth=this._depth-this._cDepth,this.arrPalka[2].setXYPosit(this._width/2-this.arrPalka[2]._width/2,-this._depth/2+this._cDepth,-this._height/2),this.arrPalka[2].height=this._height,this.arrPalka[2].depth=this._depth-this._cDepth,this.arrPalka[3].setXYPosit(0,-this._depth/2+this.cDepth,-this.arrPalka[3]._width/2-this._boolInt),this.arrPalka[3].height=this._width-2*this.arrPalka[4]._width,this.arrPalka[3].depth=this._depth-this.cDepth,this.arrPalka[4].setXYPosit(0,-this._depth/2+this.cDepth,-this._height+this.arrPalka[4]._width/2),this.arrPalka[4].height=this._width-2*this.arrPalka[4]._width,this.arrPalka[4].depth=this._depth-this.cDepth,this.arrPalka[5].setXYPosit(0,this._depth/2-this.arrPalka[5]._width/2,-this._boolInt),this.arrPalka[5].width=this.arrPalka[5]._width,this.arrPalka[5].height=this._width-2*this.arrPalka[4]._width,this.arrPalka[5].depth=this._boolInt,this.arrPalka[6].setXYPosit(0,-this._depth/2+this.cDepth,-this.arrPalka[6]._width/2),this.arrPalka[6].height=this._width-2*this.arrPalka[6]._width,this.arrPalka[6].depth=this._depth-this.cDepth-this.arrPalka[6]._width)},o.dragObjNWD(),o.funInitMod=function(){for(var t=0;t<7;t++)l=this.mO.getIdObj(3),(d=this.mO.getBlok(l.obj)).xzPar=this,d.content3d.xzPar=this,d.init(),this.add(d),d.width=5,d.notDown=!0,this.arrPalka.push(d);this.arrPalka[0].content3d.rotation.z=Math.PI/2,this.arrPalka[3].content3d.rotation.y=Math.PI/2,this.arrPalka[4].content3d.rotation.y=Math.PI/2,this.arrPalka[5].content3d.rotation.y=Math.PI/2,this.arrPalka[5].content3d.rotation.z=Math.PI/2,this.arrPalka[6].content3d.rotation.y=Math.PI/2,this.dragObjNWD()},o.funSetInfo=function(){this.objInfo.type=this.type,this.objInfo.width=this._width,this.objInfo.height=this._height,this.objInfo.depth=this._depth},o.getObj=function(){var t={};t.type=this.type,t.id=this.id,t.x=A.content3d.position.x,t.y=A.content3d.position.y,t.z=A.content3d.position.z,t.width=this._width,t.height=this._height,t.depth=this._depth,t.boolInt=this._boolInt,t.children=[];for(var e=0;e<this.children.length;e++)null==this.children[e].xzPar&&(t.children[e]=this.children[e].getObj());return t},o.setObj=function(e){if(this.setXYPosit(e.x,e.y,e.z),e.children.length)for(var i=0;i<e.children.length;i++)e.children[i]&&(d=t.getIdObj(e.children[i].id),(u=t.getBlok(d.obj)).setObj(e.children[i]),this.arrPalka.push(u),this.add(u));return this._width=e.width,this._height=e.height,this._depth=e.depth,this._boolInt=e.boolInt||100,this.dragObjNWD(),e},o}var i,A,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(e,n["a"]),i=e,(A=[{key:"width",set:function(t){this._width!=t&&(this._width=t,this.dragObjNWD())},get:function(){return this._width}},{key:"height",set:function(t){this._height!=t&&(this._height=t,this.dragObjNWD())},get:function(){return this._height}},{key:"depth",set:function(t){this._depth!=t&&(this._depth=t,this.dragObjNWD())},get:function(){return this._depth}},{key:"cDepth",set:function(t){this._cDepth!=t&&(this._cDepth=t,this.dragObjNWD())},get:function(){return this._cDepth}},{key:"boolInt",set:function(t){this._boolInt!=t&&(this._boolInt=t,this.dragObjNWD())},get:function(){return this._boolInt}}])&&r(i.prototype,A),l&&r(i,l),e}()},function(t,e,i){"use strict";(function(t){i.d(e,"a",function(){return l});var n=i(2),a=i(1);function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function A(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var l=function(e){function i(e,n,s,h){var l;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),l=function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?A(t):e}(this,o(i).call(this,e,n,s,h));var u=A(A(l));l.type="CPalka",l._width=10,l._height=100,l._depth=100,l._bool=!1,l._bool1=!1,l._bool2=!1,l._bool3=!1,l.cnt3d=new THREE.Object3D,l.content3d.add(l.cnt3d);var d,c,f,p=new THREE.AxesHelper(50);return l.content3d.add(p),l.arrayGron=[],l.sob=function(t,e,i){"dragMy"==t&&trace(">>>>>>>",t)},l.arrayGron[0]=new a.a(A(A(l)),l.sob),l.arrayGron[0].boolOut=l._bool,l.arrayGron[0].content3d.rotation.x=Math.PI/2,l.arrayGron[0].mesh.material=t.pm.mat.getId("m_7",function(){}),l.arrayGron[1]=new a.a(A(A(l)),l.sob),l.arrayGron[1].boolOut=l._bool1,l.arrayGron[1].mesh.material=t.pm.mat.getId("m_7",function(){}),l.arrayGron[2]=new a.a(A(A(l)),l.sob),l.arrayGron[2].boolOut=l._bool2,l.arrayGron[2].content3d.rotation.x=-Math.PI/2,l.arrayGron[2].mesh.material=t.pm.mat.getId("m_7",function(){}),l.arrayGron[3]=new a.a(A(A(l)),l.sob),l.arrayGron[3].boolOut=l._bool3,l.arrayGron[3].content3d.rotation.z=Math.PI,l.arrayGron[3].mesh.material=t.pm.mat.getId("m_7",function(){}),l.arrayGron[4]=new a.a(A(A(l)),l.sob),l.arrayGron[4].content3d.rotation.x=Math.PI,l.arrayGron[4].content3d.rotation.z=Math.PI/2,l.arrayGron[4].mesh.material=t.pm.mat.getId("m_5",function(){}),l.arrayGron[5]=new a.a(A(A(l)),l.sob),l.arrayGron[5].content3d.rotation.z=Math.PI/2,l.arrayGron[5].content3d.rotation.y=Math.PI,l.arrayGron[5].mesh.material=t.pm.mat.getId("m_5",function(){}),l.funDrag=function(){this.arrayGron[0].width=this._width,this.arrayGron[0].height=this._depth,this.arrayGron[0].content3d.position.x=-this._width/2,this.arrayGron[0].content3d.position.y=0,this.arrayGron[0].content3d.position.z=-this._height/2,this.arrayGron[1].width=this._width,this.arrayGron[1].height=this._height,this.arrayGron[1].content3d.position.x=-this._width/2,this.arrayGron[1].content3d.position.z=this._height/2,this.arrayGron[2].width=this._width,this.arrayGron[2].height=this._depth,this.arrayGron[2].content3d.position.x=-this._width/2,this.arrayGron[2].content3d.position.y=this._depth,this.arrayGron[2].content3d.position.z=this._height/2,this.arrayGron[3].width=this._width,this.arrayGron[3].height=this._height,this.arrayGron[3].content3d.position.x=this._width/2,this.arrayGron[3].content3d.position.y=this._depth,this.arrayGron[3].content3d.position.z=this._height/2,this.arrayGron[4].width=this._depth,this.arrayGron[4].height=this._height,this.arrayGron[4].content3d.position.x=this._width/2,this.arrayGron[4].content3d.position.y=this._depth,this.arrayGron[4].content3d.position.z=-this._height/2,this.arrayGron[5].width=this._depth,this.arrayGron[5].height=this._height,this.arrayGron[5].content3d.position.x=-this._width/2,this.arrayGron[5].content3d.position.z=-this._height/2},l.setpositLocel=function(t,e,i){this.setXYPosit(t,e,i)},l.dragObjNWD(),l.dragColor=function(){this.arrayGron[5].mesh.material=this.arrayGron[4].mesh.material=t.pm.mat.getId(this._material,function(){})},l.funSetInfo=function(){this.objInfo.type=this.type,this.objInfo.width=this._width,this.objInfo.height=this._height,this.objInfo.depth=this._depth,d=0,this.arrayGron.forEach(function(t){t._boolOut&&(d+=t._height)}),this.objInfo.gron=d},l.getObj=function(){var t={};t.type=this.type,t.id=this.id,t.x=u.content3d.position.x,t.y=u.content3d.position.y,t.z=u.content3d.position.z,t.width=this._width,t.height=this._height,t.depth=this._depth,t.children=[];for(var e=0;e<this.children.length;e++)t.children[e]=this.children[e].getObj();return t},l.setObj=function(t){this.setXYPosit(t.x,t.y,t.z),t.children;for(var i=0;i<t.children.length;i++)f=e.getIdObj(t.children[i].id),(c=e.getBlok(f.obj)).setObj(t.children[i]),this.add(c);return this._width=t.width,this._height=t.height,this._depth=t.depth,this.dragObjNWD(),t},l}var l,u,d;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(i,n["a"]),l=i,(u=[{key:"width",set:function(t){this._width!=t&&(this._width=t,this.dragObjNWD())},get:function(){return this._width}},{key:"height",set:function(t){this._height!=t&&(this._height=t,this.dragObjNWD())},get:function(){return this._height}},{key:"depth",set:function(t){this._depth!=t&&(this._depth=t,this.dragObjNWD())},get:function(){return this._depth}},{key:"bool",set:function(t){this._bool!=t&&(this._bool=t,this.arrayGron[0].boolOut=t,this.fun("tickInfo"))},get:function(){return this._bool}},{key:"bool1",set:function(t){this._bool1!=t&&(this._bool1=t,this.arrayGron[1].boolOut=t,this.fun("tickInfo"))},get:function(){return this._bool1}},{key:"bool2",set:function(t){this._bool2!=t&&(this._bool2=t,this.arrayGron[2].boolOut=t,this.fun("tickInfo"))},get:function(){return this._bool2}},{key:"bool3",set:function(t){this._bool3!=t&&(this._bool3=t,this.arrayGron[3].boolOut=t,this.fun("tickInfo"))},get:function(){return this._bool3}}])&&s(l.prototype,u),d&&s(l,d),i}()}).call(this,i(0))},function(t,e,i){"use strict";(function(t){function n(t){return function(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}i.d(e,"a",function(){return r});var r=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);this.type="Outline",this.par=t,this._materialName="null",this._bLeft=!0,this._bRight=!0,this._width=100,this._height=100,this._depth=100,this.content3d=new THREE.Object3D,this.par.content3d.add(this.content3d),this._material=void 0,this.cubs=[],this.cubsW=[],this.cubsH=[],this.setWH=function(t,e){this._width=t,this._height=e,this.redrawCubes()}}var i,r,s;return i=e,(r=[{key:"redrawCubes",value:function(){if(0!=this.cubs.length){this.cubs[0].position.x=this.cubsW[0]/2,this.cubs[1].position.x=this._height/2,this.cubs[2].position.x=this._height-this.cubsW[2]/2;var t=this._height-this.cubsW[0]-this.cubsW[2],e=this._width/this.cubsH[0];this.cubs[1].scale.set(t/this.cubsW[1],1,e),this.cubs[0].scale.set(1,1,e),this.cubs[2].scale.set(1,1,e)}}},{key:"setGeometrys",value:function(t,e,i){var a;(null==t.boundingBox&&(t.computeBoundingBox(),e.computeBoundingBox(),i.computeBoundingBox()),this.cubsW[0]=t.boundingBox.max.x-t.boundingBox.min.x,this.cubsW[1]=e.boundingBox.max.x-e.boundingBox.min.x,this.cubsW[2]=i.boundingBox.max.x-i.boundingBox.min.x,this.cubsH[0]=t.boundingBox.max.z-t.boundingBox.min.z,this.cubsH[1]=e.boundingBox.max.z-e.boundingBox.min.z,this.cubsH[2]=i.boundingBox.max.z-i.boundingBox.min.z,0==this.cubs.length)?(this.cubs.push(new THREE.Mesh(t,this._material),new THREE.Mesh(e,this._material),new THREE.Mesh(i,this._material)),(a=this.content3d).add.apply(a,n(this.cubs))):(this.cubs[0].geometry=t,this.cubs[1].geometry=e,this.cubs[2].geometry=i)}},{key:"setCubsPosition",value:function(t,e,i){this._bLeft||(t.position.x=-this.getCubParam(e,"x")/2),this._bRight||(t.position.x=this.getCubParam(e,"x")/2),this._bLeft||this._bRight||(t.position.x=0),this._bLeft&&this._bRight&&(t.position.x=0,e.position.x=t.geometry.boundingBox.max.x*t.scale.x-e.geometry.boundingBox.min.x*e.scale.x,i.position.x=t.geometry.boundingBox.min.x*t.scale.x-i.geometry.boundingBox.max.x*i.scale.x)}},{key:"getCubParam",value:function(t,e){return t.geometry.boundingBox.max[e]-t.geometry.boundingBox.min[e]}},{key:"materialName",set:function(e){if(this._materialName!=e){this._materialName=e,this._material=t.pm.mat.getId(this._materialName,function(){});for(var i=0;i<this.cubs.length;i++)this.cubs[i].material=this._material;this.redrawCubes()}},get:function(){return this._materialName}},{key:"width",set:function(t){this._width!=t&&(this._width=t,this.redrawCubes())},get:function(){return this._width}},{key:"height",set:function(t){this._height!=t&&(this._height=t,this.redrawCubes())},get:function(){return this._height}},{key:"depth",set:function(t){this._depth!=t&&(this._depth=t,this.redrawCubes())},get:function(){return this._depth}},{key:"bLeft",set:function(t){this._bLeft!=t&&(this._bLeft=t,this.cubs[2].visible=t,this.redrawCubes())},get:function(){return this._bLeft}},{key:"bRigth",set:function(t){this._bRight!=t&&(this._bRight=t,this.cubs[1].visible=t,this.redrawCubes())},get:function(){return this._bRight}}])&&a(i.prototype,r),s&&a(i,s),e}()}).call(this,i(0))},function(t,e,i){"use strict";function n(){THREE.BufferGeometry.call(this),this.type="GeometrySten",this._rect={x:0,y:0,width:100,height:100},this._arrBox=[],this._textureWidth=50,this._textureHeight=50,this._depth=1,this._z=0,this._prossentWidth=0,this._prossentHeight=0,this._isInside=!1,this._isInverse=!1,this._okrog=5;var t,e,i,n,a=[],r=[],s=[],o=[],h=0,A=0,l=[],u=[],d=[],c=0,f=[],p=new THREE.Vector3,g=new THREE.Vector3,m=new THREE.Vector3,x=new THREE.Vector3,b=new THREE.Vector2,y=new THREE.Vector2,v=new THREE.Vector2,_=new THREE.Vector2,w=0;this.setRect=function(t,e,i,n){this._rect.x=t,this._rect.y=e,this._rect.width=i,this._rect.height=n,this.update()},this.startArrRect=function(){w=0;for(var t=0;t<r.length;t++)r[t]=0;for(t=0;t<a.length;t++)a[t]=0;if(this._isInside)for(t=0;t<this._arrBox.length;t++)n=this._arrBox[t],this.fillPointFromBox(n.x,n.y,n.width,n.height);else this.fillPointExcludeBox()},this.fillPointExcludeBox=function(){h=0,A=0;for(var t=!1,e=0;e<this._arrBox.length;e++)n=this._arrBox[e],this._rect.x<n.x+n.width&&this._rect.y<n.y+n.height&&this._rect.x+this._rect.width>n.x&&this._rect.y+this._rect.height>n.y&&(this._rect.x<=n.x&&(l[h++]=n.x),this._rect.x+this._rect.width>=n.x+n.width&&(l[h++]=n.x+n.width),this._rect.y<=n.y&&(u[A++]=n.y),this._rect.y+this._rect.height>=n.y+n.height&&(u[A++]=n.y+n.height));0==h&&0==A&&(t=!0);for(e=this._rect.x+this._textureWidth;e<this._rect.x+this._rect.width;e+=this._textureWidth)l[h++]=e;for(e=this._rect.y+this._textureHeight;e<this._rect.y+this._rect.height;e+=this._textureHeight)u[A++]=e;l[h++]=this._rect.x,l[h++]=this._rect.x+this._rect.width,u[A++]=this._rect.y,u[A++]=this._rect.y+this._rect.height,u.length=A,l.length=h,u.sort(function(t,e){return t-e}),l.sort(function(t,e){return t-e});for(e=0;e<l.length;e++)l[e]==l[e+1]&&(l.splice(e+1,1),e--);for(e=0;e<u.length;e++)u[e]==u[e+1]&&(u.splice(e+1,1),e--);for(e=0;e<u.length;e++){null==f[e]&&(f[e]=[]);for(var i=0;i<l.length;i++)f[e][i]=this.inBox(l[i],u[e],l[i+1],u[e+1])}if(t)this.fillPointFromBox(l[0],u[0],Math.abs(l[l.length-1]-l[0]),Math.abs(u[u.length-1]-u[0]));else for(e=0;e<u.length-1;e++)for(i=0;i<l.length-1;i++)f[e][i]||this.fillPointOptimiz(i,e)},this.fillPointFromBox=function(t,e,i,n){if(this._rect){if(e+n<=this._rect.y)return;if(t+i<=this._rect.x)return;if(e>=this._rect.y+this._rect.height)return;if(t>=this._rect.x+this._rect.width)return}A=0,h=0;for(var a=this._rect.x+this._textureWidth;a<t+i;a+=this._textureWidth)a>=t&&a<=t+i&&(s[h++]=a);for(a=this._rect.y+this._textureHeight;a<e+n;a+=this._textureHeight)a>=e&&a<=e+n&&(o[A++]=a);t>=this._rect.x?s[h++]=t:s[h++]=this._rect.x,t+i<=this._rect.x+this._rect.width?s[h++]=t+i:s[h++]=this._rect.x+this._rect.width,e>=this._rect.y?o[A++]=e:o[A++]=this._rect.y,e+n<=this._rect.y+this._rect.height?o[A++]=e+n:o[A++]=this._rect.y+this._rect.height,o.length=A,s.length=h,o.sort(function(t,e){return t-e}),s.sort(function(t,e){return t-e});for(a=0;a<s.length;a++)(s[a]==s[a+1]||s[a+1]>this._rect.x+this._rect.width)&&(s.splice(a+1,1),a--);for(a=0;a<o.length;a++)(o[a]==o[a+1]||o[a+1]>this._rect.y+this._rect.height)&&(o.splice(a+1,1),a--);this.fillPointSetka()},this.pluspoli=function(t){this._isInverse&&(t=!t),t?(r[18*w+0]=p.x,r[18*w+1]=p.y,r[18*w+2]=p.z,r[18*w+3]=g.x,r[18*w+4]=g.y,r[18*w+5]=g.z,r[18*w+6]=m.x,r[18*w+7]=m.y,r[18*w+8]=m.z,r[18*w+9]=p.x,r[18*w+10]=p.y,r[18*w+11]=p.z,r[18*w+12]=m.x,r[18*w+13]=m.y,r[18*w+14]=m.z,r[18*w+15]=x.x,r[18*w+16]=x.y,r[18*w+17]=x.z,a[12*w+0]=b.x,a[12*w+1]=b.y,a[12*w+2]=y.x,a[12*w+3]=y.y,a[12*w+4]=v.x,a[12*w+5]=v.y,a[12*w+6]=b.x,a[12*w+7]=b.y,a[12*w+8]=v.x,a[12*w+9]=v.y,a[12*w+10]=_.x,a[12*w+11]=_.y):(r[18*w+0]=p.x,r[18*w+1]=p.y,r[18*w+2]=p.z,r[18*w+3]=m.x,r[18*w+4]=m.y,r[18*w+5]=m.z,r[18*w+6]=g.x,r[18*w+7]=g.y,r[18*w+8]=g.z,r[18*w+9]=p.x,r[18*w+10]=p.y,r[18*w+11]=p.z,r[18*w+12]=x.x,r[18*w+13]=x.y,r[18*w+14]=x.z,r[18*w+15]=m.x,r[18*w+16]=m.y,r[18*w+17]=m.z,a[12*w+0]=b.x,a[12*w+1]=b.y,a[12*w+2]=v.x,a[12*w+3]=v.y,a[12*w+4]=y.x,a[12*w+5]=y.y,a[12*w+6]=b.x,a[12*w+7]=b.y,a[12*w+8]=_.x,a[12*w+9]=_.y,a[12*w+10]=v.x,a[12*w+11]=v.y),w++},this.inBox=function(t,e,i,a){for(var r=0;r<this._arrBox.length;r++)if(t>=(n=this._arrBox[r]).x&&i<=n.x+n.width&&e>=n.y&&a<=n.y+n.height)return!0;return!1},this.fillPointOptimiz=function(t,e){for(var i=e,n=0,a=0,r=0,s=t+1;i<u.length&&!(0==Math.abs((u[i]-this._rect.y)/this._textureHeight%1)&&i>e);s++)(f[i][s]||s==l.length-1||0==Math.abs((l[s]-this._rect.x)/this._textureWidth%1))&&(-1!=(a=this.getBoolRectPow(t,e,s,++i))&&(d[c++]=[s,i],n<a&&(n=a,r=c-1)),s=t);this.fillPointFromBox(l[t],u[e],Math.abs(l[d[r][0]]-l[t]),Math.abs(u[d[r][1]]-u[e])),this.setBoolRect(t,e,d[r][0],d[r][1])},this.setBoolRect=function(t,e,i,n){for(var a=e;a<f.length&&a<n;a++)for(var r=t;r<f[a].length&&r<i;r++)f[a][r]=!0},this.getBoolRectPow=function(t,e,i,n){for(var a=0,r=e;r<f.length&&r<n;r++)for(var s=t;s<f[r].length&&s<i;s++){if(f[r][s])return-1;a++}return a};var E=0,I=0,C=0,T=0,P=0,M=0,S=0,F=0;this.fillPointSetka=function(){for(var t=0;t<o.length-1;t++)for(var e=0;e<s.length-1;e++)0,E=s[e],C=o[t],I=s[e+1],T=o[t+1],P=Math.abs((E-this._rect.x)/this._textureWidth%1)||0,S=Math.abs((C-this._rect.y)/this._textureHeight%1)||0,M=Math.abs((I-this._rect.x)/this._textureWidth%1)||1,F=Math.abs((T-this._rect.y)/this._textureHeight%1)||1,p.set(E,C,this._z),g.set(I,C,this._z),m.set(I,T,this._z),x.set(E,T,this._z),b.set(P,S),y.set(M,S),v.set(M,F),_.set(P,F),this.pluspoli(),this._depth},this._isLeft=!0,this._isRight=!0,this.fillPointEdge=function(t,e,i){E=s[e],C=o[t],I=s[e+1],T=o[t+1],P=Math.abs((E-this._rect.x)/this._textureWidth%1)||0,S=Math.abs((C-this._rect.y)/this._textureHeight%1)||0,M=Math.abs((I-this._rect.x)/this._textureWidth%1)||1,F=Math.abs((T-this._rect.y)/this._textureHeight%1)||1,0==t&&(p.set(E,C,this._z),g.set(I,C,this._z),m.set(I,C,this._z+this._depth),x.set(E,C,this._z+this._depth),b.set(P,0),y.set(M,0),v.set(M,1),_.set(P,1),this.pluspoli(!i)),t==o.length-2&&(p.set(E,T,this._z),g.set(I,T,this._z),m.set(I,T,this._z+this._depth),x.set(E,T,this._z+this._depth),b.set(P,0),y.set(M,0),v.set(M,1),_.set(P,1),this.pluspoli(i)),0==e&&(p.set(E,C,this._z),g.set(E,C,this._z+this._depth),m.set(E,T,this._z+this._depth),x.set(E,T,this._z),b.set(0,S),y.set(1,S),v.set(1,F),_.set(0,F),1==this._isLeft&&this.pluspoli(!i)),e==s.length-2&&(p.set(I,C,this._z),g.set(I,C,this._z+this._depth),m.set(I,T,this._z+this._depth),x.set(I,T,this._z),b.set(0,S),y.set(1,S),v.set(1,F),_.set(0,F),1==this._isRight&&this.pluspoli(i))},this.createBuffer=function(){(!i||i.length<3*r.length)&&(i=new Float32Array(3*r.length),this.setAttribute("position",new THREE.BufferAttribute(i,3)),e=new Float32Array(2*r.length),this.setAttribute("uv",new THREE.BufferAttribute(e,2)),t=new Float32Array(3*r.length),this.setAttribute("normal",new THREE.BufferAttribute(t,3)));for(var n=0;n<i.length;n++)i[n]=0;for(n=0;n<r.length;n++)this.attributes.position.array[n]=Math.round(100*r[n])/100;for(n=0;n<a.length;n++)e[n]=a[n];this.attributes.position.needsUpdate=!0,this.attributes.uv.needsUpdate=!0,this.computeVertexNormals(),this.attributes.normal.needsUpdate=!0,this.computeBoundingBox(),this.computeBoundingSphere()},this.update=function(){this.startArrRect(),this.createBuffer()},this.full=function(){this._textureHeight=this._rect.height,this._textureWidth=this._rect.width,this.update()},this.update(),Object.defineProperty(this,"isLeft",{set:function(t){this._isLeft!=t&&(this._isLeft=t,this.update())},get:function(){return this._isLeft}}),Object.defineProperty(this,"isRight",{set:function(t){this._isRight!=t&&(this._isRight=t,this.update())},get:function(){return this._isRight}}),Object.defineProperty(this,"textureWidth",{set:function(t){this._textureWidth!=t&&(this._textureWidth=t>0?t:1,this.update())},get:function(){return this._textureWidth}}),Object.defineProperty(this,"textureHeight",{set:function(t){this._textureHeight!=t&&(this._textureHeight=t>0?t:1,this.update())},get:function(){return this._textureHeight}}),Object.defineProperty(this,"rect",{set:function(t){this._rect=t,this.update()},get:function(){return this._rect}}),Object.defineProperty(this,"arrBox",{set:function(t){this._arrBox=t,this.update()},get:function(){return this._arrBox}}),Object.defineProperty(this,"depth",{set:function(t){this._depth!=t&&(this._depth=t,this.update())},get:function(){return this._depth}}),Object.defineProperty(this,"isInside",{set:function(t){this._isInside!=t&&(this._isInside=t,this.update())},get:function(){return this._isInside}}),Object.defineProperty(this,"okrog",{set:function(t){this._okrog!=t&&(this._okrog=t,this.update())},get:function(){return this._okrog}}),Object.defineProperty(this,"prossentWidth",{set:function(t){this._prossentWidth!=t&&(this._prossentWidth=t,this.update())},get:function(){return this._prossentWidth}}),Object.defineProperty(this,"prossentHeight",{set:function(t){this._prossentHeight!=t&&(this._prossentHeight=t,this.update())},get:function(){return this._prossentHeight}})}i.d(e,"a",function(){return n}),n.prototype=Object.create(THREE.BufferGeometry.prototype),n.prototype.constructor=n},function(module,__webpack_exports__,__webpack_require__){"use strict";function PMMat(par,visi3D,objbase){this.type="PMMat";var self=this;this.par=par,this.visi3D=visi3D,this.objbase=objbase,this.pmTexture=this.par.tex,this.ser=window.location.href;var arrParams=window.location.href.split("?"),arrParams2=arrParams[0].split("/");this.server="";for(var i=0;i<arrParams2.length-1;i++)this.server+=arrParams2[i]+"/";this.setObjS=function(t,e,i){this.getTestTitleObj(t),i()},this.testObjMatLoad=function(t){if(t.children)for(var e=0;e<t.children.length;e++)if(0==this.testObjMatLoad(t.children[e]))return!1;return!t.material||null==t.material.bLoad||0!=t.material.bLoad},this.matarialArray=this.objbase.materials;var matarialArray=this.matarialArray;this.idColor=null;var loader=new THREE.TextureLoader,rt,textur;this.obj={},this.getTestTitle=function(t){var e=null;if(null!=t)for(var i=0;i<matarialArray.length;i++)if(-1!=t.indexOf(matarialArray[i].title))return e=this.getIDReturn(matarialArray[i].id);return e},this.getTestTitleObj=function(t){t.material&&null!=(rt=this.getTestTitle(t.material.name))&&(t.material=rt);for(var e=0;e<t.children.length;e++)this.getTestTitleObj(t.children[e])},this.getIDReturn=function(id,isBD){for(var r=null,p=-1,i=0;i<matarialArray.length;i++)matarialArray[i].id==id&&(p=i);if(-1==p)return null;if(null==isBD&&null!=this.obj[id])return this.obj[id];var comand="new THREE."+matarialArray[p].key+"()",m=eval(comand);return m.idObj=matarialArray[p],this.startMat(m,id),this.obj[id]=m,m.idUz=id,m},this.get=function(t,e,i){var n,a,r=-1;if(null!=i){n=t+"",t="2456567567867896789";for(var s=0;s<this.matarialArray.length;s++)if(a=this.matarialArray[s].title+"",-1!=n.indexOf(a)){t=this.matarialArray[s].title;break}}for(s=0;s<this.matarialArray.length;s++)this.matarialArray[s].title==t&&(r=s);-1!=r?this.getId(this.matarialArray[r].id,e):e(null)},this.getId=function(id,_fun){for(var p=-1,i=0;i<this.matarialArray.length;i++)if(this.matarialArray[i].id==id){p=i;break}if(-1!=p){if(null!=this.obj[id])return 1==this.obj[id].bLoad?_fun(this.obj[id]):this.obj[id].arrFun.push(_fun),this.obj[id];var comand="new THREE."+this.matarialArray[p].key+"()",m=eval(comand);return m.idObj=matarialArray[p],m.bLoad=!1,m.loadTexure=999,m.arrFun=[_fun],this.startMat(m,id),this.obj[id]=m,m}_fun(null)},this.objToMater=function(t,e){var i=this;for(var n in t)null!=e[n]&&(e[n]instanceof THREE.Color?e[n]=new THREE.Color(t[n]):e[n]=t[n]);if(e.loadTexure=0,t.textur){e.loadTexure=t.textur.length;for(var a=0;a<t.textur.length;a++)t.textur[a].id?function(){var n=a;textur=i.pmTexture.getById(t.textur[a].id,function(i){e[t.textur[n].name]=i,--e.loadTexure}),e[t.textur[a].name]=textur}():((textur=loader.load(t.textur[a].link,function(){self.visi3D&&(self.visi3D.intRend=1),e.loadTexure--})).wrapS=textur.wrapT=THREE.RepeatWrapping,textur.repeat.x=t.textur[a].rx,textur.repeat.y=t.textur[a].ry,e[t.textur[a].name]=textur)}if(e.needsUpdate=!0,e.bLoad=!0,e.arrFun)for(a=0;a<e.arrFun.length;a++)e.arrFun[a](e)},this.startMat=function(t,e){var i,n=this.server+"resources/data/"+e+"/config.json"+self.par.plus;$.ajax({url:n,success:function(e){if("string"==typeof e){var n=JSON.parse(e);i=n}else i=e;!0===i.mirro?self.visi3D&&(t.envMap=self.visi3D.getEnvMap()):(i.mirro,1==i.mirro&&self.visi3D&&(t.envMap=self.visi3D.getEnvMap()),2==i.mirro&&self.visi3D&&(t.envMap=self.visi3D.getEnvMap1())),self.objToMater(i.obj,t)},error:function(t){self.start()}})}}__webpack_require__.d(__webpack_exports__,"a",function(){return PMMat})},function(t,e,i){"use strict";(function(t){i.d(e,"a",function(){return l});var n=i(15),a=i(27),r=i(16),s=i(17),o=i(26),h=i(18);function A(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var l=function(){function e(i,A){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.type="Menu";var l=this;this.par=i,this.fun=A,this._mashtab=1,this.localStorage=i.localStorage,this.param=this.par.param,this.objectBase=i.par.objectBase,this.sizeMax=this.par.sizeMax,dcmParam.activButton="#f28044",this._menuIndex=-1,this.dCont=new DCont(this.par.dCont),this.array=[],this.array[this.array.length]=this.mLeft=new n.a(this,function(t,e,i){"index"==t&&(l.menuIndex=e),l.fun(t,e,i)}),this.array[this.array.length]=this.mTop=new s.a(this,function(t,e,i){}),this.array[this.array.length]=this.mDev=new a.a(this,function(t,e,i){}),trace("###############################################"),this.array[this.array.length]=t.mInfo=this.mInfo=new r.a(this.par.dCont),this.array[this.array.length]=this.mObject=new o.a(this,function(t,e,i){}),this.array[this.array.length]=this.mMani=new h.a(this,function(t,e,i){}),this.array[this.array.length]=t.dragPic=this.dragPic=new DDragPic(this.par.dCont),t.dragPic.whBase=this.wh,this.dragParam=function(){for(var t=this.array.length-1;t>=0;t--)this.array[t].dragParam&&this.array[t].dragParam()},this.setMessage=function(t,e){if("messageClose"!=t){var i=t||"Сообщение",n=e||"null";mInfo.setFun(i,n)}else mInfo.closeTime(e)},this.sizeWindow=function(t,e,i){null==i&&(i=1);for(var n=this.array.length-1;n>=0;n--)this.array[n].sizeWindow&&this.array[n].sizeWindow(t,e,i)},this.keydown=function(t){for(var e=this.array.length-1;e>=0;e--)this.array[e].keydown&&this.array[e].keydown(t)},this.keyup=function(t){for(var e=this.array.length-1;e>=0;e--)this.array[e].keyup&&this.array[e].keyup(t)}}var i,l,u;return i=e,(l=[{key:"transferObj",value:function(t){this.mDev.transferObj&&this.mDev.transferObj(t)}},{key:"setActiveObject",value:function(t){this.mObject.setObject(t),this.mDev.setActiveObject(t)}},{key:"menuIndex",set:function(t){this._menuIndex!=t&&(this._menuIndex=t,this.mLeft.index=t)},get:function(){return this._menuIndex}}])&&A(i.prototype,l),u&&A(i,u),e}()}).call(this,i(0))},function(t,e,i){"use strict";(function(t){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?h(t):e}function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function A(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,i){return e&&l(t.prototype,e),i&&l(t,i),t}i.d(e,"a",function(){return d});var d=function(){function e(i,n){A(this,e),this.type="MLeft";var a=this;this.par=i,this.fun=n,this.param=this.par.param,this._index=-1,this._tipVisi=-1,this._tipDrav=-1,this.dCont=new DCont(i.dCont),this.objectBase=void 0,this.objThree=void 0,this.panel=void 0,this.array=[],this.init=function(t){this.objectBase=t;for(var e=0;e<t.three.length;e++)"MLeft"==t.three[e].keyName&&(this.objThree=t.three[e]);for(e=0;e<this.objThree.array.length;e++)this.array[e]=new c(this,this.drag,e,this.objThree.array[e]);this.array[0].active=!0},this.drag=function(e,i){"gIndex"==e&&(0==this.idArr&&t.dragPic.start(64,"resources/data/"+i.obj.id+"/64.png",i.obj),1==this.idArr&&t.dragPic.start(64,"resources/data/"+i.obj.id+"/64.png",i.obj)),a.fun(e,i)},this.init(this.par.objectBase),this.dragParam=function(){this.dCont.x=this.param.otstup,this.dCont.y=4*this.param.otstup+.8*this.param.wh;for(var t=this.array.length-1;t>=0;t--)this.array[t].dragParam&&this.array[t].dragParam()},this.sobMenu=function(t,e,i){}}return u(e,[{key:"index",set:function(t){if(this._index!=t){this._index=t;for(var e=0;e<this.array.length;e++)e==this._index?this.array[e].active=!0:this.array[e].active=!1}},get:function(){return this._index}},{key:"tipVisi",set:function(t){this._tipVisi!=t&&(this._tipVisi=t)},get:function(){return this._tipVisi}},{key:"tipDrav",set:function(t){this._tipDrav!=t&&(this._tipDrav=t)},get:function(){return this._tipDrav}}]),e}(),c=function(){function t(e,i,n,a){var r=this;A(this,t),this.type="MLButGal";var s=this;this.par=e,this.fun=i,this.idArr=n,this.obj=a,this._active=!1,this._startIndex=-1,this.param=this.par.param,this.gallery=void 0,this.dCont=new DCont(e.dCont),this.dCGal=new DCont(this.dCont),this.button=new DButton(this.dCont,0,0,"",function(){return r.fun("index",r.idArr)},"resources/data/"+a.id+"/100.png"),this.dragParam=function(){this.button.y=this.idArr*(this.param.wh+this.param.otstup),this.button.width=this.button.height=this.param.wh,this.dCGal.x=this.param.wh,this.gallery&&(this.gallery.widthPic=1.5*this.param.wh,this.gallery.heightPic=1.5*this.param.wh,this.gallery.otstup=this.param.otstup,this.gallery.y=-this.param.otstup,this.gallery.width=1.5*this.param.wh*2+2*this.gallery.otstup+2,this.gallery.height=1.5*this.param.wh*this.gallery.kolII+2+2*this.gallery.otstup+2,this.gallery.panelBool=!1,this.gallery.boolPositOtctup=!1,this.gallery.boolPositScrol=!1,this.gallery.boolWheel=!1)},this.init=function(t){if(null==this.gallery&&0!=this.obj.array.length){2==this.idArr&&(this.gallery=new f(this.dCGal,0,0,function(t,e){},this)),0!=this.idArr&&1!=this.idArr&&3!=this.idArr&&4!=this.idArr||(this.gallery=new DGallery(this.dCGal,0,0,function(){var t={};t.idArr=s.idArr,t.index=this.index,t.obj=this.obj,s.fun("gIndex",t)})),this.gallery.kolII=3,this.gallery.widthPic=64,this.gallery.heightPic=64,this.gallery.width=66*this.gallery.kolII+2;for(var e=0;e<this.obj.array.length;e++)this.obj.array[e].title="",this.obj.array[e].src="resources/data/"+this.obj.array[e].id+"/128.png";this.gallery.start(this.obj.array),0==this.obj.array.length?this.gallery.visible=!1:(this.obj.array.length<=this.gallery.kolII&&(this.gallery.width=66*this.obj.array.length+2),this.gallery.height=66*Math.ceil(this.obj.array.length/this.gallery.kolII)+2,-1!=this._startIndex&&(this.gallery.index=this._startIndex))}}}return u(t,[{key:"active",set:function(t){this._active!=t&&(this._active=t,this.dCGal.visible=t,this.init(),this.dragParam(),1==this._active?this.button.color=dcmParam.activButton:this.button.color=dcmParam.color)},get:function(){return this._active}},{key:"startIndex",set:function(t){this._startIndex!=t&&(this._startIndex=t,null!=this.gallery&&(this.gallery.index=t))},get:function(){return this._startIndex}}]),t}(),f=function(t){function e(t,i,n,s,o){var l;A(this,e),(l=a(this,r(e).call(this,t,i,n,s))).par=o,l._index=-1,l.par=o;var u=h(h(l));l.downBtn=function(t,e){u.fun&&u.fun(t,e)},l.createZamen=function(){return new p(this.content,0,0,this.downBtn,this)};return l.dragIndex=function(){for(var t=0;t<this.array.length;t++)this._index1==t||this._index==t?(this._index==t&&(this.array[t].activ=!0,this.array[t].setAct(0,!0),this._index1!=t&&this.array[t].setAct(1,!1)),this._index1==t&&(this.array[t].activ=!0,this.array[t].setAct(1,!0),this._index!=t&&this.array[t].setAct(0,!1))):(this.array[t].activ=!1,this.array[t].setAct(0,!1),this.array[t].setAct(1,!1))},l}return s(e,DGallery),u(e,[{key:"index",set:function(t){this._index=t},get:function(){return this._index}}]),e}(),p=function(t){function e(t,i,n,s,o){var l;A(this,e),(l=a(this,r(e).call(this,t,i,n,s))).par=o,l.dragPic=l.par.par.par.par.dragPic;var u=h(h(l));return l.down=function(t){u.fun&&u.fun("indexBig")},l.drag=function(t){var e=u.object;e.typeThree="Blok";var i="resources/data/"+u.object.id+"/original.png";u.dragPic.start(32,i,e)},l.mouseDownNew=function(t){u.dragPic.testDrag(5,u.down,u.drag)},0==dcmParam.mobile?(l.image.image.removeEventListener("mousedown",l.mouseDown),l.panel.div.removeEventListener("mousedown",l.mouseDown)):(l.image.image.removeEventListener("touchstart",l.mouseDown),l.panel.div.removeEventListener("touchstart",l.mouseDown)),0==dcmParam.mobile?(l.image.image.addEventListener("mousedown",l.mouseDownNew),l.panel.div.addEventListener("mousedown",l.mouseDownNew)):(l.image.image.addEventListener("touchstart",l.mouseDownNew),l.panel.div.addEventListener("touchstart",l.mouseDownNew)),l}return s(e,DBox),e}()}).call(this,i(0))},function(t,e,i){"use strict";function n(t){var e,i,n,a=this;this.type="MInfo",this.fun=void 0,this.dC=t,this._width=100,this._height=100,this._active=!1,this.otstup=2,this.otstup2=10,this.dCont=new DCont,this.text="null",this.panel=new DPanel(this.dCont),this.window=new DWindow(this.dCont,0,0," "),this.window.dragBool=!1,this.window.hasMinimizeButton=!1,this.label=new DLabel(this.window,this.otstup2,this.otstup2+32," "),this.button=new DButton(this.window,0,0,"Да",function(){null!=a.fun&&a.fun(),a.active=!1}),this.button1=new DButton(this.window,0,0,"Нет",function(){a.active=!1}),this.button2=new DButton(this.window,this.otstup,this.otstup,"x",function(){a.active=!1}),this.button2.width=this.button2.height=32-2*this.otstup,this.input=new DInput(this.window,10,this.otstup,"x",function(){a.text=this.text}),this.input.timeFun=1,this.tween=new TWEEN.Tween(this.dC),this.tween.onComplete(function(){a.active=!1,a.dC.alpha=1}),this.closeTime=function(t){this.tween.to({alpha:0},t).start()},this.setFun=function(t,e,i){this.active=!0,this.fun=i,this.tween.stop(),this.dC.alpha=1,console.warn(":::",t,e),this.window.text=t,this.label.text=e;var n=this.otstup2;this.button1.visible=this.button.visible=!1,this.input.visible=!1,null!=this.fun&&(n=2*this.otstup2+32,this.button1.visible=this.button.visible=!0);var a=this.label.getRect();this.window.height=this.label.y+a.height+n,this.button1.y=this.button.y=this.label.y+a.height+this.otstup2,this.sizeWindow()},this.setFunInput=function(t,e,i,n){this.active=!0,this.fun=n,this.window.text=t,this.label.text=e,this.text=i;var a=this.otstup2;this.button1.visible=this.button.visible=!1,null!=this.fun&&(a=2*this.otstup2+32,this.button1.visible=this.button.visible=!0),this.input.text=i,this.input.visible=!0;var r=this.label.getRect();this.input.y=this.label.y+r.height+5,this.window.height=this.label.y+r.height+a+32+5,this.button1.y=this.button.y=this.label.y+r.height+this.otstup2+32+5,this.sizeWindow()},this.setW=function(t){this.window.width=t,this.label.width=t-2*this.otstup2,this.input.width=t-2*this.otstup2,this.button2.x=t-this.button2.width-this.otstup,this.button1.x=t-this.otstup2-this.button1.width,this.button.x=t-2*this.otstup2-2*this.button1.width},this.setW(300),this.sizeWindow=function(t,a,r){null!=t&&(e=t,i=a,n=r),this._width=e,this._height=i,0!=this._active&&(this.panel.width=e/n,this.panel.height=i/n,this.window.x=(e/n-this.window.width)/2,this.window.y=(i/n-this.window.height)/2)},this.panel.alpha=.4,this.panel.div.addEventListener("mousedown",function(){a.active=!1}),Object.defineProperty(this,"active",{set:function(t){this._active!=t&&(this._active=t,1==t?this.dC.add(this.dCont):this.dC.remove(this.dCont))},get:function(){return this._active}})}i.d(e,"a",function(){return n})},function(t,e,i){"use strict";i.d(e,"a",function(){return n});var n=function t(e,i){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MTop";var a;this.par=e,this.fun=i,this.param=this.par.param,this._index=-1,this.dCont=new DCont(e.dCont),this.panel=new DPanel(this.dCont,0,0),this.btn=new DButton(this.panel,0,0,"save",function(){n.par.par.viewServer.saveGetObjId(n.par.par.world.getObj())}),this.dragParam=function(){this.panel.x=this.param.otstup,this.panel.y=this.param.otstup,this.panel.height=.8*this.param.wh+2*this.param.otstup,this.btn.x=this.param.otstup,this.btn.y=this.param.otstup,this.btn.height=.8*this.param.wh,this.sizeWindow()},this.sizeWindow=function(t,e,i){t&&(a=t,e,i),this.panel.width=a-2*this.param.otstup}}},function(t,e,i){"use strict";function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.d(e,"a",function(){return r});var r=function t(e,i){a(this,t),this.type="MMani";this.par=e,this.fun=i,this.param=this.par.param;var n=0;this.dCont=new DCont(e.dCont),this.array=[],this.window=new DWindow(this.dCont),this.window.width=300,this.window.height=200,this.array[this.array.length]=this.mmBablo=new s(this,this.window.content,0,0,function(t,e,i){}),this.setInfoArr=function(t){n++,this.window.title="бабло. Счет: "+n+" : "+t.length,this.mmBablo.setInfoArr(t)},this.sizeWindow=function(t,e,i){this.window.x=t/i/2,this.window.y=10},this.dragParam=function(){this.mmBablo.x=this.param.otstup,this.mmBablo.y=this.param.otstup,this.mmBablo.width=this.window.width,this.mmBablo.height=this.window.height-32;for(var t=this.array.length-1;t>=0;t--)this.array[t].dragParam&&this.array[t].dragParam()}},s=function(){function t(e,i,n,r,s){a(this,t),this.type="MMBablo";this.par=e,this.fun=s,this._width=100,this._height=100,this.dCont=new DCont(i),this.dCont.x=n,this.dCont.y=r,this.down=function(t,e){},this.gallary=new h(this.dCont,0,0,this.down,this),this.gallary.kolII=1,this.gallary.widthPic=100,this.gallary.heightPic=64,this.gallary.width=this._width,this.gallary.otstup=5,this.gallary.height=200,this.gallary.boolPositOtctup=!1,this.gallary.zScrol=-7;var A=[],l=[];this.setInfoArr=function(t){A=t,this.draw()},this.arrGal=[],this.arrGalCesh=[],this.clearAL=function(){this.arrGal.length=0;for(var t=0;t<this.arrGalCesh.length;t++)this.arrGalCesh[t].clear()},this.getGal=function(){return null==this.arrGalCesh[this.arrGal.length]&&(this.arrGalCesh[this.arrGal.length]=new o),this.arrGal.push(this.arrGalCesh[this.arrGal.length]),this.arrGal[this.arrGal.length-1]},this.clear=function(){this.array.length=0,this.clearAL(),d.length=0,c.length=0,l.length=0,f.length=0;for(var t=0;t<A.length;t++)l.push(A[t])};var u,d=[],c=[],f=[];this.array=[],this.draw=function(){this.clear(),this.drawObj(),this.drawVso(),this.gallary.start(f)},this.drawVso=function(){for(var t=0;t<c.length;t++)f.push(c[t]);for(t=0;t<f.length;t++)f[t].dragText()},this.drawObj=function(){for(var t=l.length-1;t>=0;t--)"CPalka"==l[t].type&&(d.push(l[t]),l.splice(t,1));for(t=0;t<d.length;t++){u=-1;for(var e=0;e<c.length;e++)c[e].obj.id==d[t].id&&(u=e);-1==u?(c.push(this.getGal()),c[c.length-1].setO(d[t])):c[u].setO(d[t])}}}var e,i,r;return e=t,(i=[{key:"width",set:function(t){this._width!=t&&(this._width=t,this.gallary.width=t,this.gallary.widthPic=t-2*this.gallary.otstup,this.draw())},get:function(){return this._width}},{key:"height",set:function(t){this._height!=t&&(this._height=t,this.gallary.height=t,this.draw())},get:function(){return this._height}}])&&n(e.prototype,i),r&&n(e,r),t}(),o=function t(){a(this,t),this.type="MMBGInfo",this.text="infoXZ",this.text1="infoXZ",this.text2="infoXZ",this.text3="infoXZ",this.src="null",this.obj=void 0,this.array=[],this.kol=0,this.area=null,this.gronSize=null,this.clear=function(){this.kol=0,this.obj=void 0,this.array.length=0,this.area=null,this.gronSize=null},this.setO=function(t){this.array.push(t),this.kol=this.array.length,1==this.kol&&(this.obj=t),"CPalka"===t.type&&(this.area+=t.depth*t.height/1e4,this.gronSize+=t.gron/100)},this.dragText=function(){"CPalka"==this.obj.type&&(this.area=this.area.toFixed(2),this.gronSize=this.gronSize.toFixed(2),this.text="id : "+this.obj.id,this.text1="количество : "+this.kol,this.text2="".concat(this.obj.object.str[1]," ").concat(this.area,"м² (").concat(this.area," * ").concat(this.obj.object.num[1],") ").concat((this.obj.object.num[1]*this.area).toFixed(2),"грн"),this.text3="".concat(this.obj.object.str[2]," ").concat(this.gronSize,"м (").concat(this.gronSize," * ").concat(this.obj.object.num[2],") ").concat((this.gronSize*this.obj.object.num[2]).toFixed(2),"грн"),this.src="resources/data/"+this.obj.id+"/100.png")}};function h(t,e,i,n,a){DGallery.call(this,t,e,i,n),this.par=a,this.type="DGallary1",this.bRadius=a.bRadius,this.createZamen=function(){return new A(this.content,0,0,this.downBtn,this)}}function A(t,e,i,n,a){DBox.call(this,t,e,i,n),this.type="BXZ1";var r=this;this.par=a,this.label1=new DLabel(this),this.label2=new DLabel(this),this.label3=new DLabel(this),this.arLabel=[this.label,this.label1,this.label2,this.label3];for(var s=0;s<this.arLabel.length;s++)this.arLabel[s].fontSize=12,this.arLabel[s].activMouse=!1;this.startLoad=function(t){this.object=t,this.image.link=this.object.src,this.label.text=this.object.text,this.label1.text=this.object.text1,this.label2.text=this.object.text2,this.label3.text=this.object.text3,r.funLoad(),this.draw(),r.funLoad()};var o;this.draw=function(){this.image.visible=!1,this.label.x=100,this.label.y=10;var t=this._height;(o=this._width/this.image.picWidth)>(t-2*this._otstup)/this.image.picHeight&&(o=(t-2*this._otstup)/this.image.picHeight),this.image.width=this.image.picWidth*o,this.image.height=this.image.picHeight*o,this.image.x=0,this.image.y=0;for(var e=0;e<this.arLabel.length;e++)this.arLabel[e].y=0==e?this.otstup:this.arLabel[e-1].fontSize+this.arLabel[e-1].y,this.arLabel[e].x=this.image.width+this.otstup,this.arLabel[e].width=this.panel.width-this.arLabel[e].x,this.arLabel[e].visible=!0;this.image.visible=!0,this.postDraw&&this.postDraw()}}h.prototype=Object.create(DGallery.prototype),h.prototype.constructor=h,Object.defineProperties(h.prototype,{index:{set:function(t){this._index!=t&&(this._index=t)},get:function(){return this._index}}}),A.prototype=Object.create(DBox.prototype),A.prototype.constructor=A,Object.defineProperties(A.prototype,{activ:{set:function(t){this._activ!=t&&(this._activ=t,this._activ?this.label.color="#93c32f":this.label.color="#000000",0==this._activ?this.panel.color1=this._color1:this.panel.color1=this._color)},get:function(){return this._activ}}})},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return MVisi3D});var _MEffectArray_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(23),_MPosition3d_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(20),_MEvent3DArr_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(28),_MUtility_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(24),_CubeMap_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(5);function MVisi3D(_contentHTML,_content2d,_devas,_directional,_efect,_event3DArr,_alpha){var self=this;this.contentHTML=_contentHTML,_devas=void 0!==_devas&&_devas,_directional=void 0===_directional||_directional,_efect=void 0===_efect||_efect,_event3DArr=void 0===_event3DArr||_event3DArr,_alpha=void 0!==_alpha&&_alpha,this.intRend=0,this.devas=_devas,this.alpha=_alpha,this.arrSetiScene=[],this._xVerh=0,this._yVerh=0,this._zVerh=0,this._rotationX=0,this._rotationZ=0,this._zume=1e3,this._arrOut=[],this._x=0,this._y=0,this._height=100,this._width=100,this.yes3d=!0,this.intRendOk=1,this._visible=!0,this._isDragPan=!1,this._activMouse=!0,this._staticShadow=!1,this._fov=45,this.alwaysRender=!1,this.AMBIEN_COLOR="#ffffff",this.AMBIEN_INTENSITY=.79,this.LIGHT_COLOR="#ffffff",this.LIGHT_BIAS=.001,this.SHADOW_INTENSITY=.22,this.SHADOW_RADIUS=1,this.SHADOW_WH=4096,this.DISTANCE=0,this.CUB_HEIGHT=500,this.CUB_WIDTH=500,this.FOV=45,this.FAR=45e3,this._fov=this.FOV,this.content=void 0,this.graphics=void 0,this.fun_sob=void 0,null!=_content2d&&(trace("########################"),this.content=eval("new PIXI.Container()"),this.graphics=eval("new PIXI.Graphics()"),_content2d.addChild(this.content),this.content.addChild(this.graphics),this.graphics.interactive=!0),this.camera,this.scene=new THREE.Scene;var color=16777215;this.color=color,this.camera=new THREE.PerspectiveCamera(this.FOV,this._width/this._height,1,this.FAR),this.renderer=new THREE.WebGLRenderer({antialias:!0,alpha:_alpha}),this.renderer.shadowMap.enabled=!0,this.renderer.setSize(this._width,this._height),1==_alpha?this.renderer.setClearColor(color,0):this.renderer.setClearColor(color,1),this.renderer.shadowMap.type=THREE.PCFSoftShadowMap,this.efect,this.efect=new _MEffectArray_js__WEBPACK_IMPORTED_MODULE_0__.a(this),_contentHTML.appendChild(this.renderer.domElement),this.renderer.domElement.style.zIndex=-10,this.event3DArr,1==_event3DArr&&(this.event3DArr=new _MEvent3DArr_js__WEBPACK_IMPORTED_MODULE_2__.a(this,this.camera,_contentHTML),this.scene.event3DArr=this.event3DArr,this.event3DArr.addDragEvent(this.graphics,_contentHTML),this.event3DArr.activ=this._activMouse),this.camera.position.set(0,0,-60),this.camera.rotation.set(Math.PI,0,0),this.renderer.domElement.style.position="fixed",this.renderer.domElement.style.top="0px",this.renderer.domElement.style.left="0px",this.group=new THREE.Object3D,this.group.rotation.x=Math.PI/2,this.scene.add(this.group),this.group1=new THREE.Object3D,this.group.add(this.group1),this.group2=new THREE.Object3D,this.group1.add(this.group2),this.groupObject=new THREE.Object3D,this.group2.add(this.groupObject),this.group3d=new THREE.Object3D,this.groupObject.add(this.group3d),this.gp=new THREE.Object3D,this.gp.rotation.x=Math.PI/2,this.scene.add(this.gp),this.gp1=new THREE.Object3D,this.gp.add(this.gp1),this.gp2=new THREE.Object3D,this.gp1.add(this.gp2),this.gpObject=new THREE.Object3D,this.gp2.add(this.gpObject),this.gpObject2=new THREE.Object3D,this.gp2.add(this.gpObject2),this.gpObject.position.z=1,this.gpObject.scale.set(.001,.001,.001),this.gpObject2.position.z=1,this.gpObject2.scale.set(.001,.001,.001),this.gCGG=new THREE.Object3D,this.group.add(this.gCGG),this.gCAngel=new THREE.Object3D,this.gCGG.add(this.gCAngel),this.gCam1=new THREE.Object3D,this.gCAngel.add(this.gCam1),this.gCam2=new THREE.Object3D,this.gCam1.add(this.gCam2),this.ggCam=new THREE.Object3D,this.gCam2.add(this.ggCam),this.ggCam.add(this.camera),this.ggCam.position.z=-this._zume,this.camera.position.z=0,this.axesHelper=new THREE.AxesHelper(100),this.scene.add(this.axesHelper),this.axesHelper.visible=!1,this.arrPoint=[];var disLig=4e3,powerLig=.4,dis=1e4,bbbbbb;if(this.sunLight,this.ambientLight=new THREE.AmbientLight(this.AMBIEN_COLOR,this.AMBIEN_INTENSITY),this.scene.add(this.ambientLight),this.ambientLight.castShadow=!1,1==_directional){var sunIntensity=this.SHADOW_INTENSITY;this.sunLight=new THREE.DirectionalLight(this.LIGHT_COLOR,sunIntensity,0,0,.2),this.sunLight.position.set(0,this.DISTANCE+2*this.CUB_HEIGHT,0),this.sunLight.castShadow=!0,this.sunLight.shadow.camera.near=this.CUB_HEIGHT,this.sunLight.shadow.camera.far=this.CUB_HEIGHT+2*this.CUB_HEIGHT,this.sunLight.shadow.camera.right=this.CUB_WIDTH,this.sunLight.shadow.camera.left=-this.CUB_WIDTH,this.sunLight.shadow.camera.top=this.CUB_WIDTH,this.sunLight.shadow.camera.bottom=-this.CUB_WIDTH,this.sunLight.shadow.mapSize.width=this.SHADOW_WH,this.sunLight.shadow.mapSize.height=this.SHADOW_WH,this.sunLight.shadow.bias=this.LIGHT_BIAS,this.sunLight.shadow.radius=this.SHADOW_RADIUS}this.initOut=function(){},this.position3d=new _MPosition3d_js__WEBPACK_IMPORTED_MODULE_1__.a(self,this.graphics,this.renderer.domElement),this.utility=new _MUtility_js__WEBPACK_IMPORTED_MODULE_3__.a(self),this.arrayDoRender=[],this.arrayDoRender2=[],this.shadowNeedsUpdate=!1,this.render=function(){if(0!=this.yes3d){if(0!=this.arrayDoRender2.length)for(var t=0;t<this.arrayDoRender2.length;t++)this.arrayDoRender2[t]();if(this.utility.render(),this.intRend=10,this.shadowNeedsUpdate&&(this.shadowNeedsUpdate=!1,this.renderer.shadowMap.needsUpdate=!0),this.efect?0==this.efect.render()&&this.renderer.render(this.scene,this.camera):this.renderer.render(this.scene,this.camera),0!=this.arrayDoRender.length)for(t=0;t<this.arrayDoRender.length;t++)this.arrayDoRender[t]()}},this.upDate=function(){(this.alwaysRender||this.intRend==this.intRendOk)&&this.render(),this.intRend<10&&this.intRend++},this.renderer.render(this.scene,this.camera),this.sizeWindow=function(t,e,i,n){null!=t&&(this._x=t),null!=e&&(this._y=e),null!=n&&(this._height=n),null!=i&&(this._width=i),null!=this.content&&(this.content.x=this._x,this.content.y=this._y,this.graphics.clear(),this.graphics.beginFill(16711680,0),this.graphics.drawRect(0,0,this._width,this._height),this.graphics.endFill()),this.renderer.domElement.style.left=this._x+"px",this.renderer.domElement.style.top=this._y+"px",this.camera.aspect=this._width/this._height,this.camera.updateProjectionMatrix(),this.renderer.setSize(this._width,this._height),this.intRend=1;var a=87e-5*this.camera.aspect;this.gpObject2.scale.set(a,87e-5,1),this.gpObject.scale.set(a/(this._width/1e3),87e-5/(this._height/1e3),1),this.event3DArr&&(this.event3DArr.sizeWindow(this._width,this._height),this.event3DArr.setRect(this._x,this._y,this._width,this._height)),this.efect&&this.efect.sizeWindow(this._width,this._height)},this.render(),this.sizeWindow(),this.objShadow=function(t,e){if(null==e&&(e=!0),bbbbbb=!0,t.material&&1==t.material.transparent&&t.material.opacity<1&&(bbbbbb=!1),1==bbbbbb&&(t.castShadow=e,t.receiveShadow=e),null!=t.children)for(var i=0;i<t.children.length;i++)null!=t.children?this.objShadow(t.children[i],e):(bbbbbb=!0,t.children[i].material&&1==t.material.transparent&&t.material.opacity<1&&(bbbbbb=!1),1==bbbbbb&&(t.children[i].castShadow=e,t.children[i].receiveShadow=e))},this.cubeMap=new _CubeMap_js__WEBPACK_IMPORTED_MODULE_4__.a,this.cubeMap.init(this.renderer,this.scene),this.getEnvMap=function(){return self.cubeMap.getTexture()},this.cubeMap1=new _CubeMap_js__WEBPACK_IMPORTED_MODULE_4__.a,this.cubeMap1.init(this.renderer,this.scene);var t=this.cubeMap1.getTexture();t.mapping=THREE.CubeRefractionMapping,this.cubeMap1.upDate(),this.getEnvMap1=function(){return self.cubeMap1.getTexture()},this.getObj=function(){var t={};return t.xVerh=this._xVerh,t.yVerh=this._yVerh,t.zVerh=this._zVerh,t.rotationX=this._rotationX,t.rotationZ=this._rotationZ,t.zume=this._zume,t},this.setObj=function(t){null!=t&&(this.xVerh=t.xVerh,this.yVerh=t.yVerh,this.zVerh=t.zVerh,this.rotationX=t.rotationX,this.rotationZ=t.rotationZ,this.zume=t.zume)},this.mousemove=function(t){self.position3d.stageMoveNew(t),self.event3DArr.mousemove(t)},this.getFunMouseMove=function(){return 0==self.devas?self.position3d.div.removeEventListener("mousemove",self.mousemove):self.position3d.div.removeEventListener("touchmove",self.mousemove),self.mousemove},null==_content2d?0==self.devas?self.position3d.div.addEventListener("mousemove",self.mousemove):self.position3d.div.addEventListener("touchmove",self.mousemove):(self.stageM2=function(t){self.position3d.stageMoveNew(t.data.originalEvent),self.event3DArr.mousemove(t.data.originalEvent)},0==self.devas?this.graphics.on("mousemove",self.stageM2):this.graphics.on("touchmove",self.stageM2)),document.oncontextmenu=function(t){return!1},this.addEvent=function(t,e){this.event3DArr&&this.event3DArr.eventSob.addEvent(t,e)},this.removeEvent=function(t,e){this.event3DArr&&this.event3DArr.eventSob.removeEvent(t,e)},this.addChildMouse=function(t){this.event3DArr&&this.event3DArr.addChild(t)},this.removeChildMouse=function(t){this.event3DArr&&this.event3DArr.removeChild(t)},this.fun_rotationX,this.fun_rotationZ}MVisi3D.prototype={set staticShadow(t){this.renderer.shadowMap.autoUpdate=!t,this._staticShadow=t},get staticShadow(){return this._staticShadow},set rotationX(t){this._rotationX!==t&&(this._rotationX=t,this.intRend=1,this.gCam2.rotation.x=t,this.gp2.rotation.x=t,this.fun_rotationX&&this.fun_rotationX())},get rotationX(){return this._rotationX},set rotationZ(t){this._rotationZ!==t&&(this._rotationZ=t,this.gCam1.rotation.z=t,this.gp1.rotation.z=t,this.intRend=1,this.fun_rotationZ&&this.fun_rotationZ())},get rotationZ(){return this._rotationZ},set zume(t){this._zume!==t&&(this.gpObject.position.z=1-t,this.gpObject2.position.z=1-t,this._zume=t,this.ggCam.position.z=-t,this.camera.position.z=0,this.intRend=1)},get zume(){return this._zume},set fov(t){this._fov=t,this.camera.fov=t,this.camera.updateProjectionMatrix()},get fov(){return this._fov},set yVerh(t){this._yVerh=t,this.gCGG.position.z=t,this.intRend=1},get yVerh(){return this.gCGG.position.z},set xVerh(t){this._xVerh=t,this.gCGG.position.x=t,this.intRend=1},get xVerh(){return this.gCGG.position.x},set zVerh(t){this._zVerh=t,this.gCGG.position.y=t,this.intRend=1},get zVerh(){return this.gCGG.position.y},set arrOut(t){this._arrOut=t,1!=this.alpha&&(this.efect&&this.efect.setValue(this._arrOut),this.intRend=1)},get arrOut(){return this._arrOut},set x(t){this._x=t,this.sizeWindow()},get x(){return this._x},set y(t){this._y=t,this.sizeWindow()},get y(){return this._y},set height(t){this._height=t,this.sizeWindow()},get height(){return this._height},set width(t){this._width=t,this.sizeWindow()},get width(){return this._width},set visible(t){this._visible=t,this.content.visible=t,this.renderer.domElement.style.visibility=t?"visible":"hidden"},get visible(){return this._visible},set isDragPan(t){this._isDragPan=t,this.position3d.isDragPan=t},get isDragPan(){return this._isDragPan},set activMouse(t){this._activMouse=t,this.event3DArr&&(this.event3DArr.activ=this._activMouse)},get activMouse(){return this._activMouse},set minZum(t){this.position3d.minZum=t},get minZum(){return this.position3d.minZum},set maxZum(t){this.position3d.maxZum=t},get maxZum(){return this.position3d.maxZum},set maxRotationX(t){this.position3d.minMaxX.x=t},get maxRotationX(){return this.position3d.minMaxX.x},set minRotationX(t){t<this.rotationX&&(this.rotationX=t),this.position3d.minMaxX.y=t},get minRotationX(){return this.position3d.minMaxX.y}}},function(t,e,i){"use strict";function n(t,e,i){var n=this;this.parent=t,this.content2d=e,this.drag=!0,this.zdvigX=0,this.sPixi=void 0,this.div=i,this.devas=t.devas,this.pause=!1,this.minMaxX=new THREE.Vector2(0,2.5),this.zume=new THREE.Vector3(1,30,10),this.point=new THREE.Vector2(0,0),this.point1=new THREE.Vector2(0,0),this.b=0,this.minZum=0,this.maxZum=5e3,this.powerZum=50,this.distMinMaxBox=1e4,this.boolDrahXZ=!0,this.isDragPan=t._isDragPan,this.isRotateScene=!1;var a=0;this.isIE=!1,(-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0)&&(this.isIE=!0),this.getStage=function(t){return null==t.parent?t:this.getStage(t.parent)},this.stageMoveNew=function(t){0!=n.boolDrag&&1!=n.pause&&0!=n.drag&&(t&&n.isDragPan&&h?c(t):(null==t.touches?n.isRotateScene&&t.data.originalEvent.shiftKey?(n.parent.scene.rotation.y=a+.01*(t.clientX-n.point1.x),n.parent.intRend=1):n.boolDrahXZ&&(n.parent.rotationX=n.point.y-.01*(t.clientY-n.point1.y),n.minMaxX.x>n.parent.rotationX&&(n.parent.rotationX=n.minMaxX.x),n.minMaxX.y<n.parent.rotationX&&(n.parent.rotationX=n.minMaxX.y),n.parent.rotationZ=n.point.x+.01*(t.clientX-n.point1.x)):1==t.touches.length?n.boolDrahXZ&&(n.parent.rotationX=n.point.y-.01*(t.touches[0].clientY-n.point1.y),n.minMaxX.x>n.parent.rotationX&&(n.parent.rotationX=n.minMaxX.x),n.minMaxX.y<n.parent.rotationX&&(n.parent.rotationX=n.minMaxX.y),n.parent.rotationZ=n.point.x+.01*(t.touches[0].clientX-n.point1.x)):t.touches.length>=2&&(n.pT.x=t.touches[0].clientX,n.pT.y=t.touches[0].clientY,n.pT1.x=t.touches[1].clientX,n.pT1.y=t.touches[1].clientY,0==n.distTach?(n.distTach=calc.getDistance(n.pT,n.pT1),r=0,l.set(Math.round(1*n.pT.x),Math.round(1*n.pT.y))):(s=calc.getDistance(n.pT,n.pT1),r=s-n.distTach,n.distTach=s),o=n.parent._zume-r*(n.parent._zume/100),n.zumNEW(o),c(null,Math.round(1*n.pT.x),Math.round(1*n.pT.y))),n.parent.fun_sob&&n.parent.fun_sob("mouseMove")))},this.pT=new THREE.Vector2(0,0),this.pT1=new THREE.Vector2(0,0);var r=0,s=0;this.boolDrag=!1,this.stageUpNew=function(t){n.boolDrag=!1,0==n.devas?window.removeEventListener("mouseup",n.stageUpNew):(n.distTach=0,window.removeEventListener("touchend",n.stageUpNew)),n.parent.fun_sob&&n.parent.fun_sob("mouseUp")},this.mouseUpp=function(t){n.parent.intRend=1};var o,h=!1;if(this.distTach=0,this.mouseDown=function(t){var e;1!=n.pause&&(0!=n.drag&&(h=!1,n.boolDrag=!0,n.parent.fun_sob&&n.parent.fun_sob("mouseDown"),n.distTach=0,n.point.y=n.parent.rotationX,n.point.x=n.parent.rotationZ,n.isRotateScene&&(a=n.parent.scene.rotation.y),n.isDragPan&&t&&1===t.button&&(h=!0,e=t,l.set(e.clientX,e.clientY)),0==n.devas?(n.point1.x=t.clientX,n.point1.y=t.clientY,window.addEventListener("mouseup",n.stageUpNew)):(n.point1.x=t.touches[0].clientX,n.point1.y=t.touches[0].clientY,window.addEventListener("touchend",n.stageUpNew))))},this.dragscrol=void 0,this.mousewheel=function(t){if(0!=n.drag){var e=-1;t.delta;null==t.wheelDelta&&t.wheelDelta,t.delta&&t.delta<0&&(e=1),t.deltaY&&t.deltaY<0&&(e=1),t.detail&&t.detail<0&&(e=1),null!=t.wheelDelta&&(e=t.wheelDelta>0?-1:1),o=n.parent._zume+e*(n.powerZum/100)*n.parent._zume,n.zumNEW(o),n.dragscrol&&n.dragscrol(t)}},this.zumNEW=function(t){t<n.minZum&&(t=n.minZum),t>n.maxZum&&(t=n.maxZum),n.parent.zume=t,n.parent.intRend=1},this.mouseDown2=function(t){n.mouseDown(t.data.originalEvent)},null!=this.content2d)if(this.sPixi=this.content2d,this.sPixi.interactive=!0,0==n.devas){this.content2d.on("mousedown",this.mouseDown2);document.addEventListener("mousewheel",this.mousewheel),document.addEventListener("DOMMouseScroll",this.mousewheel)}else this.content2d.on("touchstart",this.mouseDown2);else if(0==n.devas){i.addEventListener("mousedown",this.mouseDown);i.addEventListener("mousewheel",this.mousewheel),i.addEventListener("DOMMouseScroll",this.mousewheel)}else i.addEventListener("touchstart",this.mouseDown,{passive:!1,capture:!0});var A=new THREE.Vector3,l=new THREE.Vector2,u=new THREE.Vector2,d=new THREE.Vector2;function c(t,e,i){null!=t?u.set(t.clientX,t.clientY):u.set(e,i),d.subVectors(u,l),n.moveCamXY(d),l.copy(u)}var f=function(){var t=new THREE.Vector3;return function(e,i){t.setFromMatrixColumn(i,0),t.multiplyScalar(-e),A.add(t)}}(),p=function(){var t=new THREE.Vector3;return function(e,i){t.setFromMatrixColumn(i,1),t.multiplyScalar(e),A.add(t)}}(),g=function(t,e){var i=n.parent.renderer.domElement;if(n.parent.camera.isPerspectiveCamera){var a=Math.max(n.parent.zume,10);a*=Math.tan(n.parent.camera.fov/2*Math.PI/180),f(2*t*a/i.clientHeight,n.parent.camera.matrixWorld),p(2*e*a/i.clientHeight,n.parent.camera.matrixWorld)}else console.warn("WARNING: camera neither perspective.")};this.moveCamXY=function(t){A.set(0,0,0),n.parent.camera.updateMatrixWorld(),n.parent.scene.updateMatrixWorld(),arguments.length>1&&(t={x:arguments[0],y:arguments[1]}),g(t.x||0,t.y||0),n.parent.xVerh+=A.x,n.parent.yVerh+=-A.y,n.parent.zVerh+=A.z,n.parent.xVerh=Math.max(Math.min(n.parent.xVerh,n.distMinMaxBox),-n.distMinMaxBox),n.parent.zVerh=Math.max(Math.min(n.parent.zVerh,n.distMinMaxBox),-n.distMinMaxBox),n.parent.yVerh=Math.max(Math.min(n.parent.yVerh,n.distMinMaxBox),-n.distMinMaxBox),A.set(0,0,0)}}i.d(e,"a",function(){return n})},function(t,e,i){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t){this.type="SceneSB",this.visi3D=t;this.array=[],this.object=void 0,this.array.push(new h("ambient",t)),this.array.push(new o("shadow",t)),this.array.push(new A("sky",t)),this.array.push(new l("mirror",t)),this.array.push(new u("visi3D",t)),this.array.push(new d("effect",t)),this.array.push(new c("fog",t)),this.setObj=function(t){this.object=t;for(var e=0;e<this.array.length;e++)void 0===this.object[this.array[e].name]&&(this.object[this.array[e].name]={}),this.array[e].setBasa(this.object[this.array[e].name]);visi3D.shadowNeedsUpdate=!0}}function r(t,e){this.type="SceneBox";this.name=t,this.array=[],this.object=null,this.objArray={},this.plus=function(t,e){this.array.push(new s(t,e)),this.objArray[t.param]=this.array[this.array.length-1]},this.setValue=function(t,e,i){null==i?this.object[t]=e:this.drahKeyParam(t,e)},this.drahKey=function(t){null==this.objArray.works||0!=this.object.works?(null!=this.objArray[t]&&(1==this.objArray[t].tipP&&("object"===n(this.objArray[t].param[t])?this.objArray[t].param[t]=this.object[t]:this.objArray[t].param[t]!=this.object[t]&&(this.objArray[t].param[t]=this.object[t])),2==this.objArray[t].tipP&&this.objArray[t].param(this.object[t])),e.intRend=1):"active"==t&&this.objArray.active.param&&(this.objArray.active.param(this.object.active),e.intRend=1)},this.drahKeyParam=function(t,i){null!=this.objArray[t]&&(1==this.objArray[t].tipP&&("object"===n(this.objArray[t].param[t])?this.objArray[t].param[t]=i:this.objArray[t].param[t]!=i&&(this.objArray[t].param[t]=i)),2==this.objArray[t].tipP&&this.objArray[t].param(i)),e.intRend=1},this.setBasa=function(t){this.object=t;for(var e=0;e<this.array.length;e++)null==t[this.array[e].object.param]&&(t[this.array[e].object.param]=this.array[e].object.valueStart);this.drahKeys()},this.drahKeys=function(){for(var t=0;t<this.array.length;t++)this.drahKey(this.array[t].object.param)},this.plus({name:"check10",typeParam:"DCheckBox",param:"works",title:"works//false не работает",valueStart:!0})}function s(t,e){this.type="SceneGron";this.object=t,this.param=e,this.tipP=0,null!=e&&("object"===n(e)&&(this.tipP=1),"function"==typeof e&&(this.tipP=2))}function o(t,e){r.call(this,t,e),this.type="SceneBox1";this.plus({name:"check",typeParam:"DCheckBox",param:"active",title:"active",valueStart:!1},function(t){e.utility.sunActiv(t)}),this.plus({name:"slider10",typeParam:"DSliderBig",param:"mapSize",title:"mapSize",min:64,max:8192,value:2048,okrug:1,valueStart:e.SHADOW_WH},function(t){t=t||e.SHADOW_WH,e.sunLight.shadow.mapSize.width!=t&&(e.sunLight.shadow.mapSize.width=t,e.sunLight.shadow.mapSize.height=t)}),this.plus({name:"color",typeParam:"DColor",param:"color",title:"color",valueStart:e.LIGHT_COLOR},function(t){var i=t;if("string"==typeof i&&-1!=i.indexOf("x")){var n=i.split("x");i="#"+n[1]}e.sunLight.color=new THREE.Color(i)}),this.plus({name:"slider",typeParam:"DSliderBig",param:"bias",title:"bias",min:-.05,max:.05,value:0,okrug:1e4,valueStart:e.LIGHT_BIAS},e.sunLight.shadow),this.plus({name:"slider1",typeParam:"DSliderBig",param:"intensity",title:"intensity",min:0,max:5,value:1,okrug:100,valueStart:e.SHADOW_INTENSITY},e.sunLight),this.plus({name:"slider2",typeParam:"DSliderBig",param:"radius",title:"radius",min:0,max:50,value:1,valueStart:e.SHADOW_RADIUS},e.sunLight.shadow),this.plus({name:"check2",typeParam:"DCheckBox",param:"bAlphaForCoating",title:"SAMPLE_ALPHA..",value:!0,valueStart:!1},function(t){var i=e.renderer.getContext();t?i.enable(i.SAMPLE_ALPHA_TO_COVERAGE):i.disable(i.SAMPLE_ALPHA_TO_COVERAGE)}),this.plus({name:"check3",typeParam:"DCheckBox",param:"fixation",title:"fixation",value:!1,valueStart:e.utility.FIXATION},e.utility),this.plus({name:"slider4",typeParam:"DSliderBig",param:"rotationX",title:"rotationX",min:-Math.PI,max:Math.PI,okrug:100,value:0,valueStart:e.utility.ROTATION_X},e.utility),this.plus({name:"slider5",typeParam:"DSliderBig",param:"rotationZ",title:"rotationZ",min:-Math.PI,max:Math.PI,okrug:100,value:0,valueStart:e.utility.ROTATION_Z},e.utility),this.plus({name:"slider6",typeParam:"DSliderBig",param:"distance",title:"distance",min:0,max:1e4,value:0,valueStart:e.utility.DISTANCE},e.utility),this.plus({name:"slider7",typeParam:"DSliderBig",param:"cubWidth",title:"cubWidth",min:10,max:1e4,value:0,valueStart:e.utility.CUB_WIDTH},e.utility),this.plus({name:"slider8",typeParam:"DSliderBig",param:"cubHeight",title:"cubHeight",min:10,max:1e4,value:0,valueStart:e.utility.CUB_HEIGHT},e.utility),this.plus({name:"slider9",typeParam:"DSliderBig",param:"distanceUpdateShadow",title:"distUpdateShadow ",min:-1,max:500,value:0,valueStart:e.utility.distanceUpdateShadow},e.utility)}function h(t,e){r.call(this,t,e);var i=this;this.type="SceneBox2",this.plus({name:"check",typeParam:"DCheckBox",param:"active",title:"active",valueStart:!0},function(t){e.utility.ambientActiv(t)}),this.plus({name:"color",typeParam:"DColor",param:"color",title:"color",tipParam:2,valueStart:e.AMBIEN_COLOR},function(t){var n=t;if("string"==typeof n&&-1!=n.indexOf("x")){var a=n.split("x");n="#"+a[1]}i.setValue(this.object.param,n),e.ambientLight.color=new THREE.Color(n)}),this.plus({name:"slider",typeParam:"DSliderBig",param:"intensity",title:"intensity",min:0,max:5,okrug:100,valueStart:e.AMBIEN_INTENSITY},e.ambientLight)}function A(t,e){r.call(this,t,e),this.type="SceneBox3";this.plus({name:"check",typeParam:"DCheckBox",param:"active",title:"active",valueStart:!1},function(t){e.utility.sky.active=t}),this.plus({name:"color",typeParam:"DColor",param:"color",title:"color",valueStart:e.utility.sky.COLOR},e.utility.sky),this.plus({name:"contLoader",typeParam:"DVisualLoader",param:"link",title:"LoadPic",valueStart:e.utility.sky.LINK},e.utility.sky),this.plus({name:"slider",typeParam:"DSliderBig",param:"radius",title:"radius",min:10,max:15e3,okrug:1,valueStart:e.utility.sky.RADIUS},e.utility.sky)}function l(t,e){r.call(this,t,e),this.type="SceneBox5";this.plus({name:"text1",typeParam:"DLabel",param:"xz",title:"Load",valueStart:"reflect"}),this.plus({name:"contLoader",typeParam:"DVisualLoader",param:"link",title:"Load",valueStart:"null"},function(t){e.cubeMap.link=t}),this.plus({name:"sliderExp",typeParam:"DSliderBig",param:"exposure",title:"exposure",min:-10,max:10,okrug:100,valueStart:-1},function(t){e.cubeMap.exposure=t}),this.plus({name:"slider1",typeParam:"DSliderBig",param:"gamma",title:"gamma//в хдр",min:-10,max:10,okrug:100,valueStart:-1},function(t){e.cubeMap.gamma=t}),this.plus({name:"text1",typeParam:"DLabel",param:"xz",title:"Load",valueStart:"refract"}),this.plus({name:"contLoader1",typeParam:"DVisualLoader",param:"link1",title:"Load",valueStart:"null"},function(t){e.cubeMap1.link=t}),this.plus({name:"sliderExp1",typeParam:"DSliderBig",param:"exposure1",title:"exposure",min:-10,max:10,okrug:100,valueStart:-1},function(t){e.cubeMap1.exposure=t}),this.plus({name:"slider2",typeParam:"DSliderBig",param:"gamma1",title:"gamma//в хдр",min:-10,max:10,okrug:100,valueStart:-1},function(t){e.cubeMap1.gamma=t})}function u(t,e){r.call(this,t,e),this.type="SceneBox6";var i=this;this.plus({name:"check0",typeParam:"DCheckBox",param:"alwaysRender",title:"autoRender",valueStart:!1},function(t){e.alwaysRender!==t&&(e.alwaysRender=t)}),this.plus({name:"slider",typeParam:"DSliderBig",param:"fov",title:"fov",min:0,max:90,okrug:1,valueStart:e.FOV}),this.plus({name:"slider1",typeParam:"DSliderBig",param:"far",title:"far",min:100,max:5e4,okrug:1,valueStart:e.FAR},function(t){e.camera.far!=t&&(e.camera.far=t,e.camera.updateProjectionMatrix())}),this.plus({name:"slider2",typeParam:"DSliderBig",param:"minZum",title:"minZum",min:0,max:2e4,okrug:1,valueStart:0},function(t){e.minZum=t,e.minZum>e.maxZum&&(e.maxZum=e.minZum,i.setValue("maxZum",t))}),this.plus({name:"slider3",typeParam:"DSliderBig",param:"maxZum",title:"maxZum",min:0,max:2e4,okrug:1,valueStart:2e4},function(t){e.maxZum=t,e.maxZum<e.minZum&&(e.minZum=e.maxZum,i.setValue("minZum",t))}),this.plus({name:"slider4",typeParam:"DSliderBig",param:"zume",title:"powerZum",min:1,max:2e4,okrug:1,valueStart:250}),this.plus({name:"slider11",typeParam:"DSliderBig",param:"powerZum",title:"zoom",min:1,max:100,okrug:1,valueStart:50},function(t){e.position3d.powerZum!==t&&(e.position3d.powerZum=t)}),this.plus({name:"slider5",typeParam:"DSliderBig",param:"minRotationX",title:"minAngel",min:0,max:3,okrug:100,valueStart:2.5},function(t){e.minRotationX!==t&&(e.minRotationX=t)}),this.plus({name:"slider6",typeParam:"DSliderBig",param:"maxRotationX",title:"maxAngel",min:0,max:3,okrug:100,valueStart:0},function(t){e.maxRotationX!==t&&(e.maxRotationX=t)}),this.plus({name:"check1",typeParam:"DCheckBox",param:"debug",title:"debug",valueStart:!0},function(t){e.utility.debug!==t&&(e.utility.debug=t)}),this.plus({name:"check2",typeParam:"DCheckBox",param:"isDragPan",title:"isDragPan",valueStart:!0},function(t){e.position3d.isDragPan!==t&&(e.position3d.isDragPan=t)}),this.plus({name:"check3",typeParam:"DCheckBox",param:"alphaAd",title:"alpha Админ для фотки",valueStart:!1}),this.plus({name:"slider7",typeParam:"DSliderBig",param:"zume",title:"zoom",min:5,max:2e3,okrug:1,valueStart:250},function(t){e.zume=t}),this.plus({name:"slider8",typeParam:"DSliderBig",param:"rotationX",title:"rotationX",min:-Math.PI,max:Math.PI,okrug:100,valueStart:0},function(t){e.rotationX=t}),this.plus({name:"slider9",typeParam:"DSliderBig",param:"rotationZ",title:"rotationZ",min:-Math.PI,max:Math.PI,okrug:100,valueStart:0},function(t){e.rotationZ=t}),this.plus({name:"slider10",typeParam:"DSliderBig",param:"globZ",title:"globZ",min:-1e3,max:1e3,okrug:1,valueStart:0},function(t){e.yVerh=t})}function d(t,e){r.call(this,t,e),this.type="SceneBox7";this.plus({name:"check",typeParam:"DCheckBox",param:"active",title:"active",valueStart:!1},e.efect),this.plus({name:"slider",typeParam:"DSliderBig",param:"edgeStrength",title:"edgeStrength",min:0,max:10,okrug:100,valueStart:e.efect.edgeStrength},e.efect),this.plus({name:"slider1",typeParam:"DSliderBig",param:"edgeGlow",title:"edgeGlow",min:0,max:1,okrug:100,valueStart:e.efect.edgeGlow},e.efect),this.plus({name:"slider2",typeParam:"DSliderBig",param:"edgeThickness",title:"edgeThickness",min:0,max:5,okrug:100,valueStart:e.efect.edgeThickness},e.efect),this.plus({name:"slider3",typeParam:"DSliderBig",param:"pulsePeriod",title:"pulsePeriod",min:0,max:5,okrug:100,valueStart:e.efect.pulsePeriod},e.efect),this.plus({name:"contLoader",typeParam:"DVisualLoader",param:"linkTextur",title:"linkTextur",valueStart:e.efect.linkTextur},e.efect),this.plus({name:"color",typeParam:"DColor",param:"visibleEdgeColor",title:"vEdgeColor",valueStart:e.efect.visibleEdgeColor},e.efect),this.plus({name:"color1",typeParam:"DColor",param:"hiddenEdgeColor",title:"hEdgeColor",valueStart:e.efect.hiddenEdgeColor},e.efect)}function c(t,e){r.call(this,t,e),this.type="SceneBox9";e.sbfog=new f(e),this.plus({name:"check",typeParam:"DCheckBox",param:"active",title:"active",valueStart:!1},function(t){e.sbfog.active=t}),this.plus({name:"color1",typeParam:"DColor",param:"color",title:"outlineColor1",valueStart:e.sbfog._color},function(t){var i=t;e.sbfog.color=i}),this.plus({name:"slider1",typeParam:"DSliderBig",param:"near",title:"near",min:0,max:1e4,okrug:1,valueStart:50},e.sbfog),this.plus({name:"slider2",typeParam:"DSliderBig",param:"far",title:"far",min:0,max:2e4,okrug:1,valueStart:100},e.sbfog)}function f(t){this._active=!1,this._color="#ffffff",this._near=50,this._far=1e3,this.visi=t,this.fog=new THREE.Fog(this._color,this._near,this._far)}i.d(e,"a",function(){return a}),f.prototype={set active(t){this._active!=t&&(this._active=t,1==this._active?this.visi.scene.fog=this.fog:this.visi.scene.fog=null)},get active(){return this._active},set color(t){this._color!=t&&(this._color=t,this.fog.color=new THREE.Color(t))},get color(){return this._color},set near(t){this._near!=t&&(this._near=t,this.fog.near=t)},get near(){return this._near},set far(t){this._far!=t&&(this._far=t,this.fog.far=t)},get far(){return this._far}}},function(t,e,i){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(){var t,e,i,a,s=new THREE.Vector3(0,0,0),o=new THREE.Vector3(0,0,0),h=new THREE.Vector3(0,0,0),A=new THREE.Vector3(0,0,0);this.DEG2RAD=Math.PI/180,this.RAD2DEG=180/Math.PI,this.getAngle=function(t,e){return e=e||A,t=t||A,Math.atan2(e.y-t.y,e.x-t.x)};var l,u,d,c,f,p,g,m,x,b=0;this.getAngle2=function(t,e){return e=e||A,t=t||A,(b=Math.atan2(e.y-t.y,e.x-t.x))<0&&(b+=2*Math.PI),b},this.getDistance=function(t,e){return null==t?0:(null==e&&(e=A),e=e||A,Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)))},this.getVector=function(t,e,i){if(null==i)i=new THREE.Vector2(0,0);return t<0&&(e+=Math.PI),i.x=Math.abs(t)*Math.cos(e),i.y=Math.abs(t)*Math.sin(e),i},this.isPointInLin=function(t,i,n,r,s){return this.getTreeAngel(t,i,n),s<0&&2*Math.abs(s)>a?null:o.x<=a+s&&o.x>=-s&&Math.abs(o.y)<=r?((h=o.x<0?this.getVector(o.x,e-Math.PI):this.getVector(o.x,e)).x+=i.x,h.y+=i.y,h.z=o.y,h):null},this.okrugPoint=function(t,e){null==e&&(e=100),t.x=Math.round(t.x/e)*e,t.y=Math.round(t.y/e)*e},this.okrugNumber=function(t,e){null==e&&(e=100);var i=Math.round(t*e)/e;return t=i,i},this.isInTriangle=function(t,e,i,n){var a=(t.x-n.x)*(e.y-t.y)-(e.x-t.x)*(t.y-n.y),r=(e.x-n.x)*(i.y-e.y)-(i.x-e.x)*(e.y-n.y),s=(i.x-n.x)*(t.y-i.y)-(t.x-i.x)*(i.y-n.y);return a>=0&&r>=0&&s>=0||a<=0&&r<=0&&s<=0},this.getTreeAngel=function(t,n,r,s){return e=this.getAngle(n,t),i=this.getAngle(n,r),l=this.getDistance(n,r),a=this.getDistance(t,n),this.getVector(l,i-e,o),i=this.getAngle(A,o),null==s?i:i>0?i:2*Math.PI+i},this.getTreeAngelPI2=function(t,e,i){x1=t.x-e.x,x2=i.x-e.x,y1=t.y-e.y,y2=i.y-e.y,a=Math.sqrt(x1*x1+y1*y1),d2=Math.sqrt(x2*x2+y2*y2);var n=(x1*x2+y1*y2)/(a*d2);return n>1&&(n=1),n<-1&&(n=-1),Math.acos(n)},this.isLineInTriangle=function(e,i,n,a,r){return(t=this.getPointOfIntersection(e,i,a,r))?(s.x=t.x,s.y=t.y,s.z=0,s):(t=this.getPointOfIntersection(i,n,a,r))?(s.x=t.x,s.y=t.y,s.z=1,s):!!(t=this.getPointOfIntersection(n,e,a,r))&&(s.x=t.x,s.y=t.y,s.z=2,s)};var y,v,_,w,E=new THREE.Vector2(0,0);this.getPointOfIntersection=function(t,e,i,n){return l=(t.x-e.x)*(n.y-i.y)-(t.y-e.y)*(n.x-i.x),u=(t.x-i.x)*(n.y-i.y)-(t.y-i.y)*(n.x-i.x),d=(t.x-e.x)*(t.y-i.y)-(t.y-e.y)*(t.x-i.x),f=d/l,(c=u/l)>=0&&c<=1&&f>=0&&f<=1?(p=t.x+c*(e.x-t.x),g=t.y+c*(e.y-t.y),E.x=p,E.y=g,E):null},this.korektToLine=function(t,e,i,n,a){m=this.getDistance(t,e),x=null==a?this.getAngle(t,e):a,0!=n&&(E=n<0?this.getVector(-n,x-Math.PI/2):this.getVector(n,x+Math.PI/2),t.x+=E.x,t.y+=E.y,e.x+=E.x,e.y+=E.y),E=this.getVector(i,x),e.x+=E.x,e.y+=E.y,E=this.getVector(i,x+Math.PI),t.x+=E.x,t.y+=E.y},this.getProsent3Point=function(t,e,i){return u=this.getDistance(t,e),(d=this.getDistance(t,i))/u},this.povotorOtAngel=function(t,e,i){return x=this.getAngle(t,e),m=this.getDistance(t,e),this.getVector(m,x+i)},this.testPositPoint=function(t,e,i){return null==i&&(i=100),Math.round(t.x*i)/i==Math.round(e.x*i)/i&&Math.round(t.y*i)/i==Math.round(e.y*i)/i},this.okrugAngel=function(t,e,i){var n=t;y=1,t<0&&(y=-1),v=Math.abs(t),_=Math.round(v/e)+1,w=0;for(var a=_;a>=0;a--){if(v>a*e-i&&v<a*e+i)return n=a*e*y;if(3==++w)return n}return n};var I=new r,C=new r,T=[];this.getLineCircleIntersectionPoints=function(t,e,i,n,a){T.length=0;var r=e.x-t.x,s=e.y-t.y,o=i.x-t.x,h=i.y-t.y,A=r*r+s*s,l=(r*o+s*h)/A,u=l*l-(o*o+h*h-n*n)/A;if(u<0)return T;var d=Math.sqrt(u),c=-l+d,f=-l-d;return I.set(t.x-r*c,t.y-s*c),this.isPointInLine(t,e,I)&&T.push(I),0==u?T:(C.set(t.x-r*f,t.y-s*f),this.isPointInLine(t,e,C)&&T.push(C),a&&2==T.length&&(y=this.getDistance(t,T[0]),v=this.getDistance(t,T[1]),y>v&&T.reverse()),T)},this.isPointInLine=function(t,e,i){var n=this.getDistance(t,e),a=this.getDistance(t,i),r=this.getDistance(e,i);return this.okrugNumber(a+r)===this.okrugNumber(n)},this.getDistancePointToLine=function(t,e,i){var n=((e.y-t.y)*i.x-(e.x-t.x)*i.y+e.x*t.y-e.y*t.x)/this.getDistance(t,e);return-this.okrugNumber(Number.isFinite(n)?n:0)},this.getCircleCircleIntersectionPoints=function(t,e,i,n){var a,r,s,o,h;return T.length=0,(s=Math.sqrt(Math.pow(Math.abs(t.x-i.x),2)+Math.pow(Math.abs(t.y-i.y),2)))>e+n?T:(o=(e*e-n*n+s*s)/(2*s),h=Math.sqrt(Math.pow(e,2)-Math.pow(o,2)),isNaN(h)?T:(a=t.x+o*(i.x-t.x)/s,r=t.y+o*(i.y-t.y)/s,I.x=a+h*(i.y-t.y)/s,I.y=r-h*(i.x-t.x)/s,T.push(I),o==e?T:(C.x=a-h*(i.y-t.y)/s,C.y=r+h*(i.x-t.x)/s,T.push(C),T)))};var P=[new r,new r,new r,new r],M=[new r,new r,new r,new r];this.isIntersectionRect=function(t,e){return P[0].set(t.x,t.y),P[1].set(t.x+t.width,t.y),P[2].set(t.x+t.width,t.y+t.height),P[3].set(t.x,t.y+t.height),M[0].set(e.x,e.y),M[1].set(e.x+e.width,e.y),M[2].set(e.x+e.width,e.y+e.height),M[3].set(e.x,e.y+e.height),this.isIntersectionFromPoint(P,M)},this.isIntersectionFromPoint=function(t,e){for(var i=0;i<t.length-2;i++)for(var n=0;n<e.length-2;n++)if(this.getPointOfIntersection(t[i],t[(i+2)%t.length],e[n],e[(n+2)%e.length]))return!0;for(i=0;i<t.length;i++)for(n=0;n<e.length;n++)if(this.getPointOfIntersection(t[i],t[(i+1)%t.length],e[n],e[(n+1)%e.length]))return!0;for(i=0;i<e.length;i+=2)if(this.contains(e[i].x,e[i].y,t))return!0;for(i=0;i<t.length;i+=2)if(this.contains(t[i].x,t[i].y,e))return!0;return!1},this.isParalel=function(t,e,i,n,a){a=a||0;var r=Math.abs(this.getAngle(t,e)%Math.PI),s=Math.abs(this.getAngle(e,t)%Math.PI),o=Math.abs(this.getAngle(i,n)%Math.PI),h=Math.abs(this.getAngle(n,i)%Math.PI);return Math.min(Math.abs(r-o),Math.abs(s-h),Math.abs(r-h),Math.abs(s-o))<=a},this.rotationPoint=function(t,e,i){var n=0,a=0;i?(n=i.x+(t.x-i.x)*Math.cos(e)-(t.y-i.y)*Math.sin(e),a=i.y+(t.y-i.y)*Math.cos(e)+(t.x-i.x)*Math.sin(e)):(n=t.x*Math.cos(e)-t.y*Math.sin(e),a=t.y*Math.cos(e)+t.x*Math.sin(e)),t.x=n,t.y=a},this.rotationPointByLength=function(t,e,i){i=i||A;var n=this.getDistance(t,i),a=this.getLenghtCircle(n),r=e*(2*Math.PI/a);this.rotationPoint(t,r,i)},this.isIntersectionTriangle=function(t,e,i,n,a,r){for(var s=!1,o=[t,e,i],h=[n,a,r],A=0;A<o.length&&!s;A++)s=this.isInTriangle(n,a,r,o[A]);for(A=0;A<h.length&&!s;A++)s=this.isInTriangle(t,e,i,h[A]);if(!s)for(A=0;A<o.length;A++)for(var l=0;l<h.length&&!s;l++)s=this.getPointOfIntersection(o[A],o[(A+1)%o.length],h[l],h[(l+1)%h.length]);return s},this.getArrPointCircle=function(t,e,i,n,a,s,o){var h,A=this.getAngle(i,t)-Math.PI,l=this.getAngle(n,t)-Math.PI;h=o||[new r],a=a||5,!(s=s||!1)&&l<=A?l+=2*Math.PI:s&&A<=l&&(A+=2*Math.PI);var u=s?-1*(A-l):l-A,d=Math.ceil(Math.abs(u)/(2*Math.PI))*(a-1),c=u/(2*d),f=2*c,p=Math.cos(c),g=Math.sin(c),m=d-1,x=m%1/m,b=0,y=0,v=0,_=0,w=0;h[0].x=t.x+Math.cos(A)*e,h[0].y=t.y+Math.sin(A)*e;for(var E=0;E<=m;E++)b=c+A+(f*E+x*E),_=(p*(y=Math.cos(b))+g*(v=-Math.sin(b)))*e+t.x,w=(p*-v+g*y)*e+t.y,h[E+1]?(h[E+1].x=_,h[E+1].y=w):h.push(new r(_,w));return h},this.getLenghtCircle=function(t,e,i,n,a){e||(e=i=n=A);var r=this.getAngle(i,e)-Math.PI,s=this.getAngle(n,e)-Math.PI;return r===s&&i!==n?0:(!(a=a||!1)&&s<=r?s+=2*Math.PI:a&&r<=s&&(r+=2*Math.PI),Math.PI*t*(a?r-s:s-r)/Math.PI)},this.getLengthByWidth=function(t,e){var i=new r(0,0),n=new r(t,0),a=this.getVector(e,.5*Math.PI);a.x=t/2;var s=this.getCenterCircle(i,n,a);return s?this.getLenghtCircle(this.getDistance(s,i),s,i,n,e>0):t},this.getCenterCircle=function(t,e,i){var n=e.x-t.x,a=e.y-t.y,s=i.x-t.x,o=i.y-t.y,h=n*(t.x+e.x)+a*(t.y+e.y),A=s*(t.x+i.x)+o*(t.y+i.y),l=2*(n*(i.y-e.y)-a*(i.x-e.x));return 0===l?null:new r((o*h-a*A)/l,(n*A-s*h)/l)},this.getArcPoint=function(t,e,i,n,a){n=n||5;var s=this.getAngle(t,e)+90*this.DEG2RAD,o=this.getVector(i,s),h=new r((t.x+e.x)/2,(t.y+e.y)/2);h.x+=o.x,h.y+=o.y;var A=this.getCenterCircle(t,h,e);return A?this.getArrPointCircle(A,this.getDistance(A,t),t,e,n,i>0,a):[t,e]},this.getArea=function(t){for(var e=t.length,i=0,n=e-1,a=0;a<e;n=a++)i+=t[n].x*t[a].y-t[a].x*t[n].y;return.5*i||0},this.generateUUID=function(){for(var t=[],e=0;e<256;e++)t[e]=(e<16?"0":"")+e.toString(16);return function(){var e=4294967295*Math.random()|0,i=4294967295*Math.random()|0,n=4294967295*Math.random()|0,a=4294967295*Math.random()|0;return(t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255]+"-"+t[255&i]+t[i>>8&255]+"-"+t[i>>16&15|64]+t[i>>24&255]+"-"+t[63&n|128]+t[n>>8&255]+"-"+t[n>>16&255]+t[n>>24&255]+t[255&a]+t[a>>8&255]+t[a>>16&255]+t[a>>24&255]).toUpperCase()}}(),this.generateRendom=function(t){null==t&&(t=2);for(var e,i="",n="",a=0;a<t;a++){if((n=(255&(e=4294967295*Math.random()|0)).toString(16)+(e>>8&255).toString(16)+(e>>16&255).toString(16)+(e>>24&255).toString(16)).length<8)for(var r=0;r<8-n.length+1;r++)n+="Z";i+=n,a!=t-1&&(i+="-")}return i},this.diffNum=function(t,e){return t>=0&&e>=0?Math.abs(t-e):t<=0&&e<=0?Math.abs(Math.abs(t)-Math.abs(e)):t<=0&&e>=0?Math.abs(t)+e:t>=0&&e<=0?t+Math.abs(e):void 0},this.getPercentNum=function(t,e,i){return((t=null!=t?t:0)-(e=null!=e?e:0))/((i=null!=i?i:100)-e)*100},this.getValueNum=function(t,e,i){return(t=null!=t?t:0)/100*((i=null!=i?i:100)-(e=null!=e?e:0))+e},this.getValueBetween=function(t,e,i){var n=Math.max(e,i),a=Math.min(e,i);return Math.max(Math.min(t,n),a)},this.contains=function(t,e,i){for(var n=!1,a=i.length,r=0,s=a-1;r<a;s=r++){if(i[r].x===t&&i[r].y===e)return!0;var o=i[r].x,h=i[r].y,A=i[s].x,l=i[s].y;h>e!=l>e&&t<(A-o)*(e-h)/(l-h)+o&&(n=!n)}return n};var S={maxX:0,minX:0,maxY:0,minY:0},F=new r,D=[new r,new r,new r,new r],R=new r;this.getBoundsRect=function(t,e){R.set(t.width/2,t.height/2),D[0].set(0,0),D[1].set(t.width,0),D[2].set(t.width,t.height),D[3].set(0,t.height);for(var i=0;i<D.length;i++)this.rotationPoint(D[i],e,R);S.maxX=-t.width,S.minX=t.width,S.maxY=-t.height,S.minY=t.height;for(i=0;i<D.length;i++)S.maxX=Math.max(S.maxX,D[i].x),S.minX=Math.min(S.minX,D[i].x),S.maxY=Math.max(S.maxY,D[i].y),S.minY=Math.min(S.minY,D[i].y);return F.x=S.minX,F.y=S.minY,F.width=S.maxX-S.minX,F.height=S.maxY-S.minY,F},this.getCurvatureByWidth=function(t,e){if(Math.abs(t)>2*e)return null;var i=Math.pow(Math.abs(t),2),n=Math.pow(e,2),a=Math.acos((n+n-i)/(2*n));return e*(1-Math.cos(a/2))*(t<0?-1:1)},this.getWidthByCurvature=function(t,e){return 2*e*Math.sin(Math.acos(1-2*Math.abs(t)/(2*e)))*(t<0?-1:1)};function B(t){return t!==Object(t)}this.compare=function t(e,i){if(B(e)&&B(i))return e===i;for(var a in e){if(e.hasOwnProperty(a)!==i.hasOwnProperty(a))return!1;switch(n(e[a])){case"object":if(!t(e[a],i[a]))return!1;break;case"function":if(void 0===i[a]||"compare"!==a&&e[a].toString()!==i[a].toString())return!1;break;case"number":if(Number(Number(e[a]).toFixed(3))!==Number(Number(i[a]).toFixed(3)))return!1;break;default:if(e[a]!==i[a])return!1}}for(var a in i)if(e.hasOwnProperty(a)!==i.hasOwnProperty(a))return!1;return!0}}function r(t,e,i){this._x=t||0,this._y=e||0,this._z=i||0,this.set=function(t,e,i){this._x=t||0,this._y=e||0,void 0!==i&&(this._z=i)},this.setPoint=function(t){this._x=t.x,this._y=t.y,void 0!==t.z&&(this._z=t.z)},this.getObj=function(){var t={};return t.x=this._x,t.y=this._y,t.z=this._z,t},this.copy=function(){return new r(this._x,this._y,this._z)}}i.d(e,"a",function(){return a}),r.prototype={set x(t){this._x=t},get x(){return this._x},set y(t){this._y=t},get y(){return this._y},set z(t){this._z=t},get z(){return this._z}}},function(t,e,i){"use strict";function n(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}var a,r,s;Object.assign(n.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),n.FullScreenQuad=(a=new THREE.OrthographicCamera(-1,1,1,-1,0,1),r=new THREE.PlaneBufferGeometry(2,2),s=function(t){this._mesh=new THREE.Mesh(r,t)},Object.defineProperty(s.prototype,"material",{get:function(){return this._mesh.material},set:function(t){this._mesh.material=t}}),Object.assign(s.prototype,{render:function(t){t.render(this._mesh,a)}}),s);var o=function(t,e){n.call(this),this.textureID=void 0!==e?e:"tDiffuse",t instanceof THREE.ShaderMaterial?(this.uniforms=t.uniforms,this.material=t):t&&(this.uniforms=THREE.UniformsUtils.clone(t.uniforms),this.material=new THREE.ShaderMaterial({defines:Object.assign({},t.defines),uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader})),this.fsQuad=new n.FullScreenQuad(this.material)};o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,render:function(t,e,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?(t.setRenderTarget(null),this.fsQuad.render(t)):(t.setRenderTarget(e),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),this.fsQuad.render(t))}});var h=function(t,e){if(this.renderer=t,void 0===e){var i={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1},n=t.getSize(new THREE.Vector2);this._pixelRatio=t.getPixelRatio(),this._width=n.width,this._height=n.height,(e=new THREE.WebGLRenderTarget(this._width*this._pixelRatio,this._height*this._pixelRatio,i)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=e.width,this._height=e.height;this.renderTarget1=e,this.renderTarget2=e.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new o(THREE.CopyShader),this.clock=new THREE.Clock};Object.assign(h.prototype,{swapBuffers:function(){var t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t},addPass:function(t){this.passes.push(t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)},insertPass:function(t,e){this.passes.splice(e,0,t)},isLastEnabledPass:function(t){for(var e=t+1;e<this.passes.length;e++)if(this.passes[e].enabled)return!1;return!0},render:function(t){void 0===t&&(t=this.clock.getDelta());var e,i,n=this.renderer.getRenderTarget(),a=!1,r=this.passes.length;for(i=0;i<r;i++)if(!1!==(e=this.passes[i]).enabled){if(e.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(i),e.render(this.renderer,this.writeBuffer,this.readBuffer,t,a),e.needsSwap){if(a){var s=this.renderer.getContext(),o=this.renderer.state.buffers.stencil;o.setFunc(s.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,t),o.setFunc(s.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==THREE.MaskPass&&(e instanceof THREE.MaskPass?a=!0:e instanceof THREE.ClearMaskPass&&(a=!1))}this.renderer.setRenderTarget(n)},reset:function(t){if(void 0===t){var e=this.renderer.getSize(new THREE.Vector2);this._pixelRatio=this.renderer.getPixelRatio(),this._width=e.width,this._height=e.height,(t=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=t,this.renderTarget2=t.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(t,e){this._width=t,this._height=e;var i=this._width*this._pixelRatio,n=this._height*this._pixelRatio;this.renderTarget1.setSize(i,n),this.renderTarget2.setSize(i,n);for(var a=0;a<this.passes.length;a++)this.passes[a].setSize(i,n)},setPixelRatio:function(t){this._pixelRatio=t,this.setSize(this._width,this._height)}});var A=function(t,e,i,a,r){n.call(this),this.scene=t,this.camera=e,this.overrideMaterial=i,this.clearColor=a,this.clearAlpha=void 0!==r?r:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1};A.prototype=Object.assign(Object.create(n.prototype),{constructor:A,render:function(t,e,i){var n,a,r=t.autoClear;t.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(n=t.getClearColor().getHex(),a=t.getClearAlpha(),t.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&t.clearDepth(),t.setRenderTarget(this.renderToScreen?null:i),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),t.render(this.scene,this.camera),this.clearColor&&t.setClearColor(n,a),this.scene.overrideMaterial=null,t.autoClear=r}});var l={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = opacity * texel;","}"].join("\n")},u=function(t,e,i,a){this.renderScene=e,this.renderCamera=i,this.selectedObjects=void 0!==a?a:[],this.visibleEdgeColor=new THREE.Color(1,1,1),this.hiddenEdgeColor=new THREE.Color(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,n.call(this),this.resolution=void 0!==t?new THREE.Vector2(t.x,t.y):new THREE.Vector2(256,256);var r={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat},s=Math.round(this.resolution.x/this.downSampleRatio),o=Math.round(this.resolution.y/this.downSampleRatio);this.maskBufferMaterial=new THREE.MeshBasicMaterial({color:16777215}),this.maskBufferMaterial.side=THREE.DoubleSide,this.renderTargetMaskBuffer=new THREE.WebGLRenderTarget(this.resolution.x,this.resolution.y,r),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new THREE.MeshDepthMaterial,this.depthMaterial.side=THREE.DoubleSide,this.depthMaterial.depthPacking=THREE.RGBADepthPacking,this.depthMaterial.blending=THREE.NoBlending,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=THREE.DoubleSide,this.prepareMaskMaterial.fragmentShader=function(t,e){var i=e.isPerspectiveCamera?"perspective":"orthographic";return t.replace(/DEPTH_TO_VIEW_Z/g,i+"DepthToViewZ")}(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new THREE.WebGLRenderTarget(this.resolution.x,this.resolution.y,r),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new THREE.WebGLRenderTarget(s,o,r),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new THREE.WebGLRenderTarget(s,o,r),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new THREE.WebGLRenderTarget(Math.round(s/2),Math.round(o/2),r),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new THREE.WebGLRenderTarget(s,o,r),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new THREE.WebGLRenderTarget(Math.round(s/2),Math.round(o/2),r),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1;this.separableBlurMaterial1=this.getSeperableBlurMaterial(4),this.separableBlurMaterial1.uniforms.texSize.value=new THREE.Vector2(s,o),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(4),this.separableBlurMaterial2.uniforms.texSize.value=new THREE.Vector2(Math.round(s/2),Math.round(o/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=4,this.overlayMaterial=this.getOverlayMaterial(),void 0===l&&console.error("OutlinePass relies on CopyShader");var h=l;this.copyUniforms=THREE.UniformsUtils.clone(h.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new THREE.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:h.vertexShader,fragmentShader:h.fragmentShader,blending:THREE.NoBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new THREE.Color,this.oldClearAlpha=1,this.fsQuad=new n.FullScreenQuad(null),this.tempPulseColor1=new THREE.Color,this.tempPulseColor2=new THREE.Color,this.textureMatrix=new THREE.Matrix4};u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,dispose:function(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose()},setSize:function(t,e){this.renderTargetMaskBuffer.setSize(t,e);var i=Math.round(t/this.downSampleRatio),n=Math.round(e/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(i,n),this.renderTargetBlurBuffer1.setSize(i,n),this.renderTargetEdgeBuffer1.setSize(i,n),this.separableBlurMaterial1.uniforms.texSize.value=new THREE.Vector2(i,n),i=Math.round(i/2),n=Math.round(n/2),this.renderTargetBlurBuffer2.setSize(i,n),this.renderTargetEdgeBuffer2.setSize(i,n),this.separableBlurMaterial2.uniforms.texSize.value=new THREE.Vector2(i,n)},changeVisibilityOfSelectedObjects:function(t){function e(e){e.isMesh&&(t?(e.visible=e.userData.oldVisible,delete e.userData.oldVisible):(e.userData.oldVisible=e.visible,e.visible=t))}for(var i=0;i<this.selectedObjects.length;i++){this.selectedObjects[i].traverse(e)}},changeVisibilityOfNonSelectedObjects:function(t){var e=[];function i(t){t.isMesh&&e.push(t)}for(var n=0;n<this.selectedObjects.length;n++){this.selectedObjects[n].traverse(i)}this.renderScene.traverse(function(i){if(i.isMesh||i.isLine||i.isSprite){for(var n=!1,a=0;a<e.length;a++)if(e[a].id===i.id){n=!0;break}if(!n){var r=i.visible;t&&!i.bVisible||(i.visible=t),i.bVisible=r}}})},updateTextureMatrix:function(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)},render:function(t,e,i,n,a){if(this.selectedObjects.length>0){this.oldClearColor.copy(t.getClearColor()),this.oldClearAlpha=t.getClearAlpha();var r=t.autoClear;t.autoClear=!1,a&&t.state.buffers.stencil.setTest(!1),t.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1);var s=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,t.setRenderTarget(this.renderTargetDepthBuffer),t.clear(),t.render(this.renderScene,this.renderCamera),this.changeVisibilityOfSelectedObjects(!0),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value=new THREE.Vector2(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,t.setRenderTarget(this.renderTargetMaskBuffer),t.clear(),t.render(this.renderScene,this.renderCamera),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this.renderScene.background=s,this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,t.setRenderTarget(this.renderTargetMaskDownSampleBuffer),t.clear(),this.fsQuad.render(t),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){var o=.625+.75*Math.cos(.01*performance.now()/this.pulsePeriod)/2;this.tempPulseColor1.multiplyScalar(o),this.tempPulseColor2.multiplyScalar(o)}this.fsQuad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value=new THREE.Vector2(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,t.setRenderTarget(this.renderTargetEdgeBuffer1),t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=u.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,t.setRenderTarget(this.renderTargetBlurBuffer1),t.clear(),this.fsQuad.render(t),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=u.BlurDirectionY,t.setRenderTarget(this.renderTargetEdgeBuffer1),t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=u.BlurDirectionX,t.setRenderTarget(this.renderTargetBlurBuffer2),t.clear(),this.fsQuad.render(t),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=u.BlurDirectionY,t.setRenderTarget(this.renderTargetEdgeBuffer2),t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,a&&t.state.buffers.stencil.setTest(!0),t.setRenderTarget(i),this.fsQuad.render(t),t.setClearColor(this.oldClearColor,this.oldClearAlpha),t.autoClear=r}this.renderToScreen&&(this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=i.texture,t.setRenderTarget(null),this.fsQuad.render(t))},getPrepareMaskMaterial:function(){return new THREE.ShaderMaterial({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new THREE.Vector2(.5,.5)},textureMatrix:{value:new THREE.Matrix4}},vertexShader:["varying vec4 projTexCoord;","varying vec4 vPosition;","uniform mat4 textureMatrix;","void main() {","\tvPosition = modelViewMatrix * vec4( position, 1.0 );","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tprojTexCoord = textureMatrix * worldPosition;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <packing>","varying vec4 vPosition;","varying vec4 projTexCoord;","uniform sampler2D depthTexture;","uniform vec2 cameraNearFar;","void main() {","\tfloat depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));","\tfloat viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );","\tfloat depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;","\tgl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);","}"].join("\n")})},getEdgeDetectionMaterial:function(){return new THREE.ShaderMaterial({uniforms:{maskTexture:{value:null},texSize:{value:new THREE.Vector2(.5,.5)},visibleEdgeColor:{value:new THREE.Vector3(1,1,1)},hiddenEdgeColor:{value:new THREE.Vector3(1,1,1)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec3 visibleEdgeColor;\t\t\t\tuniform vec3 hiddenEdgeColor;\t\t\t\t\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tvec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\t\t\t\t\tvec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\t\t\t\t\tvec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\t\t\t\t\tvec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\t\t\t\t\tvec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\t\t\t\t\tfloat diff1 = (c1.r - c2.r)*0.5;\t\t\t\t\tfloat diff2 = (c3.r - c4.r)*0.5;\t\t\t\t\tfloat d = length( vec2(diff1, diff2) );\t\t\t\t\tfloat a1 = min(c1.g, c2.g);\t\t\t\t\tfloat a2 = min(c3.g, c4.g);\t\t\t\t\tfloat visibilityFactor = min(a1, a2);\t\t\t\t\tvec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\t\t\t\t\tgl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\t\t\t\t}"})},getSeperableBlurMaterial:function(t){return new THREE.ShaderMaterial({defines:{MAX_RADIUS:t},uniforms:{colorTexture:{value:null},texSize:{value:new THREE.Vector2(.5,.5)},direction:{value:new THREE.Vector2(.5,.5)},kernelRadius:{value:1}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\t\t\t\tuniform sampler2D colorTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\tuniform float kernelRadius;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, kernelRadius);\t\t\t\t\tvec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;\t\t\t\t\tvec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\t\t\t\t\tvec2 uvOffset = delta;\t\t\t\t\tfor( int i = 1; i <= MAX_RADIUS; i ++ ) {\t\t\t\t\t\tfloat w = gaussianPdf(uvOffset.x, kernelRadius);\t\t\t\t\t\tvec4 sample1 = texture2D( colorTexture, vUv + uvOffset);\t\t\t\t\t\tvec4 sample2 = texture2D( colorTexture, vUv - uvOffset);\t\t\t\t\t\tdiffuseSum += ((sample1 + sample2) * w);\t\t\t\t\t\tweightSum += (2.0 * w);\t\t\t\t\t\tuvOffset += delta;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = diffuseSum/weightSum;\t\t\t\t}"})},getOverlayMaterial:function(){return new THREE.ShaderMaterial({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform sampler2D edgeTexture1;\t\t\t\tuniform sampler2D edgeTexture2;\t\t\t\tuniform sampler2D patternTexture;\t\t\t\tuniform float edgeStrength;\t\t\t\tuniform float edgeGlow;\t\t\t\tuniform bool usePatternTexture;\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tvec4 edgeValue1 = texture2D(edgeTexture1, vUv);\t\t\t\t\tvec4 edgeValue2 = texture2D(edgeTexture2, vUv);\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\t\t\t\t\tvec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\t\t\t\t\tfloat visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\t\t\t\t\tvec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\t\t\t\t\tvec4 finalColor = edgeStrength * maskColor.r * edgeValue;\t\t\t\t\tif(usePatternTexture)\t\t\t\t\t\tfinalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\t\t\t\t\tgl_FragColor = finalColor;\t\t\t\t}",blending:THREE.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0})}}),u.BlurDirectionX=new THREE.Vector2(1,0),u.BlurDirectionY=new THREE.Vector2(0,1);var d={uniforms:{tDiffuse:{value:null},resolution:{value:new THREE.Vector2(1/1024,1/512)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","","uniform sampler2D tDiffuse;","","uniform vec2 resolution;","","varying vec2 vUv;","","// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)","","//----------------------------------------------------------------------------------","// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag","// SDK Version: v3.00","// Email:       gameworks@nvidia.com","// Site:        http://developer.nvidia.com/","//","// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.","//","// Redistribution and use in source and binary forms, with or without","// modification, are permitted provided that the following conditions","// are met:","//  * Redistributions of source code must retain the above copyright","//    notice, this list of conditions and the following disclaimer.","//  * Redistributions in binary form must reproduce the above copyright","//    notice, this list of conditions and the following disclaimer in the","//    documentation and/or other materials provided with the distribution.","//  * Neither the name of NVIDIA CORPORATION nor the names of its","//    contributors may be used to endorse or promote products derived","//    from this software without specific prior written permission.","//","// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY","// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE","// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR","// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR","// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,","// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,","// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR","// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY","// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT","// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE","// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.","//","//----------------------------------------------------------------------------------","","#define FXAA_PC 1","#define FXAA_GLSL_100 1","#define FXAA_QUALITY_PRESET 12","","#define FXAA_GREEN_AS_LUMA 1","","/*--------------------------------------------------------------------------*/","#ifndef FXAA_PC_CONSOLE","    //","    // The console algorithm for PC is included","    // for developers targeting really low spec machines.","    // Likely better to just run FXAA_PC, and use a really low preset.","    //","    #define FXAA_PC_CONSOLE 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_120","    #define FXAA_GLSL_120 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_130","    #define FXAA_GLSL_130 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_3","    #define FXAA_HLSL_3 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_4","    #define FXAA_HLSL_4 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_5","    #define FXAA_HLSL_5 0","#endif","/*==========================================================================*/","#ifndef FXAA_GREEN_AS_LUMA","    //","    // For those using non-linear color,","    // and either not able to get luma in alpha, or not wanting to,","    // this enables FXAA to run using green as a proxy for luma.","    // So with this enabled, no need to pack luma in alpha.","    //","    // This will turn off AA on anything which lacks some amount of green.","    // Pure red and blue or combination of only R and B, will get no AA.","    //","    // Might want to lower the settings for both,","    //    fxaaConsoleEdgeThresholdMin","    //    fxaaQualityEdgeThresholdMin","    // In order to insure AA does not get turned off on colors","    // which contain a minor amount of green.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_GREEN_AS_LUMA 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_EARLY_EXIT","    //","    // Controls algorithm's early exit path.","    // On PS3 turning this ON adds 2 cycles to the shader.","    // On 360 turning this OFF adds 10ths of a millisecond to the shader.","    // Turning this off on console will result in a more blurry image.","    // So this defaults to on.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_EARLY_EXIT 1","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_DISCARD","    //","    // Only valid for PC OpenGL currently.","    // Probably will not work when FXAA_GREEN_AS_LUMA = 1.","    //","    // 1 = Use discard on pixels which don't need AA.","    //     For APIs which enable concurrent TEX+ROP from same surface.","    // 0 = Return unchanged color on pixels which don't need AA.","    //","    #define FXAA_DISCARD 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_FAST_PIXEL_OFFSET","    //","    // Used for GLSL 120 only.","    //","    // 1 = GL API supports fast pixel offsets","    // 0 = do not use fast pixel offsets","    //","    #ifdef GL_EXT_gpu_shader4","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifndef FXAA_FAST_PIXEL_OFFSET","        #define FXAA_FAST_PIXEL_OFFSET 0","    #endif","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GATHER4_ALPHA","    //","    // 1 = API supports gather4 on alpha channel.","    // 0 = API does not support gather4 on alpha channel.","    //","    #if (FXAA_HLSL_5 == 1)","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifndef FXAA_GATHER4_ALPHA","        #define FXAA_GATHER4_ALPHA 0","    #endif","#endif","","","/*============================================================================","                        FXAA QUALITY - TUNING KNOBS","------------------------------------------------------------------------------","NOTE the other tuning knobs are now in the shader function inputs!","============================================================================*/","#ifndef FXAA_QUALITY_PRESET","    //","    // Choose the quality preset.","    // This needs to be compiled into the shader as it effects code.","    // Best option to include multiple presets is to","    // in each shader define the preset, then include this file.","    //","    // OPTIONS","    // -----------------------------------------------------------------------","    // 10 to 15 - default medium dither (10=fastest, 15=highest quality)","    // 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)","    // 39       - no dither, very expensive","    //","    // NOTES","    // -----------------------------------------------------------------------","    // 12 = slightly faster then FXAA 3.9 and higher edge quality (default)","    // 13 = about same speed as FXAA 3.9 and better than 12","    // 23 = closest to FXAA 3.9 visually and performance wise","    //  _ = the lowest digit is directly related to performance","    // _  = the highest digit is directly related to style","    //","    #define FXAA_QUALITY_PRESET 12","#endif","","","/*============================================================================","","                           FXAA QUALITY - PRESETS","","============================================================================*/","","/*============================================================================","                     FXAA QUALITY - MEDIUM DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 10)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 3.0","    #define FXAA_QUALITY_P2 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 11)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 3.0","    #define FXAA_QUALITY_P3 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 12)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 4.0","    #define FXAA_QUALITY_P4 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 13)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 4.0","    #define FXAA_QUALITY_P5 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 14)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 4.0","    #define FXAA_QUALITY_P6 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 15)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 12.0","#endif","","/*============================================================================","                     FXAA QUALITY - LOW DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 20)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 2.0","    #define FXAA_QUALITY_P2 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 21)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 22)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 23)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 24)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 3.0","    #define FXAA_QUALITY_P6 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 25)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 26)","    #define FXAA_QUALITY_PS 9","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 4.0","    #define FXAA_QUALITY_P8 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 27)","    #define FXAA_QUALITY_PS 10","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 4.0","    #define FXAA_QUALITY_P9 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 28)","    #define FXAA_QUALITY_PS 11","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 4.0","    #define FXAA_QUALITY_P10 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 29)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","/*============================================================================","                     FXAA QUALITY - EXTREME QUALITY","============================================================================*/","#if (FXAA_QUALITY_PRESET == 39)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.0","    #define FXAA_QUALITY_P2 1.0","    #define FXAA_QUALITY_P3 1.0","    #define FXAA_QUALITY_P4 1.0","    #define FXAA_QUALITY_P5 1.5","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","","","/*============================================================================","","                                API PORTING","","============================================================================*/","#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)","    #define FxaaBool bool","    #define FxaaDiscard discard","    #define FxaaFloat float","    #define FxaaFloat2 vec2","    #define FxaaFloat3 vec3","    #define FxaaFloat4 vec4","    #define FxaaHalf float","    #define FxaaHalf2 vec2","    #define FxaaHalf3 vec3","    #define FxaaHalf4 vec4","    #define FxaaInt2 ivec2","    #define FxaaSat(x) clamp(x, 0.0, 1.0)","    #define FxaaTex sampler2D","#else","    #define FxaaBool bool","    #define FxaaDiscard clip(-1)","    #define FxaaFloat float","    #define FxaaFloat2 float2","    #define FxaaFloat3 float3","    #define FxaaFloat4 float4","    #define FxaaHalf half","    #define FxaaHalf2 half2","    #define FxaaHalf3 half3","    #define FxaaHalf4 half4","    #define FxaaSat(x) saturate(x)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_100 == 1)","  #define FxaaTexTop(t, p) texture2D(t, p, 0.0)","  #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_120 == 1)","    // Requires,","    //  #version 120","    // And at least,","    //  #extension GL_EXT_gpu_shader4 : enable","    //  (or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)","    #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)","    #if (FXAA_FAST_PIXEL_OFFSET == 1)","        #define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)","    #else","        #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)","    #endif","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_130 == 1)",'    // Requires "#version 130" or better',"    #define FxaaTexTop(t, p) textureLod(t, p, 0.0)","    #define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_3 == 1)","    #define FxaaInt2 float2","    #define FxaaTex sampler2D","    #define FxaaTexTop(t, p) tex2Dlod(t, float4(p, 0.0, 0.0))","    #define FxaaTexOff(t, p, o, r) tex2Dlod(t, float4(p + (o * r), 0, 0))","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_4 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_5 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","    #define FxaaTexAlpha4(t, p) t.tex.GatherAlpha(t.smpl, p)","    #define FxaaTexOffAlpha4(t, p, o) t.tex.GatherAlpha(t.smpl, p, o)","    #define FxaaTexGreen4(t, p) t.tex.GatherGreen(t.smpl, p)","    #define FxaaTexOffGreen4(t, p, o) t.tex.GatherGreen(t.smpl, p, o)","#endif","","","/*============================================================================","                   GREEN AS LUMA OPTION SUPPORT FUNCTION","============================================================================*/","#if (FXAA_GREEN_AS_LUMA == 0)","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }","#else","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }","#endif","","","","","/*============================================================================","","                             FXAA3 QUALITY - PC","","============================================================================*/","#if (FXAA_PC == 1)","/*--------------------------------------------------------------------------*/","FxaaFloat4 FxaaPixelShader(","    //","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy} = center of pixel","    FxaaFloat2 pos,","    //","    // Used only for FXAA Console, and not used on the 360 version.","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy_} = upper left of pixel","    // {_zw} = lower right of pixel","    FxaaFloat4 fxaaConsolePosPos,","    //","    // Input color texture.","    // {rgb_} = color in linear or perceptual color space","    // if (FXAA_GREEN_AS_LUMA == 0)","    //     {__a} = luma in perceptual color space (not linear)","    FxaaTex tex,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 2nd sampler.","    // This sampler needs to have an exponent bias of -1.","    FxaaTex fxaaConsole360TexExpBiasNegOne,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 3nd sampler.","    // This sampler needs to have an exponent bias of -2.","    FxaaTex fxaaConsole360TexExpBiasNegTwo,","    //","    // Only used on FXAA Quality.","    // This must be from a constant/uniform.","    // {x_} = 1.0/screenWidthInPixels","    // {_y} = 1.0/screenHeightInPixels","    FxaaFloat2 fxaaQualityRcpFrame,","    //","    // Only used on FXAA Console.","    // This must be from a constant/uniform.","    // This effects sub-pixel AA quality and inversely sharpness.","    //   Where N ranges between,","    //     N = 0.50 (default)","    //     N = 0.33 (sharper)","    // {x__} = -N/screenWidthInPixels","    // {_y_} = -N/screenHeightInPixels","    // {_z_} =  N/screenWidthInPixels","    // {__w} =  N/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt,","    //","    // Only used on FXAA Console.","    // Not used on 360, but used on PS3 and PC.","    // This must be from a constant/uniform.","    // {x__} = -2.0/screenWidthInPixels","    // {_y_} = -2.0/screenHeightInPixels","    // {_z_} =  2.0/screenWidthInPixels","    // {__w} =  2.0/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt2,","    //","    // Only used on FXAA Console.","    // Only used on 360 in place of fxaaConsoleRcpFrameOpt2.","    // This must be from a constant/uniform.","    // {x__} =  8.0/screenWidthInPixels","    // {_y_} =  8.0/screenHeightInPixels","    // {_z_} = -4.0/screenWidthInPixels","    // {__w} = -4.0/screenHeightInPixels","    FxaaFloat4 fxaaConsole360RcpFrameOpt2,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_SUBPIX define.","    // It is here now to allow easier tuning.","    // Choose the amount of sub-pixel aliasing removal.","    // This can effect sharpness.","    //   1.00 - upper limit (softer)","    //   0.75 - default amount of filtering","    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)","    //   0.25 - almost off","    //   0.00 - completely off","    FxaaFloat fxaaQualitySubpix,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // The minimum amount of local contrast required to apply algorithm.","    //   0.333 - too little (faster)","    //   0.250 - low quality","    //   0.166 - default","    //   0.125 - high quality","    //   0.063 - overkill (slower)","    FxaaFloat fxaaQualityEdgeThreshold,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    //   0.0833 - upper limit (default, the start of visible unfiltered edges)","    //   0.0625 - high quality (faster)","    //   0.0312 - visible limit (slower)","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaQualityEdgeThresholdMin,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_SHARPNESS define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_SHARPNESS for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only three safe values here: 2 and 4 and 8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // For all other platforms can be a non-power of two.","    //   8.0 is sharper (default!!!)","    //   4.0 is softer","    //   2.0 is really soft (good only for vector graphics inputs)","    FxaaFloat fxaaConsoleEdgeSharpness,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_THRESHOLD for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only two safe values here: 1/4 and 1/8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // The console setting has a different mapping than the quality setting.","    // Other platforms can use other values.","    //   0.125 leaves less aliasing, but is softer (default!!!)","    //   0.25 leaves more aliasing, and is sharper","    FxaaFloat fxaaConsoleEdgeThreshold,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    // The console setting has a different mapping than the quality setting.","    // This only applies when FXAA_EARLY_EXIT is 1.","    // This does not apply to PS3,","    // PS3 was simplified to avoid more shader instructions.","    //   0.06 - faster but more aliasing in darks","    //   0.05 - default","    //   0.04 - slower and less aliasing in darks","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaConsoleEdgeThresholdMin,","    //","    // Extra constants for 360 FXAA Console only.","    // Use zeros or anything else for other platforms.","    // These must be in physical constant registers and NOT immediates.","    // Immediates will result in compiler un-optimizing.","    // {xyzw} = float4(1.0, -1.0, 0.25, -0.25)","    FxaaFloat4 fxaaConsole360ConstDir",") {","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posM;","    posM.x = pos.x;","    posM.y = pos.y;","    #if (FXAA_GATHER4_ALPHA == 1)","        #if (FXAA_DISCARD == 0)","            FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","            #if (FXAA_GREEN_AS_LUMA == 0)","                #define lumaM rgbyM.w","            #else","                #define lumaM rgbyM.y","            #endif","        #endif","        #if (FXAA_GREEN_AS_LUMA == 0)","            FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));","        #else","            FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));","        #endif","        #if (FXAA_DISCARD == 1)","            #define lumaM luma4A.w","        #endif","        #define lumaE luma4A.z","        #define lumaS luma4A.x","        #define lumaSE luma4A.y","        #define lumaNW luma4B.w","        #define lumaN luma4B.z","        #define lumaW luma4B.x","    #else","        FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","        #if (FXAA_GREEN_AS_LUMA == 0)","            #define lumaM rgbyM.w","        #else","            #define lumaM rgbyM.y","        #endif","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));","        #endif","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat maxSM = max(lumaS, lumaM);","    FxaaFloat minSM = min(lumaS, lumaM);","    FxaaFloat maxESM = max(lumaE, maxSM);","    FxaaFloat minESM = min(lumaE, minSM);","    FxaaFloat maxWN = max(lumaN, lumaW);","    FxaaFloat minWN = min(lumaN, lumaW);","    FxaaFloat rangeMax = max(maxWN, maxESM);","    FxaaFloat rangeMin = min(minWN, minESM);","    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;","    FxaaFloat range = rangeMax - rangeMin;","    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);","    FxaaBool earlyExit = range < rangeMaxClamped;","/*--------------------------------------------------------------------------*/","    if(earlyExit)","        #if (FXAA_DISCARD == 1)","            FxaaDiscard;","        #else","            return rgbyM;","        #endif","/*--------------------------------------------------------------------------*/","    #if (FXAA_GATHER4_ALPHA == 0)","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","        #endif","    #else","        FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));","        FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNS = lumaN + lumaS;","    FxaaFloat lumaWE = lumaW + lumaE;","    FxaaFloat subpixRcpRange = 1.0/range;","    FxaaFloat subpixNSWE = lumaNS + lumaWE;","    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;","    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNESE = lumaNE + lumaSE;","    FxaaFloat lumaNWNE = lumaNW + lumaNE;","    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;","    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNWSW = lumaNW + lumaSW;","    FxaaFloat lumaSWSE = lumaSW + lumaSE;","    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);","    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);","    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;","    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;","    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;","    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;","/*--------------------------------------------------------------------------*/","    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;","    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;","    FxaaBool horzSpan = edgeHorz >= edgeVert;","    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;","/*--------------------------------------------------------------------------*/","    if(!horzSpan) lumaN = lumaW;","    if(!horzSpan) lumaS = lumaE;","    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;","    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;","/*--------------------------------------------------------------------------*/","    FxaaFloat gradientN = lumaN - lumaM;","    FxaaFloat gradientS = lumaS - lumaM;","    FxaaFloat lumaNN = lumaN + lumaM;","    FxaaFloat lumaSS = lumaS + lumaM;","    FxaaBool pairN = abs(gradientN) >= abs(gradientS);","    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));","    if(pairN) lengthSign = -lengthSign;","    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posB;","    posB.x = posM.x;","    posB.y = posM.y;","    FxaaFloat2 offNP;","    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;","    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;","    if(!horzSpan) posB.x += lengthSign * 0.5;","    if( horzSpan) posB.y += lengthSign * 0.5;","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posN;","    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;","    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;","    FxaaFloat2 posP;","    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;","    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;","    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;","    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));","    FxaaFloat subpixE = subpixC * subpixC;","    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));","/*--------------------------------------------------------------------------*/","    if(!pairN) lumaNN = lumaSS;","    FxaaFloat gradientScaled = gradient * 1.0/4.0;","    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;","    FxaaFloat subpixF = subpixD * subpixE;","    FxaaBool lumaMLTZero = lumaMM < 0.0;","/*--------------------------------------------------------------------------*/","    lumaEndN -= lumaNN * 0.5;","    lumaEndP -= lumaNN * 0.5;","    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;","    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;","    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;","    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;","    FxaaBool doneNP = (!doneN) || (!doneP);","    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;","    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;","/*--------------------------------------------------------------------------*/","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 3)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 4)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 5)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 6)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;","/*--------------------------------------------------------------------------*/","                        #if (FXAA_QUALITY_PS > 7)","                        if(doneNP) {","                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                            doneN = abs(lumaEndN) >= gradientScaled;","                            doneP = abs(lumaEndP) >= gradientScaled;","                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;","                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;","                            doneNP = (!doneN) || (!doneP);","                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;","                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;","/*--------------------------------------------------------------------------*/","    #if (FXAA_QUALITY_PS > 8)","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 9)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 10)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 11)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 12)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","    #endif","/*--------------------------------------------------------------------------*/","                        }","                        #endif","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","/*--------------------------------------------------------------------------*/","    FxaaFloat dstN = posM.x - posN.x;","    FxaaFloat dstP = posP.x - posM.x;","    if(!horzSpan) dstN = posM.y - posN.y;","    if(!horzSpan) dstP = posP.y - posM.y;","/*--------------------------------------------------------------------------*/","    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;","    FxaaFloat spanLength = (dstP + dstN);","    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;","    FxaaFloat spanLengthRcp = 1.0/spanLength;","/*--------------------------------------------------------------------------*/","    FxaaBool directionN = dstN < dstP;","    FxaaFloat dst = min(dstN, dstP);","    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;","    FxaaFloat subpixG = subpixF * subpixF;","    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;","    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;","/*--------------------------------------------------------------------------*/","    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;","    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);","    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;","    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;","    #if (FXAA_DISCARD == 1)","        return FxaaTexTop(tex, posM);","    #else","        return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);","    #endif","}","/*==========================================================================*/","#endif","","void main() {","  gl_FragColor = FxaaPixelShader(","    vUv,","    vec4(0.0),","    tDiffuse,","    tDiffuse,","    tDiffuse,","    resolution,","    vec4(0.0),","    vec4(0.0),","    vec4(0.0),","    0.75,","    0.166,","    0.0833,","    0.0,","    0.0,","    0.0,","    vec4(0.0)","  );","","  // TODO avoid querying texture twice for same texel","  gl_FragColor.a = texture2D(tDiffuse, vUv).a;","}"].join("\n")};function c(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}i.d(e,"a",function(){return f});var f=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._width=100,this._height=100,this.visi3D=e,this._active=!1,this._edgeStrength=3,this._edgeGlow=0,this._edgeThickness=1,this._pulsePeriod=0,this._visibleEdgeColor="#ffffff",this._hiddenEdgeColor="#190a05",this._boolTextur=!1,this._linkTextur="null";var n=new h(e.renderer),a=new A(e.scene,e.camera);n.addPass(a);var r=new u(new THREE.Vector2(window.innerWidth,window.innerHeight),e.scene,e.camera);n.addPass(r),this.outlinePass=r;var s=new o(d);s.uniforms.resolution.value.set(1/window.innerWidth,1/window.innerHeight),n.addPass(s),this.outlinePass.edgeStrength=this._edgeStrength,this.outlinePass.edgeGlow=this._edgeGlow,this.outlinePass.edgeThickness=this._edgeThickness,this.outlinePass.pulsePeriod=this._pulsePeriod,this.outlinePass.visibleEdgeColor.set(this._visibleEdgeColor),this.outlinePass.hiddenEdgeColor.set(this._hiddenEdgeColor),this._visibleEdgeColor="#ffffff",this._hiddenEdgeColor="#190a05",this.dragLink=function(){(new THREE.TextureLoader).load(this._linkTextur,function(t){r.patternTexture=t,t.wrapS=THREE.RepeatWrapping,t.wrapT=THREE.RepeatWrapping,e.intRend=1})},this.sizeWindow=function(t,e){this._width=t,this._height=e,s.uniforms.resolution.value.set(1/t,1/e),n.setSize(t,e)},this.render=function(){return 0==this._active?this._active:(n.render(),!0)},this.setValue=function(t){1!=Array.isArray(t)?r.selectedObjects=null!=t||null!=t?[t]:[]:r.selectedObjects=t}}var e,i,n;return e=t,(i=[{key:"active",set:function(t){this._active!=t&&(this._active=t,this.visi3D.intRend=1)},get:function(){return this._active}},{key:"edgeStrength",set:function(t){this._edgeStrength!=t&&(this._edgeStrength=t,this.outlinePass.edgeStrength=this._edgeStrength)},get:function(){return this._edgeStrength}},{key:"edgeGlow",set:function(t){this._edgeGlow!=t&&(this._edgeGlow=t,this.outlinePass.edgeGlow=this._edgeGlow)},get:function(){return this._edgeGlow}},{key:"pulsePeriod",set:function(t){this._pulsePeriod!=t&&(this._pulsePeriod=t,this.outlinePass.pulsePeriod=this._pulsePeriod)},get:function(){return this._pulsePeriod}},{key:"linkTextur",set:function(t){this._linkTextur!=t&&(this._linkTextur=t,"null"==this._linkTextur?this.outlinePass.usePatternTexture=!1:(this.outlinePass.usePatternTexture=!0,this.dragLink()))},get:function(){return this._linkTextur}},{key:"visibleEdgeColor",set:function(t){this._visibleEdgeColor!=t&&(this._visibleEdgeColor=t,this.outlinePass.visibleEdgeColor.set(this._visibleEdgeColor))},get:function(){return this._visibleEdgeColor}},{key:"hiddenEdgeColor",set:function(t){this._hiddenEdgeColor!=t&&(this._hiddenEdgeColor=t,this.outlinePass.hiddenEdgeColor.set(this._hiddenEdgeColor))},get:function(){return this._hiddenEdgeColor}}])&&c(e.prototype,i),n&&c(e,n),t}()},function(t,e,i){"use strict";var n=i(3);function a(t){this.parent=t;var e,i=this;this._active=!1,this.RADIUS=1e3,this.POS_X=0,this.POS_Y=0,this.POS_Z=0,this.LINK="nullMy",this.COLOR="0xffffff",this._radius=this.RADIUS,this._link=this.LINK,this._color=this.COLOR,this._shadRotZ=this.parent.ROTATION_Z,this._rotZ=0,this._x=this.POS_X,this._y=this.POS_Y,this._z=this.POS_Z,this.mesh=void 0,this.cont3d=void 0,this.cont3d1=void 0,this.textur=void 0,this.loaderHDR=void 0,this.onLoad=void 0,this.onComplete=void 0,this.init=function(){null==this.mesh&&(this.geometry=new THREE.SphereGeometry(1,32,32),this.loader=new THREE.TextureLoader,this.loaderHDR=new n.a,this.material=new THREE.MeshBasicMaterial({side:THREE.BackSide,color:16777215}),this.mesh=new THREE.Mesh(this.geometry,this.material),this.mesh.scale.set(this._radius,this._radius,this._radius),this.cont3d=new THREE.Object3D,this.cont3d1=new THREE.Object3D,this.cont3d.add(this.cont3d1),this.cont3d1.add(this.mesh),this.cont3d1.rotation.y=0,this.mesh.rotation.y=this._rotZ,this.cont3d.rotation.x=-Math.PI/2)},this.dergActiv=function(){1==this._active?null==this.cont3d.parent&&this.parent.parent.groupObject.add(this.cont3d):null!=this.cont3d.parent&&this.parent.parent.groupObject.remove(this.cont3d)},this.canvasTexture,this.linkNull=null,this.creatLink=function(){if(null!=this.linkNull)return this.linkNull;var t=document.createElement("canvas"),e=t.getContext("2d");t.height=t.width=2048;var i=t.height/26;e.fillStyle="rgba(100, 100, 100, 0.5)";for(var n=!0,a=!0,r=0;r<26;r++){a=n;for(var s=0;s<26;s++)a&&e.fillRect(r*i,s*i,i,i),a=!a;n=!n}this.linkNull=t.toDataURL("image/png"),this.canvasTexture=new THREE.CanvasTexture(t)},this.dergLink=function(){if("null"==this._link||null==this._link){null!=this.material.map&&(this.material.map=null,this.material.needsUpdate=!0);var t=this._link+"";this.creatLink(),i.textur=this.canvasTexture,i.textur.linkMy=t,i.material.map=i.textur,i.material.needsUpdate=!0,i.parent.parent.intRend=1,i.onComplete&&i.onComplete()}else{if(this.onLoad&&this.onLoad(),0==(e=this.checkFormat(this._link))){var n=this._link+"";if(i.textur&&i.textur.linkMy&&i.textur.linkMy==n)return void(i.onComplete&&i.onComplete());this.loader.load(this._link,function(t){i.textur=t,i.textur.linkMy=n,i.material.map=t,i.material.needsUpdate=!0,i.parent.parent.intRend=1,i.onComplete&&i.onComplete()},function(t){},function(t){})}if(1==e)return}},this.checkFormat=function(t){return-1!==t.indexOf(".png")?0:-1!==t.indexOf(".jpeg")?0:-1!==t.indexOf(".jpg")?0:t.length>150?-1!==t.indexOf("png")?0:-1!==t.indexOf("jpeg")?0:-1!==t.indexOf("jpg")?0:1:1},this.render=function(){}}function r(){var t=this,e=256,i=256,n=new THREE.Scene,a=new THREE.OrthographicCamera(e/-2,e/2,i/2,i/-2,.001,1e4),r=(new THREE.Clock,new THREE.WebGLRenderer({antialias:!0,alpha:!0,preserveDrawingBuffer:!0}));a.position.set(200,200,200),n.add(a),this.camera=a,this.fotoContainer=new THREE.Object3D,n.add(this.fotoContainer),n.background=new THREE.Color(38655),r.setPixelRatio(window.devicePixelRatio),r.setSize(e,i),r.localClippingEnabled=!0;var s=document.createElement("div");s.style.position="absolute",s.style.bottom="0px",s.style.left="0px",s.appendChild(r.domElement),this.contentHTML=s,this.canvas=r.domElement,this.contentHTML=s;var o=new THREE.AmbientLight("#ffffff",1);n.add(o);var h=new THREE.GridHelper(1e3,10),A=new THREE.AxesHelper(100),l=new THREE.BoxHelper(this.fotoContainer,16776960);n.add(h),n.add(A),n.add(l);var u=[A,h,l];function d(){r.render(n,a)}this.render=d,d(),l.setFromObject(t.fotoContainer);var c=new THREE.Box3,f=new THREE.Vector3;this.box=c,this.center=f,this.setSize=function(t,n){e=t,i=n,r.setSize(e,i),a.aspect=e/i,a.updateProjectionMatrix()},this.addObjFoto=function(t){this.fotoContainer.add(t),l.setFromObject(this.fotoContainer)},this.removeObjFoto=function(t){this.fotoContainer.remove(t)},this.moveToObj=function(e){c.setFromObject(e||t.fotoContainer);var i=c.max.x-c.min.x,n=c.max.z-c.min.z;t.moveToRect(c.min.x,c.min.z,i,n)},this.moveToRect=function(t,e,i,n){if(t+=i/2,e+=n/2,f.set(t,0,e),a.position.set(f.x,9e3,f.z),a.lookAt(f),"OrthographicCamera"===a.type){var r=Math.max(n,i);a.zoom=1,a.left=r/-2,a.right=r/2,a.top=r/2,a.bottom=r/-2,a.aspect=r/r}a.updateProjectionMatrix()},this.getFoto=function(t){t=t||1024;for(var a=0;a<u.length;a++)u[a].visible=!1;var s=n.background;n.background=null,r.setSize(t,t),d();var o=r.domElement.toDataURL("image/png");r.setSize(e,i),n.background=s;for(var h=0;h<u.length;h++)u[h].visible=!0;return d(),o},this.getCanvas=function(t){t=t||1024;for(var e=0;e<u.length;e++)u[e].visible=!1;n.background;n.background=null;var i=r.getSize();return i.width==t&&i.height==t||r.setSize(t,t),d(),r.domElement}}function s(t){var e=this,i=THREE.Math.generateUUID(),n=new THREE.Vector3(0,1,0),a=(new THREE.Plane(n,.01),new THREE.Vector4(0,999,0,.001)),s=new THREE.Box3,l=t||new r;this.foto3D=l;var u=new THREE.Vector2(0,0),d=100,c=new h;this.canvas=c.canvas,this.isTime=!1;var f=new THREE.Texture(c.canvas);this.texturePlan=f,this.matPlan=new THREE.MeshPhongMaterial({transparent:!0,side:THREE.DoubleSide,map:f});var p=new A;this.canvasGG=p,p.arrColorStopTranspanent[0]=.15,p.arrProcent[0]=.82,p.arrColorStopTranspanent[1]=1,p.arrProcent[1]=1,p.update();var g=new THREE.Texture(p.canvas);g.needsUpdate=!0,this.textureShadow=g,this.content3d=new THREE.Object3D,this.shadowContent3d=new THREE.Object3D,this.meshPlan=new THREE.Mesh(new THREE.PlaneBufferGeometry(1,1),this.matPlan),this.meshPlan.rotation.x=-Math.PI/2,this.content3d.add(this.meshPlan);var m=new THREE.Mesh(new THREE.SphereBufferGeometry(10,16,16));m.position.set(a.x,a.y,a.z),this.arrShadowMesh=[],this.arrObj=[],this._dunamic=!0,this.dirty=!0,this._lightPosition4D=a,this._fotoPosition=new THREE.Vector2(0,0),this._fotoWH=150,this._imgWH=512,this._imgBlur=1,this._imgAlpha=1,this._offsetY=0,this._scaleShadow=1,this._isDinamFotoRect=!1,this._opacityMat=1;var x=[new THREE.Plane(new THREE.Vector3(0,-1,0),100),new THREE.Plane(new THREE.Vector3(0,1,0),0)];this._shadowMaterial=new THREE.MeshBasicMaterial({side:THREE.DoubleSide,transparent:!0,opacity:this._opacityMat,depthWrite:!1,map:g,clippingPlanes:x,clipIntersection:!1}),this.arrDataSempl=[],this.arrDataSempl.push(new o(0,200,3,1));var b=new THREE.Group;this.content3d.add(b);var y=new THREE.Mesh(new THREE.PlaneBufferGeometry(1,1),new THREE.MeshBasicMaterial({side:THREE.DoubleSide,map:g,transparent:!0}));y.scale.set(1,30,1),y.rotation.z=-Math.PI/2,b.add(y),b.visible=!1,this.helpers=b,this.setConstMax=function(t){x[0].constant=t},this.setConstMin=function(t){x[1].constant=-t},this.addObj=function(t){if(-1==e.arrObj.indexOf(t)){t.updateMatrixWorld();var i=t.clone();!function t(e,i){e.userData.targetObject=i;for(var n=0;n<e.children.length;n++){if(!i.children[n])throw new Error("обекты не одинаковы");t(e.children[n],i.children[n])}}(i,t),function(t){var i=[];!function t(e,i){"Mesh"==e.type&&i.push(e);for(var n=0;n<e.children.length;n++)"Mesh"==e.type?i.push(e.children[n]):t(e.children[n],i)}(t,i);for(var n=0;n<i.length;n++)i[n].material=e._shadowMaterial}(i),e.arrShadowMesh.push(i),e.arrObj.push(t),e.shadowContent3d.add(i),this.dirty=!0}},this.removeObj=function(t){var i=e.arrObj.indexOf(t);-1!=i&&(e.arrObj.splice(i,1),e.shadowContent3d.remove(e.arrShadowMesh[i]),e.arrShadowMesh.splice(i,1),this.dirty=!0)},this.clear=function(){for(var t=0;(t=e.arrObj.length)>0;)if(e.removeObj(e.arrObj[t-1]),t===e.arrObj.length)throw new Error("object not remove")},this.intRend=1,this.intRendOk=1,this.upDate=function(){e.opacityMat&&(e.dunamic&&(e.intRend=e.intRendOk),e.intRend==e.intRendOk&&(e.dirty||function(){for(var t=0;t<e.arrShadowMesh.length;t++)if((e._isDinamFotoRect||v(e.arrShadowMesh[t]))&&_(e.arrShadowMesh[t]))return!0;return!1}())&&e.render(),e.intRend++)};function v(t){var i=!1,n=!1,a=s.min.x,r=s.min.z,o=s.max.x-s.min.x,h=s.max.z-s.min.z;if(s.setFromObject(t.userData.targetObject),i=M(a=s.min.x,r=s.min.z,o=s.max.x-s.min.x,h=s.max.z-s.min.z,e.fotoPosition.x,e.fotoPosition.y,e.fotoWH,e.fotoWH),s.setFromObject(t),n=M(a=s.min.x,r=s.min.z,o=s.max.x-s.min.x,h=s.max.z-s.min.z,e.fotoPosition.x,e.fotoPosition.y,e.fotoWH,e.fotoWH),!i&&!n)return!1;i=!1,n=!1;for(var A=0;A<t.children.length;A++)if(s.setFromObject(t.children[A].userData.targetObject),a=s.min.x,r=s.min.z,o=s.max.x-s.min.x,h=s.max.z-s.min.z,i=i||M(a,r,o,h,e.fotoPosition.x,e.fotoPosition.y,e.fotoWH,e.fotoWH),s.setFromObject(t.children[A]),a=s.min.x,r=s.min.z,o=s.max.x-s.min.x,h=s.max.z-s.min.z,n=n||M(a,r,o,h,e.fotoPosition.x,e.fotoPosition.y,e.fotoWH,e.fotoWH),i||n)return!0;return!0}function _(t){if(!function(t,e){if(t.position.equals(e.position)&&t.quaternion.equals(e.quaternion)&&t.scale.equals(e.scale)&&t.visible===e.visible)return!0;return!1}(t,t.userData.targetObject))return!0;for(var e=0;e<t.children.length;e++)if(_(t.children[e]))return!0;return!1}function w(t){!function(t,e){t.position.copy(e.position),t.quaternion.copy(e.quaternion),t.scale.copy(e.scale),t.visible=e.visible}(t,t.userData.targetObject);for(var e=0;e<t.children.length;e++)w(t.children[e])}this.render=function(){e.isTime&&console.time("render "+i),e.dirty=!1,function(){a.w=.001,m.position.set(a.x,a.y,a.z);for(var t=0;t<e.arrShadowMesh.length;t++)w(e.arrShadowMesh[t]);T()}(),l.addObjFoto(e.shadowContent3d),d=e.fotoWH,u.x=e.fotoPosition.x,u.y=e.fotoPosition.y,e.isDinamFotoRect&&(s.setFromObject(e.shadowContent3d),u.x=s.min.x,u.y=s.min.z,d=Math.max(s.max.x-s.min.x,s.max.z-s.min.z),u.x-=100,u.y-=100,d+=200),l.moveToRect(u.x,u.y,d,d),function(){var t=l.getCanvas(e.imgWH);c.setCanvas(t),0==e.arrDataSempl.length&&c.update();for(var i=0;i<e.arrDataSempl.length;i++)e.setConstMin(e.arrDataSempl[i].min*e._scaleShadow+e._offsetY),e.setConstMax(e.arrDataSempl[i].max*e._scaleShadow+e._offsetY),l.render(),c._blur=e.arrDataSempl[i].blur+(e._scaleShadow>1?e._scaleShadow:0),c._alpha=e.arrDataSempl[i].alpha,c.update();e.setConstMin(-999999),e.setConstMax(999999),f.needsUpdate=!0}(),e.meshPlan.scale.set(d,d,1),e.meshPlan.position.set(u.x+d/2,0,u.y+d/2),e.isTime&&console.timeEnd("render "+i),e.onUpdate&&e.onUpdate()};var E=new THREE.Box3(new THREE.Vector3,new THREE.Vector3(300,300,300));this.boundingBoxUv=E;var I=new THREE.Vector3;function C(t){if("Mesh"===t.type){var i=!1,n=t.getWorldPosition(t.position),a=t.getWorldQuaternion(t.quaternion),r=e.maxHeight;n.y-=e._offsetY,t.userData.pos?t.userData.pos.y!=n.y?i=!0:t.userData.rot.equals(a)?t.userData.maxHeight!==r?i=!0:t.userData.scaleShadow!==e._scaleShadow&&(i=!0):i=!0:i=!0,e._isDinamFotoRect||(s.setFromObject(t),M(s.min.x,s.min.z,s.max.x-s.min.x,s.max.z-s.min.z,e.fotoPosition.x,e.fotoPosition.y,e.fotoWH,e.fotoWH)||(i=!1)),i&&(!function(t){t.geometry.uuid===t.userData.targetObject.geometry.uuid&&(t.geometry=t.userData.targetObject.geometry.clone());var i=E,n=0;if(t.geometry instanceof THREE.Geometry){for(var a=t.geometry.faces,r=t.geometry.vertices,s=t.geometry.faceVertexUvs[0],o=0;o<a.length;o++)I.set(r[a[o].a].x,r[a[o].a].y,r[a[o].a].z),t.localToWorld(I),n=1-S(I.y-e._offsetY,i.min.y,i.min.y+i.max.y)/100,s[o][0].set(n,n),I.set(r[a[o].b].x,r[a[o].b].y,r[a[o].b].z),t.localToWorld(I),n=1-S(I.y-e._offsetY,i.min.y,i.min.y+i.max.y)/100,s[o][1].set(n,n),I.set(r[a[o].c].x,r[a[o].c].y,r[a[o].c].z),t.localToWorld(I),n=1-S(I.y-e._offsetY,i.min.y,i.min.y+i.max.y)/100,s[o][2].set(n,n);t.geometry.uvsNeedUpdate=!0}else{var h=t.geometry.attributes.position.array;t.geometry.attributes.uv||(arrUvAttribut=new Float32Array(h.length/3*2),t.geometry.addAttribute("uv",new THREE.BufferAttribute(arrUvAttribut,2)));var A=t.geometry.attributes.uv.array,l=(t.geometry.attributes.uv.itemSize,t.geometry.index.array),u=t.geometry.index.count;for(o=0;o<u;o++){var d=l[o],c=3*d,f=2*d;I.set(h[c],h[c+1],h[c+2]),t.localToWorld(I),n=1-S(I.y-e._offsetY,i.min.y,i.min.y+i.max.y*e._scaleShadow)/100,A[f]=n,A[f+1]=n}t.geometry.attributes.uv.needsUpdate=!0}}(t),t.userData.pos=n,t.userData.rot=a,t.userData.maxHeight=r,t.userData.scaleShadow=e._scaleShadow)}for(var o=0;o<t.children.length;o++)C(t.children[o])}function T(){y.scale.x=(e.boundingBoxUv.max.y||1)*e._scaleShadow,y.position.y=y.scale.x/2+e.boundingBoxUv.min.y;for(var t=0;t<e.arrShadowMesh.length;t++)(e._isDinamFotoRect||(s.setFromObject(e.arrShadowMesh[t]),M(s.min.x,s.min.z,s.max.x-s.min.x,s.max.z-s.min.z,e.fotoPosition.x,e.fotoPosition.y,e.fotoWH,e.fotoWH)))&&C(e.arrShadowMesh[t])}this.updateShadowUv=T,this.updateShadowTexture=function(){this.canvasGG.update(),this.textureShadow.needsUpdate=!0},this.setShadowColor=function(t,i,n){p.r=t,p.g=i,p.b=n,e.updateShadowTexture()},this.getConfig=function(){var t={};return t.imgWH=e.imgWH,t.fotoPosition={x:e._fotoPosition.x,y:e._fotoPosition.y},t.fotoWH=e.fotoWH,t.maxHeight=e.maxHeight,t.isDinamFotoRect=e.isDinamFotoRect,t.arrDataSempl=e.arrDataSempl,t.opacityMat=e.opacityMat,t.dunamic=e.dunamic,t.canvasGG={arrColorStopTranspanent:e.canvasGG.arrColorStopTranspanent,arrProcent:e.canvasGG.arrProcent},t},this.setConfig=function(t){e.canvasGG.arrColorStopTranspanent=t.canvasGG.arrColorStopTranspanent,e.canvasGG.arrProcent=t.canvasGG.arrProcent,e.fotoPosition.x=t.fotoPosition.x,e.fotoPosition.y=t.fotoPosition.y,e.fotoWH=t.fotoWH,e.isDinamFotoRect=t.isDinamFotoRect,e.arrDataSempl=t.arrDataSempl,e.opacityMat=t.opacityMat,e.imgWH=t.imgWH,e.dunamic=t.dunamic,e.updateShadowTexture(),e.maxHeight=t.maxHeight};var P={imgWH:1024,fotoPosition:{x:0,y:0},fotoWH:150,maxHeight:300,isDinamFotoRect:!1,arrDataSempl:[{min:0,max:6,blur:.8,alpha:.25},{min:4,max:15,blur:3,alpha:.64},{min:10,max:23,blur:4,alpha:.5},{min:15,max:50,blur:15,alpha:1},{min:20,max:198.09,blur:15,alpha:.7},{min:0,max:2,blur:1.02,alpha:1}],opacityMat:1,dunamic:!0,canvasGG:{arrColorStopTranspanent:[0,1,.25],arrProcent:[.4,1,.96]}};function M(t,e,i,n,a,r,s,o){return t<a+s&&e<r+o&&t+i>a&&e+n>r}function S(t,e,i,n){return e=null!=e?e:0,i=null!=i?i:100,n=n||100,isNaN(parseFloat(t))&&(t=e),t<e&&(t=e),t>i&&(t=i),t=Math.round(t*n)/n,e<0?100*(Math.abs(e)+t)/(Math.abs(e)+Math.abs(i)||1):100*(Math.abs(e)-t)/(Math.abs(e)-Math.abs(i)||1)}this.sss=P,this.setConfig(P),this.getBase64=function(){return e.render(),c.canvas.toDataURL()},this.debug=!1}function o(t,e,i,n){this.min=t||0,this.max=e||1,this.blur=i||0,this.alpha=n||1}function h(){var t=this,e=document.createElement("canvas");this.canvas=e,e.width=256,e.height=256;var i=e.getContext("2d"),n=new Image;this.b64=null,this._blur=0,this._blur1=1,this._alpha=1,this.image=new Image,this.setBase64=function(i,a){this.b64=i,(n=new Image).onload=function(){e.clearRect(0,0,e.width,e.height),e.width=n.width,e.height=n.height,t.update(),a&&a(e.toDataURL())},n.src=i},this.setCanvas=function(t){n=t,e.width=t.width,e.height=t.height},this.update=function(){i.filter="blur("+t._blur+"px)",i.globalAlpha=t._alpha,i.drawImage(n,0,0)}}function A(){var t=this,e=document.createElement("canvas");e.width=e.height=256,this.canvas=e;var i=e.getContext("2d");this._blur=0,this._alpha=1,this.arrColorStopTranspanent=[0,1],this.arrProcent=[0,1],this.position=new THREE.Vector2,this.position1=new THREE.Vector2(1,0),this.r=0,this.g=0,this.b=0,this.update=function(){var n=e.width,a=e.height;i.clearRect(0,0,n,a),i.rect(0,0,n,a),i.filter="blur("+t._blur+"px)",i.globalAlpha=t._alpha;for(var r=t.position.x*n,s=t.position.y*a,o=t.position1.x*n,h=t.position1.y*a,A=i.createLinearGradient(r,s,o,h),l=0;l<t.arrColorStopTranspanent.length;l++)A.addColorStop(t.arrProcent[l],"rgba("+t.r+","+t.g+","+t.b+","+t.arrColorStopTranspanent[l]+")");i.fillStyle=A,i.fill()},this.update()}function l(t){this.parent=t;this._active=!1,this._visible=!0,this.WH=512,this._wn=this.WH,this._obj3d=void 0,this.smc=void 0,this.init=function(){null==this.smc&&(this.smc=new s,this.smc.fotoPosition.set(-this._wn/2,-this._wn/2),this.smc.fotoWH=this._wn,this.smc.content3d.rotation.x=-Math.PI/2,this.smc.content3d.position.y=-1,this.smc.content3d.visible=this._visible,this.dergObj())},this.dergActiv=function(){1==this._active?null==this.smc.content3d.parent&&this.parent.parent.groupObject.add(this.smc.content3d):null!=this.smc.content3d.parent&&this.parent.parent.groupObject.remove(this.smc.content3d)},this.render=function(){null!=this.smc&&null!=this.smc.content3d.parent&&this.smc.upDate()},this.dergObj=function(){null!=this.smc&&(null!=this._obj3d?this.smc.arrObj[0]==this._obj3d||(this.smc.clear(),this.smc.addObj(this._obj3d)):this.smc.clear())}}function u(t){var e=this;this.visi3D=t,this.box3=new THREE.Box3,this.rectScreen=new c,this.world=new c(0,0,100,100),this.targetObject=null,this.arrPoint=[],this.isMoveCam=!1,this.isFromGeometry=!1,this._offset=0,this._active=!0,this._debug=!1;var i=new THREE.Vector2,n=new THREE.Vector2,a=new THREE.Vector3;function r(){e.zumeVisi3D(),i.set(e.world.x+e.world.width/2,e.world.y+e.world.height/2),n.set(e.rectScreen.x+e.rectScreen.width/2,e.rectScreen.y+e.rectScreen.height/2),i.sub(n).divideScalar(2)}this.upDate=function(){if(e.active&&(this.updateBound3d(),!e.box3.isEmpty())){if(this.visi3D.xVerh=a.x,this.visi3D.zVerh=a.z,this.visi3D.yVerh=-a.y,e.zumeVisi3D(),e.isMoveCam){r();for(var t=0;i.length()>2&&++t<10;)this.visi3D.position3d.moveCamXY(i),r()}e.debugFocus&&e.debugFocus.upDate()}},this.zumeVisi3D=function(){for(var t,i,n=0,a=6e4,r=0;n<a&&!(++r>20)&&(i=t=(n+a)/2,e.visi3D.zume=i,!(Math.abs(n-t)<.01||Math.abs(a-t)<.01||t<.01));)e.updateRectScreen(),e.isZoomIn()?a=t:n=t+1},this.updateBound3d=function(){if(e.box3.makeEmpty(),e.targetObject)e.box3.copy(e.getCompoundBoundingBox(e.targetObject));else for(var t=0;t<e.arrPoint.length;t++)e.box3.expandByPoint(e.arrPoint[t]);e.box3.getCenter(a)},this.updateRectScreen=function(){if(this.visi3D.camera.updateMatrixWorld(),this.visi3D.scene.updateMatrixWorld(),e.targetObject&&e.isFromGeometry){var t=e.getBoxObject(e.targetObject);e.box3.copy(t.box3),e.box3.getCenter(a),e.setRectFromBox(e.rectScreen,t.box2)}else e.setRectFromBox(e.rectScreen,e.boxToScreen(e.box3));e.updateWorldSize()},this.setRectFromBox=function(t,e){t.x=e.min.x,t.y=e.min.y,t.width=e.max.x-e.min.x,t.height=e.max.y-e.min.y},this.getCompoundBoundingBox=function(){var t=new THREE.Box3,e=new THREE.Box3;function i(i){var n=i.geometry;void 0!==n&&(n.boundingBox||n.computeBoundingBox(),e.copy(n.boundingBox),e.applyMatrix4(i.matrixWorld),t.union(e))}return function(e){return e.updateMatrixWorld(!0),t.makeEmpty(),e.traverseVisible(i),t}}(),this.boxToScreen=function(){for(var t=new THREE.Box2,i=[],n=0;n<8;n++)i[n]=new THREE.Vector3;return function(n){t.makeEmpty(),i[0].set(n.min.x,n.min.y,n.min.z),i[1].set(n.min.x,n.max.y,n.min.z),i[2].set(n.max.x,n.min.y,n.min.z),i[3].set(n.max.x,n.max.y,n.min.z),i[4].set(n.min.x,n.min.y,n.max.z),i[5].set(n.min.x,n.max.y,n.max.z),i[6].set(n.max.x,n.min.y,n.max.z),i[7].set(n.max.x,n.max.y,n.max.z);for(var a=0;a<i.length;a++)t.expandByPoint(e.toScreenXY(i[a]));return t}}(),this.getBoxObject=function(){var t,i,n=new THREE.Box2,a=new THREE.Box3,r={box2:n,box3:a},s=new THREE.Vector3;function o(r){var o=r.geometry;if(void 0!==o)if(o.isGeometry){var h=o.vertices;for(t=0,i=h.length;t<i;t++)s.copy(h[t]).applyMatrix4(r.matrixWorld),a.expandByPoint(s),n.expandByPoint(e.toScreenXY(s))}else if(o.isBufferGeometry){var A=o.attributes.position;if(void 0!==A)for(t=0,i=A.count;t<i;t++)s.fromBufferAttribute(A,t).applyMatrix4(r.matrixWorld),a.expandByPoint(s),n.expandByPoint(e.toScreenXY(s))}}return function(t){return t.updateMatrixWorld(!0),n.makeEmpty(),a.makeEmpty(),t.traverseVisible(o),r}}();var s=new THREE.Vector2,o=new THREE.Vector3;this.toScreenXY=function(t){return o.copy(t),o.project(e.visi3D.camera),s.x=Math.round((o.x+1)*e.visi3D._width/2),s.y=Math.round((1-o.y)*e.visi3D._height/2),s},this.updateWorldSize=function(){e.world.x=e.offset,e.world.y=e.offset,e.world.width=this.visi3D._width-2*e.offset,e.world.height=this.visi3D._height-2*e.offset},this.isZoomIn=function(){return e.rectScreen.x>e.world.x&&e.rectScreen.x+e.rectScreen.width<e.world.x+e.world.width&&e.rectScreen.y>e.world.y&&e.rectScreen.y+e.rectScreen.height<e.world.y+e.world.height}}function d(t){var e=this;this.mFocus=t;var i=visi3D.scene,n=main.stage,a=new BoxHelper(1,materialAlphaRed);i.add(a);var r=new PIXI.Graphics;r.hitArea=new PIXI.Rectangle(0,0,0,0),n.addChild(r),e.active=!1,a.visible=r.visible=e.active,this.upDate=function(){a.visible=r.visible=e.active,e.active&&(r.clear(),r.position.set(visi3D._x,visi3D._y),r.lineStyle(1,0,1),r.drawRect(t.world.x,t.world.y,t.world.width,t.world.height),r.lineStyle(1,16711680,1),r.drawRect(t.rectScreen.x,t.rectScreen.y,t.rectScreen.width,t.rectScreen.height),a.width=t.box3.max.x-t.box3.min.x,a.depth=t.box3.max.y-t.box3.min.y,a.height=t.box3.max.z-t.box3.min.z,t.box3.getCenter(a.position))}}function c(t,e,i,n,a){this._x=t||0,this._y=e||0,this._width=void 0!==i?i:100,this._height=void 0!==n?n:100,this.angel=0,this.p=new f,this.fun,this.set=function(t,e,i,n){this._x=t||0,this._y=e||0,this._width=void 0!==i?i:100,this._height=void 0!==n?n:100},this.setRect=function(t){this._x=t.x,this._y=t.y,this._width=t.width,this._height=t.height,this.p.setPoint(t.p),this.angel=t.angel}}function f(t,e,i){this._x=t||0,this._y=e||0,this._z=i||0,this.xx=0,this.yy=0,this.zz=0,this.set=function(t,e,i){this._x=t||0,this._y=e||0,void 0!==i&&(this._z=i)},this.setPoint=function(t){this._x=t.x,this._y=t.y,void 0!==t.z&&(this._z=t.z)},this.getObj=function(){var t={};return t.x=this._x,t.y=this._y,t.z=this._z,t},this.copy=function(){return new f(this._x,this._y,this._z)}}function p(t){var e=this;this.parent=t,this._debug=!1,this.debugInit=!1,this.shadowHelper=void 0,this.spotLightHelper=void 0,this.gridHelper=void 0,this.FIXATION=!1,this.ROTATION_X=0,this.ROTATION_Z=0,this.DISTANCE=this.parent.DISTANCE,this.CUB_HEIGHT=this.parent.CUB_HEIGHT,this.CUB_WIDTH=this.parent.CUB_WIDTH,this.SKY_X=0,this.SKY_Y=0,this.SKY_Z=0,this._fixation=this.FIXATION,this._rotationX=this.ROTATION_X,this._rotationZ=this.ROTATION_Z,this._distance=this.DISTANCE,this._cubHeight=this.CUB_HEIGHT,this._cubWidth=this.CUB_WIDTH,this.sky=new a(this),this.smc=new l(this),this.focus=new u(this.parent),this.funDebug=function(){1!=this.debugInit&&(this.debugInit=!0,this.plane=new THREE.Mesh(new THREE.PlaneBufferGeometry(1e3,1e3).rotateX(-Math.PI),new THREE.MeshPhongMaterial({color:11316396,transparent:!0,opacity:.5})),this.plane.castShadow=this.plane.receiveShadow=!0,this.plane.position.z=2,this.plane.renderOrder=1,this.gridHelper=new THREE.GridHelper(1e3,10),this.gridHelper.rotation.x=-Math.PI/2,this.shadowHelper=new THREE.CameraHelper(this.parent.sunLight.shadow.camera),this.parent.sunLight&&(this.spotLightHelper=new THREE.DirectionalLightHelper(this.parent.sunLight))),1==this._debug?(null==this.gridHelper.parent&&this.parent.groupObject.add(this.gridHelper),null==this.plane.parent&&this.parent.groupObject.add(this.plane),null==this.shadowHelper.parent&&this.parent.scene.add(this.shadowHelper),this.parent.sunLight&&(null!=this.parent.sunLight.parent||(null!=this.spotLightHelper.parent&&this.parent.scene.remove(this.spotLightHelper),null!=this.shadowHelper.parent&&this.parent.scene.remove(this.shadowHelper)))):(null!=this.gridHelper.parent&&this.parent.groupObject.remove(this.gridHelper),null!=this.plane.parent&&this.parent.groupObject.remove(this.plane),null!=this.shadowHelper.parent&&this.parent.scene.remove(this.shadowHelper),this.parent.sunLight&&null!=this.spotLightHelper.parent&&this.parent.scene.remove(this.spotLightHelper))},this.render=function(){1==this._debug&&null!=this.spotLightHelper&&this.spotLightHelper.update(),this.smc.render(),this.sky.render(),this.focus.upDate(),this.dragSunLight()};var i=0;this.dragSunLight=function(){var t;null!=this.parent.sunLight&&(null!=this.parent.sunLight.parent&&(!0===e._fixation?(i=this._distance+2*this._cubHeight,e.parent.sunLight.position.set(0,i,0),e.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(1,0,0),e._rotationX),e.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(0,1,0),e._rotationZ-e.parent._rotationZ)):(i=this._distance+this._cubHeight,this.parent.sunLight.position.set(0,i,0),this.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(1,0,0),this._rotationX),this.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(0,1,0),this._rotationZ),this.parent.staticShadow&&(t=new THREE.Vector3(e.parent.xVerh,e.parent.yVerh,e.parent.zVerh),e.parent.sunLight.position.add(t),e.parent.sunLight.target.position.copy(t),n.distanceTo(t)>e.distanceUpdateShadow&&(n.copy(t),e.parent.shadowNeedsUpdate=!0)))))};var n=new THREE.Vector3;this.distanceUpdateShadow=500,this.dragSunLight2=function(){null!=this.parent.sunLight&&null!=this.parent.sunLight.parent&&(!0===this._fixation||(i=this._distance+2*this._cubHeight,this.parent.sunLight.position.set(0,i,0),this.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(1,0,0),this._rotationX),this.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(0,1,0),this._rotationZ)))},this.dragSunLight3=function(){this.parent.sunLight&&(this.parent.sunLight.shadow.camera.near=0+this._cubHeight,this.parent.sunLight.shadow.camera.far=2*this._cubHeight+this._cubHeight,this.parent.sunLight.shadow.camera.updateProjectionMatrix(),this.shadowHelper&&this.shadowHelper.update())},this.sunActiv=function(t){this.parent.objShadow(this.parent.group,t),1==t?null==this.parent.sunLight.parent&&(this.parent.scene.add(this.parent.sunLight),this.parent.scene.add(e.parent.sunLight.target)):null!=this.parent.sunLight.parent&&(this.parent.scene.remove(this.parent.sunLight),this.parent.scene.remove(e.parent.sunLight.target)),this.funDebug()},this.ambientActiv=function(t){1==t?null==this.parent.ambientLight.parent&&this.parent.scene.add(this.parent.ambientLight):null!=this.parent.ambientLight.parent&&this.parent.scene.remove(this.parent.ambientLight)}}a.prototype={set x(t){this._x!==t&&(this._x=t,this.cont3d.position.x=t,this.parent.parent.intRend=1)},get x(){return this._x},set y(t){this._y!==t&&(this._y=t,this.cont3d.position.y=t,this.parent.parent.intRend=1)},get y(){return this._y},set z(t){this._z!==t&&(this._z=t,this.cont3d.position.z=t,this.parent.parent.intRend=1)},get z(){return this._z},set active(t){this._active!==t&&(this._active=t,this.init(),this.dergActiv())},get active(){return this._active},set radius(t){this._radius!==t&&(this._radius=t,null!=this.mesh&&this.mesh.scale.set(this._radius,this._radius,this._radius))},get radius(){return this._radius},set link(t){this._link!==t&&(this._link=t,this.init(),this.dergLink())},get link(){return this._link},set color(t){if(this._color!==t){this._color=t,this.init();var e=this._color;if("string"==typeof e&&-1!=e.indexOf("x")){var i=e.split("x");e="#"+i[1]}this.material.color=new THREE.Color(e)}},get color(){return this._color}},Object.defineProperties(s.prototype,{scaleShadow:{set:function(t){this.dirty=!0,this._scaleShadow=t},get:function(){return this._scaleShadow}},debug:{set:function(t){this.helpers.visible=t},get:function(){return this.helpers.visible}},offsetY:{set:function(t){this._offsetY=t,this.dirty=!0},get:function(){return this._offsetY}},maxHeight:{set:function(t){this.dirty=!0,this.boundingBoxUv.max.y=t,this.updateShadowUv()},get:function(){return this.boundingBoxUv.max.y}},dunamic:{set:function(t){this.dirty=!0,this._dunamic=t},get:function(){return this._dunamic}},fotoPosition:{set:function(t){this.dirty=!0,this._fotoPosition=t},get:function(){return this._fotoPosition}},fotoWH:{set:function(t){this.dirty=!0,this._fotoWH=t},get:function(){return this._fotoWH}},imgWH:{set:function(t){this.dirty=!0,this._imgWH=t},get:function(){return this._imgWH}},imgBlur:{set:function(t){this.dirty=!0,this._imgBlur=t},get:function(){return this.dirty=!0,this._imgBlur}},imgAlpha:{set:function(t){this.dirty=!0,this._imgAlpha=t},get:function(){return this._imgAlpha}},isDinamFotoRect:{set:function(t){this.dirty=!0,this._isDinamFotoRect=t},get:function(){return this._isDinamFotoRect}},opacityMat:{set:function(t){this.dirty=!0,this._opacityMat=t,this.matPlan.opacity=this._opacityMat},get:function(){return this._opacityMat}},shadowMaterial:{set:function(t){if(t!==this._shadowMaterial){this._shadowMaterial=t;for(var e=0;e<this.arrShadowMesh.length;e++)if(this.arrShadowMesh[e]instanceof THREE.ShadowMesh)this.arrShadowMesh[e].material=this._shadowMaterial;else for(var i=0;i<this.arrShadowMesh[e].children.length;i++)this.arrShadowMesh[e].children[i]instanceof THREE.ShadowMesh&&(this.arrShadowMesh[e].children[i].material=this._shadowMaterial)}},get:function(){return this._shadowMaterial}},lightPosition4D:{set:function(t){this._lightPosition4D.set(t.x,t.y,t.z,.001)},get:function(){return this._lightPosition4D}}}),Object.defineProperties(h.prototype,{blur:{set:function(t){this._blur=t},get:function(){return this._blur}},alpha:{set:function(t){this._alpha=t},get:function(){return this._alpha}}}),Object.defineProperties(A.prototype,{}),l.prototype={set active(t){this._active!==t&&(this._active=t,this.init(),this.dergActiv())},get active(){return this._active},set visible(t){this._visible!==t&&(this._visible=t,null!=this.smc&&(this.smc.content3d.visible=t))},get visible(){return this._visible},set obj3d(t){this._obj3d!==t&&(this._obj3d=t,this.dergObj())},get obj3d(){return this._obj3d},set wh(t){this._wh!==t&&(this._wh=t,null!=this.smc&&(this.smc.fotoPosition.set(-this._wn/2,-this._wn/2),this.smc.fotoWH=this._wn))},get wh(){return this._wh}},u.prototype={set offset(t){this._offset=t||0},get offset(){return this._offset},set debug(t){this._debug=t,t&&!this.debugFocus&&(this.debugFocus=new d(this)),this.debugFocus&&(this.debugFocus.active=t)},get debug(){return this._debug},set active(t){this._active=t,t||(this.debug=!1)},get active(){return this._active}},c.prototype={set x(t){this._x!==t&&(this._x=t)},get x(){return this._x},set y(t){this._y!==t&&(this._y=t)},get y(){return this._y},set width(t){this._width!==t&&(this._width=t)},get width(){return this._width},set height(t){this._height!==t&&(this._height=t)},get height(){return this._height}},f.prototype={set x(t){this._x=t},get x(){return this._x},set y(t){this._y=t},get y(){return this._y},set z(t){this._z=t},get z(){return this._z}},i.d(e,"a",function(){return p}),p.prototype={set debug(t){this._debug!==t&&(this._debug=t,this.funDebug())},get debug(){return this._debug},set rotationX(t){this._rotationX!==t&&(this._rotationX=t,null!=this.spotLightHelper&&(this.parent.sunLight.shadow.camera.updateProjectionMatrix(),this.spotLightHelper.update()),this.dragSunLight2())},get rotationX(){return this._rotationX},set rotationZ(t){this._rotationZ!==t&&(this._rotationZ=t,this.sky.shadRotZ=t,null!=this.spotLightHelper&&this.spotLightHelper.update(),this.dragSunLight2())},get rotationZ(){return this._rotationZ},set fixation(t){this._fixation!==t&&(this._fixation=t,this.dragSunLight2())},get fixation(){return this._fixation},set distance(t){this._distance!==t&&(this._distance=t,this.dragSunLight3(),this.dragSunLight2())},get distance(){return this._distance},set cubHeight(t){this._cubHeight!==t&&(this._cubHeight=t,this.dragSunLight3(),this.dragSunLight2())},get cubHeight(){return this._cubHeight},set cubWidth(t){this._cubWidth!==t&&(this._cubWidth=t,this.parent.sunLight&&(this.parent.sunLight.shadow.camera.right=this._cubWidth,this.parent.sunLight.shadow.camera.left=-this._cubWidth,this.parent.sunLight.shadow.camera.top=this._cubWidth,this.parent.sunLight.shadow.camera.bottom=-this._cubWidth,this.parent.sunLight.shadow.camera.updateProjectionMatrix(),this.shadowHelper&&this.shadowHelper.update()))},get cubWidth(){return this._cubWidth}}},function(t,e,i){"use strict";var n=i(13);function a(t,e,i){this.type="PMMat";this.par=t,this.visi3D=e,this.objbase=i,this.pmTexture=this.par.tex,this.ser=window.location.href;var n=window.location.href.split("?")[0].split("/");this.server="";for(var a=0;a<n.length-1;a++)this.server+=n[a]+"/";this.aOBase={};for(a=0;a<this.objbase.bd.length;a++)this.aOBase[this.objbase.bd[a].id]=this.objbase.bd[a].obj;this.aO={},this.getIDReturn=function(t){if(null!=this.aO[t])return this.aO[t];var e=this.aOBase[t],i=this.par.mat.getIDReturn(e.str[0],!0);if(i.userData=e,"null"!=e.str[1]){trace(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",e.str[0],e.str[1]);var n=new THREE.Color(e.str[1]);new THREE.Color(16777215*Math.random());setTimeout(function(){i.color=n},1e3)}return this.aO[t]=i,this.aO[t]}}function r(t){THREE.Group.call(this),this.type="MeshCombined",this._meshes=t,this._ready=!1,this.init()}r.prototype=Object.create(THREE.Group.prototype),r.constructor=r,Object.defineProperties(r.prototype,{}),r.prototype.canAnalyze=function(){return this._meshes.reduce(function(t,e){return t&&e.geometry},!0)},r.prototype._getMaterialKey=function(t){return t.material.uuid},r.prototype.init=function(){var t=this;if(this._ready||!this.canAnalyze)return!1;var e=[],i={};return this._meshes.forEach(function(t){var e=t.geometry.uuid;i[e]||(i[e]=[]),i[e].push(t)}),Object.keys(i).forEach(function(n){var a=i[n],r=a[0].geometry;if(1!==a.length){var s={};a.forEach(function(e){var i=t._getMaterialKey(e);s[i]||(s[i]=[]),s[i].push(e)}),Object.keys(s).forEach(function(t){var i=s[t],n=i[0].material,a=i.length,o=new THREE.InstancedMesh(r,n.clone(),a);e.push(o),i.forEach(function(t,e){o.setQuaternionAt(e,t.quaternion),o.setPositionAt(e,t.position),o.setScaleAt(e,t.scale)}),o.needsUpdate()})}else e.push(a[0])}),e.forEach(function(e){return t.add(e)}),!0};var s=new THREE.MeshDepthMaterial;s.depthPacking=THREE.RGBADepthPacking,s.clipping=!0,s.defines={INSTANCE_TRANSFORM:""};var o=THREE.ShaderLib.distanceRGBA,h=THREE.UniformsUtils.clone(o.uniforms),A=new THREE.ShaderMaterial({defines:{USE_SHADOWMAP:"",INSTANCE_TRANSFORM:""},uniforms:h,vertexShader:o.vertexShader,fragmentShader:o.fragmentShader,clipping:!0});THREE.InstancedMesh=function(t,e,i){THREE.Mesh.call(this,(new u).setGeometry(t),e);var n=this;this.type="InstancedMesh",this.numInstances=i||1,this.customDepthMaterial=s,this.customDistanceMaterial=A,this.onAfterRender=function(t,e,i,a,r,s){n.geometry.update(i)}},THREE.InstancedMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.InstancedMesh.constructor=THREE.InstancedMesh,Object.defineProperties(THREE.InstancedMesh.prototype,{material:{set:function(t){this._material=t,this._material.defines=this._material.defines||{},this._material.defines.INSTANCE_TRANSFORM="",this._material.needsUpdate=!0},get:function(){return this._material}},geometry:{set:function(t){t instanceof u?this._geometry=t:this._geometry.setGeometry(t)},get:function(){return this._geometry}},numInstances:{set:function(t){this._numInstances=t,this.geometry.setCount(this.numInstances)},get:function(){return this._numInstances}}}),THREE.InstancedMesh.prototype.setPositionAt=function(t,e){this.geometry.setPositionAt(t,e)},THREE.InstancedMesh.prototype.setQuaternionAt=function(t,e){this.geometry.setQuaternionAt(t,e)},THREE.InstancedMesh.prototype.setScaleAt=function(t,e){this.geometry.setScaleAt(t,e)},THREE.InstancedMesh.prototype.getPositionAt=function(t,e){return this.geometry.getPositionAt(t,e)},THREE.InstancedMesh.prototype.getQuaternionAt=function(t,e){return this.geometry.getQuaternionAt(t,e)},THREE.InstancedMesh.prototype.getScaleAt=function(t,e){return this.geometry.getScaleAt(t,e)},THREE.InstancedMesh.prototype.needsUpdate=function(){this.geometry.needsUpdate=!0,this.geometry.computeBoundingSphere()};var l;new THREE.BoxBufferGeometry(1,1,1),new THREE.MeshNormalMaterial({wireframe:!0});function u(){THREE.InstancedBufferGeometry.call(this),this.count=0;var t=this;this.boundOrigin=new THREE.Box3,this.arrTransform=[],this.gridTransform=new c(this.arrTransform),this.setCount=function(t){if(this.count=t,(this.maxInstancedCount||0)<t&&(!this.attributes.instanceQuaternion||this.attributes.instanceQuaternion.count<t)){var e={instanceQuaternion:new Float32Array(4*t),instancePosition:new Float32Array(3*t),instanceScale:new Float32Array(3*t)};this.setAttribute("instanceQuaternion",new THREE.InstancedBufferAttribute(e.instanceQuaternion,4)),this.setAttribute("instancePosition",new THREE.InstancedBufferAttribute(e.instancePosition,3)),this.setAttribute("instanceScale",new THREE.InstancedBufferAttribute(e.instanceScale,3)),this.needsUpdate=!0}for(var i=0;i<t;i++)this.arrTransform[i]=new d(this.boundOrigin);this.maxInstancedCount=t},this.setGeometry=function(t){return this.copy(t),this.boundOrigin.setFromBufferAttribute(this.attributes.position),this};var e=new THREE.Frustum,i=new THREE.Matrix4;this.arrTransformVisible=[],this.update=function(n){i.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),e.setFromMatrix(i);var a=0;this.arrTransformVisible=[];for(var r=0;r<this.gridTransform.arrGridIndex.length;r++){var s=this.gridTransform.arrGridIndex[r];if(e.intersectsBox(s.boundingBox))for(var o=0;o<s.arrTransform.length;o++){var h=s.arrTransform[o];this.arrTransformVisible.push(h),this.setTransformAt(a++,h)}}t.maxInstancedCount=a,t.needsUpdate=!0},this.updateGrid=function(){this.gridTransform.updateGrid()}}function d(t){this.boundOrigin=t,this._boundingBox=null,this.p=new THREE.Vector3,this.s=new THREE.Vector3(1,1,1),this.q=new THREE.Quaternion,this.setP=function(t){this.p.copy(t)},this.setS=function(t){this.s.copy(t)},this.setQ=function(t){this.q.copy(t)}}function c(t){var e=this;this.arrTransform=t;var i=100;function n(t){var n="x"+Math.floor(t.x/i)+"y"+Math.floor(t.y/i)+"z"+Math.floor(t.z/i);return e.cache[n]||(e.cache[n]=new f),e.cache[n]}this.arrGridIndex=[],this.cache={},this.updateGrid=function(){this.arrGridIndex.length=0,this.cache={};for(var t=0;t<this.arrTransform.length;t++){var e=this.arrTransform[t];n(e.p).arrTransform.push(e)}for(var i in this.cache)this.cache[i].computeBoundingBox(),this.arrGridIndex.push(this.cache[i])}}function f(){this.arrTransform=[],this._boundingBox=null}u.prototype=Object.create(THREE.InstancedBufferGeometry.prototype),u.constructor=u,u.prototype.setTransformAt=function(t,e){this.attributes.instanceScale.setXYZ(t,e.s.x,e.s.y,e.s.z),this.attributes.instancePosition.setXYZ(t,e.p.x,e.p.y,e.p.z),this.attributes.instanceQuaternion.setXYZW(t,e.q.x,e.q.y,e.q.z,e.q.w)},u.prototype.setPositionAt=function(t,e){this.arrTransform[t].setP(e),this.setTransformAt(t,this.arrTransform[t])},u.prototype.setQuaternionAt=function(t,e){this.arrTransform[t].setQ(e),this.setTransformAt(t,this.arrTransform[t])},u.prototype.setScaleAt=function(t,e){this.arrTransform[t].setS(e),this.setTransformAt(t,this.arrTransform[t])},u.prototype.getPositionAt=function(t,e){return e?e.copy(this.arrTransform[t].p):this.arrTransform[t].p},u.prototype.getQuaternionAt=function(t,e){return e?e.copy(this.arrTransform[t].q):this.arrTransform[t].q},u.prototype.getScaleAt=function(t,e){return e?e.copy(this.arrTransform[t].s):this.arrTransform[t].s},u.prototype.computeBoundingSphere=function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere),this.computeBoundingBox(),this.boundingBox.getBoundingSphere(this.boundingSphere),this.updateGrid()},u.prototype.computeBoundingBox=function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3),this.boundingBox.makeEmpty();for(var t=0,e=this.count;t<e;t++)this.boundingBox.union(this.getBoundingBoxAt(t))},u.prototype.getBoundingBoxAt=function(t){return this.arrTransform[t].boundingBox},Object.defineProperties(u.prototype,{needsUpdate:{set:function(t){this.attributes.instancePosition.needsUpdate=t,this.attributes.instanceQuaternion.needsUpdate=t,this.attributes.instanceScale.needsUpdate=t},get:function(){return!1}}}),d.prototype.computeBoundingBox=(l=new THREE.Matrix4,function(){return this._boundingBox||(this._boundingBox=new THREE.Box3),l.compose(this.p,this.q,this.s),this.boundingBox.copy(this.boundOrigin),this.boundingBox.applyMatrix4(l),this.boundingBox}),Object.defineProperties(d.prototype,{boundingBox:{set:function(t){this._boundingBox=t},get:function(){return this._boundingBox||this.computeBoundingBox()}}}),f.prototype.computeBoundingBox=function(){this._boundingBox||(this._boundingBox=new THREE.Box3),this.boundingBox.makeEmpty();for(var t=0,e=this.arrTransform.length;t<e;t++)this.boundingBox.union(this.arrTransform[t].boundingBox);return this.boundingBox},Object.defineProperties(f.prototype,{boundingBox:{set:function(t){this._boundingBox=t},get:function(){return this._boundingBox||this.computeBoundingBox()}}});var p=["#ifndef INSTANCE_TRANSFORM","vec3 transformed = vec3( position );","#else","#ifndef INSTANCE_MATRIX","mat4 _instanceMatrix = getInstanceMatrix();","#define INSTANCE_MATRIX","#endif","vec3 transformed = ( _instanceMatrix * vec4( position , 1. )).xyz;","#endif"].join("\n"),g=["#ifdef USE_COLOR","diffuseColor.rgb *= vColor;","#endif","#if defined(INSTANCE_COLOR)","diffuseColor.rgb *= vInstanceColor;","#endif"].join("\n"),m=["#ifdef USE_COLOR","varying vec3 vColor;","#endif","#if defined( INSTANCE_COLOR )","varying vec3 vInstanceColor;","#endif"].join("\n"),x=["#ifdef USE_COLOR","vColor.xyz = color.xyz;","#endif","#if defined( INSTANCE_COLOR ) && defined( INSTANCE_TRANSFORM )","vInstanceColor = instanceColor;","#endif"].join("\n"),b=["#ifdef FLIP_SIDED","objectNormal = -objectNormal;","#endif","#ifndef INSTANCE_TRANSFORM","vec3 transformedNormal = normalMatrix * objectNormal;","#else","#ifndef INSTANCE_MATRIX ","mat4 _instanceMatrix = getInstanceMatrix();","#define INSTANCE_MATRIX","#endif","#ifndef INSTANCE_UNIFORM","vec3 transformedNormal =  transposeMat3( inverse( mat3( modelViewMatrix * _instanceMatrix ) ) ) * objectNormal ;","#else","vec3 transformedNormal = ( modelViewMatrix * _instanceMatrix * vec4( objectNormal , 0.0 ) ).xyz;","#endif","#endif"].join("\n"),y=["#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )","varying vec2 vUv;","uniform mat3 uvTransform;","#endif","#ifdef INSTANCE_TRANSFORM","mat3 inverse(mat3 m) {","float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];","float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];","float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];","float b01 = a22 * a11 - a12 * a21;","float b11 = -a22 * a10 + a12 * a20;","float b21 = a21 * a10 - a11 * a20;","float det = a00 * b01 + a01 * b11 + a02 * b21;","return mat3(b01, (-a22 * a01 + a02 * a21), ( a12 * a01 - a02 * a11),","b11, ( a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),","b21, (-a21 * a00 + a01 * a20), ( a11 * a00 - a01 * a10)) / det;","}","attribute vec3 instancePosition;","attribute vec4 instanceQuaternion;","attribute vec3 instanceScale;","#if defined( INSTANCE_COLOR )","attribute vec3 instanceColor;","varying vec3 vInstanceColor;","#endif","mat4 getInstanceMatrix(){","vec4 q = instanceQuaternion;","vec3 s = instanceScale;","vec3 v = instancePosition;","vec3 q2 = q.xyz + q.xyz;","vec3 a = q.xxx * q2.xyz;","vec3 b = q.yyz * q2.yzz;","vec3 c = q.www * q2.xyz;","vec3 r0 = vec3( 1.0 - (b.x + b.z) , a.y + c.z , a.z - c.y ) * s.xxx;","vec3 r1 = vec3( a.y - c.z , 1.0 - (a.x + b.z) , b.y + c.x ) * s.yyy;","vec3 r2 = vec3( a.z + c.y , b.y - c.x , 1.0 - (a.x + b.x) ) * s.zzz;","return mat4(","r0 , 0.0,","r1 , 0.0,","r2 , 0.0,","v  , 1.0",");","}","#endif"].join("\n");function v(t,e,i){this.type="PMFilt";var n=this;this.par=t,this.visi3D=e,this.objbase=i,this.ceshGeom=new I(this),this.setObjS=function(t,e){!0,t.object.filt&&0!=t.object.filt.length?new _(this,t,e):this.finalObjS(t,e)},this.finalObjS=function(t,e){t.object.param&&(1==t.object.param.kesh&&n.ceshGeom.set(t.content3d),null!=t.object.param.sG&&1==t.object.param.sG&&n.ceshGeom.groupGeometri(t.content3d)),e()},this.dragParam=function(t,e){if(t.children)for(var i=t.children.length-1;i>=0;i--)this.dragParam(t.children[i],e);null==t.bs&&(t.castShadow=e.tOt,t.receiveShadow=e.tNa);var n=e.rO;t.iz&&t.iz.renderOrder&&(n=t.iz.renderOrder),t.renderOrder=n},this.dragPozition=function(t){var e=!1;t.object&&t.object.psm&&(e=!0,null!=t.object.psm.active&&0==t.object.psm.active&&(e=!1)),1==e?(t.content3d.position.set(t.object.psm.p[0],t.object.psm.p[1],t.object.psm.p[2]),t.content3d.rotation.set(t.object.psm.r[0],t.object.psm.r[1],t.object.psm.r[2]),t.content3d.scale.set(t.object.psm.s[0],t.object.psm.s[1],t.object.psm.s[2])):(t.content3d.position.set(0,0,0),t.content3d.rotation.set(0,0,0),t.content3d.scale.set(1,1,1))}}function _(t,e,i){this.type="StartFilt";this.par=t,this.hron=e,this.fun=i,this.hron.filt=this,this.array=[];var n,a=0;this.dragFilt=function(){a!=this.hron.object.filt.length?(n=this.hron.object.filt[a].type,a++,"mark"==n&&this.array.push(new E(this,this.hron.object.filt[a-1],this.array.length)),"material"==n&&this.array.push(new w(this,this.hron.object.filt[a-1],this.array.length))):this.par.finalObjS(this.hron,this.fun)},this.dragFilt()}function w(t,e,i){this.type="PMMaterial";this.par=t,this.obj=e,this.idArr=i,this.mat=this.par.par.par.mat.getTestTitle(e.id),null!=this.mat?(this.parsing=function(t){if(t.children)for(var e=t.children.length-1;e>=0;e--)this.parsing(t.children[e]);null!=t.material&&(t.material=this.mat)},this.parsing(t.hron.content3d),this.par.dragFilt()):this.par.dragFilt()}function E(t,e,i){this.type="PMMark";var n=this;if(this.par=t,this.obj=e,this.idArr=i,this.idKey=e.id,this.c3d=t.hron.content3d,this.arrName=[],this.arrayObj=[],"null"!=this.idKey){var a,r=!0;if(-1!=e.id.indexOf("|")){for(var s=e.id.split("|"),o=s[0].split(","),h=s[1].split(","),A=0;A<o.length;A++)this.arrName[A]={name:o[A],id:1*h[A],obCont:null};r=!1}else r=!0,this.arrName[0]={name:"null",id:e.id,obCont:null};this.parsing=function(t){if(t.children)for(var e=t.children.length-1;e>=0;e--)this.parsing(t.children[e]);if("Mesh"==t.type)if(r)a=this.arrName[0].obCont.clone(),t.parent.add(a),a.position.set(t.position.x,t.position.y,t.position.z),a.rotation.set(t.rotation.x,t.rotation.y,t.rotation.z),a.scale.set(t.scale.x,t.scale.y,t.scale.z),t.parent.remove(t);else if(t.name)for(e=this.arrName.length-1;e>=0;e--)if(-1!=t.name.indexOf(this.arrName[e].name))return a=this.arrName[e].obCont.clone(),t.parent.add(a),a.position.set(t.position.x,t.position.y,t.position.z),a.rotation.set(t.rotation.x,t.rotation.y,t.rotation.z),a.scale.set(t.scale.x,t.scale.y,t.scale.z),void t.parent.remove(t)},this.loadMMM=function(t){this.par.par.par.getId(1*t.id,function(e){t.obCont=e,n.loadMod()})},this.loadMod=function(){for(var t=0;t<this.arrName.length;t++)if(null==this.arrName[t].obCont)return void this.loadMMM(this.arrName[t]);this.parsing(this.c3d),this.par.dragFilt()},this.loadMod()}else this.par.dragFilt()}function I(t){this.type="CeshGeom";var e=this;e.kolCount=9999,this.par=t;var i,n,a={};function r(t,e,i,n){i&&e.updateMatrixWorld(),n&&t.updateMatrixWorld();var a=(new THREE.Matrix4).getInverse(e.matrixWorld);t.parent&&a.multiply(t.parent.matrixWorld),t.applyMatrix(a),e.add(t)}this.set=function(t){for(var i in a={},e.fillObjMesh(t),a)a[i].length>=2&&new C(this,t,a[i])},this.sliteGeom=new T,this.groupGeometri=function(t){a={},e.fillObjMesh(t);var s=!1;for(var o in a)if(a[o].length>=2){s=!0,this.sliteGeom.start(a[o][0].geometry.clone());for(var h=a[o].length-1;h>=0;h--)r(i=a[o][h],t),this.sliteGeom.setMesh(i),i.parent.remove(i);this.sliteGeom.final(),n=new THREE.Mesh(this.sliteGeom.creatGeom,i.material),t.add(n)}s&&e.killNull(t)},e.killNull=function(t){if(t.children)for(var i=t.children.length-1;i>=0;i--)e.killNull(t.children[i]);null!=t.geometry||null==t.children||0!=t.children.length||null==t.parent||t.parent.remove(t)},e.fillObjMesh=function(t){for(var i=function t(e){var i=[];e.updateMatrixWorld();e instanceof THREE.Mesh&&i.push(e);for(var n=0;n<e.children.length;n++)for(var a=t(e.children[n]),r=0;r<a.length;r++)i.push(a[r]);return i}(t),n=0;n<i.length;n++)i[n].geometry&&i[n].geometry.index&&i[n].geometry.index.count<e.kolCount&&(a[i[n].geometry.uuid]=a[i[n].geometry.uuid]||[],a[i[n].geometry.uuid].push(i[n]))},this.moveObject=function(t,e,i,n){r(t,e,i,n)}}function C(t,e,i){this.type="LoadTime";var n,a=this;this.par=t,this.c3d=e,this.arr=i,this.mesh=i[0],this.geom=i[0].geometry,this.mate=i[0].material;var s=!0;this.initLoad=function(){s=!1,a.mate&&null!=a.mate.idObj&&0==a.mate.loadTexure&&(s=!0),0==s?setTimeout(function(){a.initLoad()},50):a.creat()},this.creat=function(){for(var t=i.length-1;t>=0;t--)n=i[t],this.par.moveObject(n,e),n.parent.remove(n);this.meshCombined=new r(i),e.add(this.meshCombined);for(this.meshCombined._meshes,t=0;t<this.meshCombined.children.length;t++)this.meshCombined.children[t].castShadow=n.castShadow,this.meshCombined.children[t].receiveShadow=n.receiveShadow,this.meshCombined.children[t].renderOrder=n.renderOrder;this.par.killNull(e)},this.initLoad()}function T(){this.type="SliteGeom";var t;this.geometry,this.kol,this.ah=[],this.sah=0,this.sahMesh=0,this.creatGeom,this.ap=[],this.ai=[],this.auv=[],this.start=function(t){this.geometry=t,this.creatGeom=new THREE.BufferGeometry,this.sah=0,this.sahMesh=0,this.ap=[],this.ai=[],this.auv=[],this.sPosit()},this.sPosit=function(){for(var t=0;t<this.geometry.index.count;t++)null==this.ah[this.sah]&&(this.ah[this.sah]=new P),this.ah[this.sah].posOld.set(this.geometry.attributes.position.array[3*this.geometry.index.array[t]],this.geometry.attributes.position.array[3*this.geometry.index.array[t]+1],this.geometry.attributes.position.array[3*this.geometry.index.array[t]+2]),this.ah[this.sah].uv.set(this.geometry.attributes.uv.array[2*this.geometry.index.array[t]],this.geometry.attributes.uv.array[2*this.geometry.index.array[t]+1]),this.ah[this.sah].index=this.geometry.index.array[t],this.sah++},this.setMesh=function(e){t=this.sahMesh*this.sah;for(var i=0;i<this.sah;i++)this.ah[i].setMesh(e),this.ap.push(this.ah[i].pos.x,this.ah[i].pos.y,this.ah[i].pos.z),this.auv.push(this.ah[i].uv.x,this.ah[i].uv.y),this.ai.push(this.ah[i].index+t);this.sahMesh++},this.final=function(){this.creatGeom.setIndex(this.ai),this.creatGeom.addAttribute("position",new THREE.BufferAttribute(new Float32Array(this.ap),3)),this.creatGeom.addAttribute("uv",new THREE.BufferAttribute(new Float32Array(this.auv),2)),this.creatGeom.attributes.position.needsUpdate=!0,this.creatGeom.attributes.uv.needsUpdate=!0,this.creatGeom.computeVertexNormals(),this.creatGeom.attributes.normal.needsUpdate=!0,this.creatGeom.computeBoundingBox(),this.creatGeom.computeBoundingSphere()}}function P(){this.type="SliteGeom",this.pos=new THREE.Vector3,this.posOld=new THREE.Vector3,this.uv=new THREE.Vector2,this.index=0,this.setMesh=function(t){this.pos.set(this.posOld.x,this.posOld.y,this.posOld.z),this.pos.applyMatrix4(t.matrix)}}function M(t){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function S(t,e,i){this.type="PMFilt";var n,a,r,s=this;this.par=t,this.visi3D=e,this.objbase=i,this.setHron=function(t,e){var i,n;i=t.object.iz,n=t.content3d,e&&(n=e),null!=n&&null!=i&&1==i.a&&this.setMod(n,this.strToObj(i.str),i.st)},this.strToObj=function(t){for(var e="",i=0;i<t.length;i++)"|"==t[i]?e+='"':e+=t[i];return JSON.parse(e)},this.getIz=function(t){if(n++,null!=t.iz){var e=0;null!=t.iz.renderOrder&&(0==e&&(e={}),e.renderOrder=t.iz.renderOrder),null!=t.iz.bs&&(0==e&&(e={}),e.bs=t.iz.bs),null!=t.iz.mod&&(0==e&&(e={}),e.mod=t.iz.mod),null!=t.iz.position&&(0==e&&(e={}),e.position=t.iz.position),null!=t.iz.scale&&(0==e&&(e={}),e.scale=t.iz.scale),null!=t.iz.rotation&&(0==e&&(e={}),e.rotation=t.iz.rotation),null!=t.iz.visible&&(0==e&&(e={}),e.visible=t.iz.visible),null!=t.iz.material&&(0==e&&(e={}),e.material=t.iz.material),0!=e&&(e.sah=n),a.push(e)}else a.push(0);if(t.children&&null==t.notPar)for(var i=0;i<t.children.length;i++)this.getIz(t.children[i])},this.getMod=function(t){return n=-1,a=[],this.getIz(t),a},this.setIz=function(t,e){if(r[++n]&&0!=r[n]){if(t.iz={},null!=r[n].mod){e&&(t.iz.mod=r[n].mod);for(var i=new THREE.Object3D,a=0,o=0;o<t.parent.children.length;o++)t.parent.children[o].uuid==t.uuid&&(a=o);i.notPar=!0,t.parent.add(i),t.parent.remove(t),i.parent.children.splice(i.parent.children.length-1,1),i.parent.children.splice(a,0,i),s.par.getId(r[n].mod,function(t){i.add(t)})}null!=r[n].renderOrder&&(e&&(t.iz.renderOrder=r[n].renderOrder),t.renderOrder=r[n].renderOrder),null!=r[n].bs&&(e&&(t.iz.bs=r[n].bs),t.bs=r[n].bs),null!=r[n].position&&(e&&(t.iz.position=r[n].position),t.position.set(r[n].position.x,r[n].position.y,r[n].position.z)),null!=r[n].scale&&(e&&(t.iz.scale=r[n].scale),t.scale.set(r[n].scale.x,r[n].scale.y,r[n].scale.z)),null!=r[n].rotation&&(e&&(t.iz.rotation=r[n].rotation),t.rotation.set(r[n].rotation.x,r[n].rotation.y,r[n].rotation.z)),null!=r[n].visible&&(e&&(t.iz.visible=r[n].visible),t.visible=r[n].visible),null!=r[n].material&&t.material&&(null==t.oldName&&(t.oldName=t.material.name),e&&(t.iz.material=r[n].material),t.material=s.par.mat.getIDReturn(r[n].material))}if(t.children&&null==t.notPar)for(o=0;o<t.children.length;o++)this.setIz(t.children[o])},this.setMod=function(t,e,i){"object"==M(e)&&null!=e[0]&&(r=e,n=-1,this.setIz(t,i))},this.setMat=function(t,e,i,n){if(null!=n&&(n=!0),null!=t.material&&(null==t.oldName&&(t.oldName=t.material.name),"string"==typeof e&&(e=this.par.mat.getIDReturn(e,n)),null==i?(t.material=e,null==t.iz&&(t.iz={}),t.iz.material=e.idUz):t.oldName&&-1!=t.oldName.indexOf(i)&&(t.material=e,null==t.iz&&(t.iz={}),t.iz.material=e.idUz)),t.children&&null==t.notPar)for(var a=0;a<t.children.length;a++)this.setMat(t.children[a],e,i,n)}}function F(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}THREE.ShaderChunk.begin_vertex=p,THREE.ShaderChunk.color_fragment=g,THREE.ShaderChunk.color_pars_fragment=m,THREE.ShaderChunk.color_vertex=x,THREE.ShaderChunk.defaultnormal_vertex=b,THREE.ShaderChunk.uv_pars_vertex=y;var D=function(){function t(e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="PMTexture",this.par=e,this.visi3D=i,this.objbase=n,this.loader=new THREE.TextureLoader,this.textureCache={},window.textureCache=this.textureCache}var e,i,n;return e=t,(i=[{key:"getById",value:function(t,e){var i=this;if(this.textureCache[t]&&this.textureCache[t].loaded)return e&&setTimeout(function(){return e(i.textureCache[t].texture)},0),this.textureCache[t].texture;var n=this.getObj(t);return this.loadTexture(n,e)}},{key:"loadTexture",value:function(t,e){var i=this;if(this.textureCache[t.id]&&this.textureCache[t.id].callbacks||(this.textureCache[t.id]={callbacks:[]}),!this.textureCache[t.id].texture){var n=window.location.href.split("/");n.pop();var a=n.join("/")+"/resources/data/"+t.id+"/pic."+t.type,r=this.loader.load(a,function(e){i.visi3D&&(i.visi3D.intRend=1),e.obj={},i.textureCache[t.id].callbacks.forEach(function(t){return t(e)}),delete i.textureCache[t.id].callbacks,i.textureCache[t.id].loaded=!0});r.arrMat=[],r.arrRun=[],r.wrapS=r.wrapT=THREE.RepeatWrapping,r.repeat.x=t.rx,r.repeat.y=t.ry,this.textureCache[t.id].texture=r}return e&&this.textureCache[t.id].callbacks.push(e),this.textureCache[t.id].texture}},{key:"updateTexture",value:function(t,e){var i=this;if(this.textureCache[t.id])if(e){var n=new Image,a=window.location.href.split("/");a.pop(),n.src=a.join("/")+"/resources/data/"+t.id+"/pic."+t.type,this.textureCache[t.id].texture.image=n,this.textureCache[t.id].loaded=!1,n.onload=function(){delete i.textureCache[t.id].callbacks,i.textureCache[t.id].loaded=!0,i.textureCache[t.id].texture.needsUpdate=!0}}else this.textureCache[t.id].texture.repeat.x=t.rx,this.textureCache[t.id].texture.repeat.y=t.ry}},{key:"getObj",value:function(t){return this.objbase.textures.find(function(e){return e.id===t})||null}}])&&F(e.prototype,i),n&&F(e,n),t}();function R(t){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function B(t,e){this.type="PM";var i;this.objbase=e,this.visi3D=t,this.plus="?1",this.loaderGLTF=new THREE.GLTFLoader,this.tex=new D(this,t,e),this.mat=new n.a(this,t,e),this.filt=new v(this,t,e),this.iz=new S(this,t,e),this.matDop=new a(this,t,e),this.arrayHron=[],this.getId=function(t,e,i){if(1==i)for(var n=0;n<this.arrayHron.length;n++)1==this.arrayHron[n].testId(t)&&this.arrayHron.splice(n,1);for(n=0;n<this.arrayHron.length;n++)if(1==this.arrayHron[n].testId(t))return void this.arrayHron[n].setFun(e);this.arrayHron.push(new j(this,t,e))},this.getThreeName=function(t){for(var n=0;n<e.three.length;n++)if(null!=(i=this.gTN(e.three[n],t)))return i;return null},this.gTN=function(t,e){if(t.keyName){if(t.keyName==e)return t;if(t.array)for(var i=0;i<t.array.length;i++)if(null!=this.gTN(t.array[i],e))return t.array[i]}return null},this.clear=function(){}}function j(t,e,i){this.type="Hron";var n,a,r=this;this.par=t,this.idObj=e,this.id=void 0,this.object=void 0,this.link=void 0,this.filt=void 0,this.content3d=void 0,this.array=[],this.array.push(i),this.boolClone=!0,this.setFun=function(t){if(null!=this.content3d)return(n=1==r.boolClone?r.content3d.clone():r.content3d).hron=this,this.par.iz.setHron(this,n),this.object.param&&this.par.filt.dragParam(n,this.object.param),void t(n);this.array.push(t)},this.finalLoad=function(t){this.getObj3D(t),this.content3d=t,t.name="hron_"+this.id,this.par.mat.setObjS(this.content3d,this.object,this.finalLoad1)},this.finalLoad1=function(){r.par.filt.setObjS(r,r.finalLoad2)},this.finalLoad2=function(){for(var t=0;t<r.array.length;t++)(n=1==r.boolClone?r.content3d.clone():r.content3d).hron=r,r.par.iz.setHron(r,n),r.object.param&&r.par.filt.dragParam(n,r.object.param),r.array[t](n)},this.start=function(t){this.object=t,null!=this.object.param.clone&&0==this.object.param.clone&&(this.boolClone=!1),this.id=t.id,this.link="resources/data/"+this.id+"/mod/"+this.object.mod.name,"n"==this.object.mod.name?this.finalLoad(new THREE.Mesh(new THREE.BoxBufferGeometry(100,100,100))):this.par.loaderGLTF.load(this.link,function(t){r.finalLoad(t.scene)})},this.testId=function(t){return a="number"==typeof t?t:t.id,(null==this.id?this.idObj.id:this.id)==a},this.getObj3D=function(e){if(null!=e.material&&null!=e.material.roughnessMap&&t.visi3D&&(e.material.envMap=t.visi3D.cubeMap.getTexture()),null!=e){if(null!=e.children)for(var i=e.children.length-1;i>=0;i--)this.getObj3D(e.children[i]);"Default_light"==e.name&&e.parent.remove(e)}},"object"!=R(e)?"number"==typeof e&&$.ajax({url:"resources/data/"+e+"/config.json"+r.par.plus,success:function(t){"string"==typeof t?r.start(JSON.parse(t)):r.start(t)},error:function(t){console.log("Что то случилось с конфигом")}}):this.start(e)}i.d(e,"a",function(){return B})},function(t,e,i){"use strict";function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MOBaza",this.typeNa="xz";var n=this;this.par=e,this.fun=i,this._active=!1,this.otstup=this.par.otstup,this.otstup1=this.par.otstup,this.wh=this.par.wh,this.width=200,this.whSize=this.par.whSize,this.dCont=new DCont(e.dCont),this.dCont.visible=this._active,this.object=void 0,this.postSO=void 0,this.postIn=void 0,this.init=function(){null==this.window&&(this.whSize=this.par.whSize,this.window=new DWindow(this.dCont,0,0,"xz"),this.window.width=this.width,this.window.hasMinimizeButton=!1,this.window.dragBool=!1,this.buttonClose=new DButton(this.window,2,2,"",function(){n.active=!1,n.sp.setActive()},"resources/image/close.png"),this.buttonClose.width=this.buttonClose.height=28,this.buttonClose.x=this.width-this.buttonClose.width-2,this.buttonClose.boolFond=!1,null!=this.postIn&&this.postIn())},this.setObject=function(t){this.object=t,this.active=!0,this.init(),null!=this.postSO&&this.postSO()},this.sp=void 0,this.setSP=function(t){this.sp=t},this.drag=function(){},this.clear=function(){this.active=!1},this.deleteObj=function(){null!=this.object&&null!=this.object.clear&&(this.object.clear(),this.active=!1)}}var e,i,a;return e=t,(i=[{key:"active",set:function(t){this._active!=t&&(this._active=t,this.dCont.visible=t)},get:function(){return this._active}}])&&n(e.prototype,i),a&&n(e,a),t}();function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function A(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var l=function(t){function e(t,i){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?A(t):e}(this,o(e).call(this,t,i))).type="MOPalka",n.typeNa="CPalka";var a=A(A(n));return n.whSize=5555555,n.dCont=new DCont(t.dCont),n.button=void 0,n.slid,n.slid1,n.bool=!0,n.postIn=function(){this.window.title=this.typeNa,this.pObject=new DParamObject(this.window.content,2,2,function(){a.drag(),t.par.fun("visi3D")},!0),this.pObject.width=this.window.width},n.drag=function(){},n.postSO=function(){this.bool=!0,trace(),this.pObject.addObject(this.object),this.window.height=this.pObject.height+32+this.otstup,this.window.title=this.typeNa+" : "+this.object.idArr,this.drag()},n.clear=function(){null!=this.object&&(this.bool=!0,this.object.funDragMenu=void 0),this.active=!1},n.sizeWindow=function(t,e,i){this.dCont.x=t/i-this.width},n}var i,n,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(e,a),i=e,(n=[{key:"index",set:function(t){this._index!=t&&(this._index=t)}}])&&s(i.prototype,n),l&&s(i,l),e}();i.d(e,"a",function(){return u});var u=function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MObject";this.par=e,this.fun=i,this.otstup=2,this.otstup1=10,this.wh=64,this.width=222,this.whSize=1e3,this.dCont=new DCont(e.dCont),this.dCont.y=this.wh+4*this.otstup,this.perehvat,this.array=[],this.array[0]=this.moPoint=new l(this,function(t,e){}),this.clear=function(){for(var t=0;t<this.array.length;t++)this.array[t].clear()},this.clearActive=function(){for(var t=0;t<this.array.length;t++)this.array[t].active=!1},this.setObject=function(t){if(null!=this.perehvat)return this.perehvat(t),void(this.perehvat=void 0);if(this.clear(),t)for(var e=0;e<this.array.length;e++)this.array[e].typeNa==t.type&&(this.array[e].setObject(t),this.dCont.visible=!0)},this.keydown=function(t){if(46==t.keyCode)for(var e=this.array.length-1;e>=0;e--)1==this.array[e].active&&this.array[e].deleteObj()},this.keyup=function(t){},this.sp=void 0,this.setSP=function(t){this.sp=t;for(var e=0;e<this.array.length;e++)this.array[e].setSP(t)},this.sizeWindow=function(t,e,i){this.dCont.x=t/i-this.width-this.otstup}}},function(t,e,i){"use strict";function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n=this;this.par=e,this.fun=i,this.dC=e.dCont,this.param=this.par.param,this.otstup=2,this.dCont=new DCont(this.dC),this._active=!1,this.pan=new DPanel(this.dCont,0,0),this.pan.width=300;var a=new DParamObject(this.pan,2,250,function(t){n.par.par.par.dragParam(),n.par.par.par.par.localStorage.object=n.param,n.par.par.par.par.localStorage.save(),t&&t.param&&"debug"==t.param&&setTimeout(function(){location.reload()},10)});a.tipRide=!0,a.addObject(this.param);var r=new DParamObject(this.pan,2,2,function(){},!0);this.activeObject=void 0,this.setActiveObject=function(t){this.activeObject=t,r.addObject(t)}}var e,i,a;return e=t,(i=[{key:"active",set:function(t){this._active!=t&&(this._active=t,this.pan.visible=this._active)},get:function(){return this._active}}])&&n(e.prototype,i),a&&n(e,a),t}();function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);this.type="DevCtrl",this.par=e,this.fun=i,this.dC=e.dCont,this.param=this.par.param,this.dCont=new DCont(this.dC),this._active=!1,this.pan=new DPanel(this.dCont,0,0),this.pan.width=300}var e,i,n;return e=t,(i=[{key:"init",value:function(){var t=this;this.btn=new DButton(this.pan,2,2,"GetArrInfo",function(e,i,n){t.world.getArrayInfo()})}},{key:"transferObj",value:function(t){trace("adsfasf"),t&&(this.world=t),this.init()}},{key:"active",set:function(t){this._active!=t&&(this._active=t,this.pan.visible=this._active)},get:function(){return this._active}}])&&r(e.prototype,i),n&&r(e,n),t}();i.d(e,"a",function(){return o});var o=function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MDev";var n=this;if(this.par=e,this.fun=i,this.param=this.par.param,this.setActiveObject=function(t){this.dCont&&this.devCupboard.setActiveObject(t)},0!=this.param.debug)this.dCont=new DCont(e.dCont),this.dCompDev=new DCompDev(this.dCont,0,0,"DevWindow",function(t,e,i){}),this.dCompDev.x=-50,this.dCompDev.y=300,this.devCupboard=new a(this,function(t,e,i){}),this.dCompDev.addCont(this.devCupboard,this.devCupboard.dCont,"ActDev",300,400),this.dCompDev.index=2,this.devCtrl=new s(this,function(t,e,i){}),this.dCompDev.addCont(this.devCtrl,this.devCtrl.dCont,"Ctrl",300,400),this.dCompDev.index=3,this.transferObj=function(t){trace("#####",this.devCtrl)},trace("%%%%%%%%%%%%%%%%%%%%%%%%%%%%%");else new DCheckBox(e.mTop.dCont,200,10,"debug",function(){n.par.par.par.localStorage.object.debug=this.value,n.par.par.par.localStorage.save(),setTimeout(function(){location.reload()},10)})}},function(t,e,i){"use strict";function n(){this.event=void 0,this.arrSobName=["up","down","move","out","over","wheel"],this.arrSob=[[],[],[],[],[],[]],this.pozSob=void 0,this.dispatcherEvent=function(t,e){for(var i=0;i<this.arrSobName.length;i++)if(this.arrSobName[i]==t){e&&(e.type=t);for(var n=0;n<this.arrSob[i].length;n++)this.arrSob[i][n](e)}},this.removeEvent=function(t,e){for(var i=0;i<this.arrSobName.length;i++)if(this.arrSobName[i]==t)for(var n=0;n<this.arrSob[i].length;n++)this.arrSob[i][n]==e&&this.arrSob[i].splice(n,1)},this.addEvent=function(t,e){for(var i=0;i<this.arrSobName.length;i++)this.arrSobName[i]==t&&this.arrSob[i].push(e)}}function a(){this.target=void 0,this.face=void 0,this.point=void 0,this.faceIndex=void 0,this.type=void 0,this.uv=void 0,this.originalEvent=void 0,this.copy=function(){var t=new a;return t.target=this.target,t.face=this.face,t.point=this.point,t.faceIndex=this.faceIndex,t.type=this.type,t.uv=this.uv,t.originalEvent=this.originalEvent,t}}function r(t,e,i,r){this.parent=t;var s,o,h=this;this.camera=e,this.raycaster=new THREE.Raycaster,this.intersects,this.devas=t.devas,this.point=new THREE.Vector2(0,0),this.pointWH=new THREE.Vector2(0,0),this.arrChild=[],this.uuid="nullMy",this.obj3d,this.eventSob=new n,this.event3D=new a,this.xzNull="xzNull",this.poiskName="xzPoisk",this.tokoName="null",this._activ=!0,this.rect={x:0,y:0,width:100,height:100},this.cont=void 0,this.div=void 0,this.setRect=function(t,e,i,n){this.rect.x=t,this.rect.y=e,this.rect.width=i,this.rect.height=n},this.removeChild=function(t){s=null;for(var e=0;e<this.arrChild.length;e++)t.uuid==this.arrChild[e].uuid&&(s=this.arrChild.splice(e,1),(e-=1)<0&&(e=0));return s},this.addChild=function(t){this.removeChild(t),this.arrChild.push(t)},this.boolNum=-1,this.boolNumOld=-1,this.event,this.mouseRay=function(){0!=this._activ&&(this.rayPusk(),this.boolNum=this.getGoodParam(),-1==this.boolNum?"nullMy"!=this.uuid&&(this.eventSob.dispatcherEvent("out",this.event3D),this.uuid="nullMy"):"nullMy"!=this.uuid?this.uuid!=this.intersects[this.boolNum].object.uuid?(this.eventSob.dispatcherEvent("out",this.event3D),this.uuid=this.intersects[this.boolNum].object.uuid,this.event3D.target=this.intersects[this.boolNum].object,this.event3D.face=this.intersects[this.boolNum].face,this.event3D.point=this.intersects[this.boolNum].point,this.event3D.faceIndex=this.intersects[this.boolNum].faceIndex,this.event3D.uv=this.intersects[this.boolNum].uv,this.event3D.originalEvent=h.event,this.eventSob.dispatcherEvent("over",this.event3D)):(this.event3D.face=this.intersects[this.boolNum].face,this.event3D.point=this.intersects[this.boolNum].point,this.event3D.faceIndex=this.intersects[this.boolNum].faceIndex,this.event3D.uv=this.intersects[this.boolNum].uv,this.event3D.originalEvent=h.event,this.eventSob.dispatcherEvent("move",this.event3D)):(this.uuid=this.intersects[this.boolNum].object.uuid,this.event3D.target=this.intersects[this.boolNum].object,this.event3D.face=this.intersects[this.boolNum].face,this.event3D.point=this.intersects[this.boolNum].point,this.event3D.faceIndex=this.intersects[this.boolNum].faceIndex,this.event3D.uv=this.intersects[this.boolNum].uv,this.event3D.originalEvent=h.event,this.eventSob.dispatcherEvent("over",this.event3D)),this.boolNumOld=this.boolNum)},this.getPosition=function(t){var e=this.poiskName;if(this.poiskName=null!=t?t:"xzPoisk",this.restartPoint(),this.rayPusk(),this.poiskName=e,0!=this.intersects.length){var i=this.intersects.length-1;return-1==i&&(i=0),this.intersects[i]}return null};var A=new a;this.getNameEvent=function(t){if(this.restartPoint(),this.rayPusk(),0!=this.intersects.length)for(var e=0;e<this.intersects.length;e++)if(null!=this.intersects[e].object.parent&&this.intersects[e].object.name==t)return A.target=this.intersects[this.boolNum].object,A.face=this.intersects[this.boolNum].face,A.point=this.intersects[this.boolNum].point,A.faceIndex=this.intersects[this.boolNum].faceIndex,A.uv=this.intersects[this.boolNum].uv,A.originalEvent=h.event,A;return null},this.testVisiParam=function(t){return 0!=t.visible&&(!t.notEvent&&(null!=t.parent?this.testVisiParam(t.parent):"Scene"==t.type))},this.getGoodParam=function(){if(0!=this.intersects.length){var t;for(t=0;t<this.intersects.length;t++)0!=this.testVisiParam(this.intersects[t].object)&&null!=this.intersects[t].object.notActiv&&(this.intersects.splice(t,1),t=0);if(0==this.intersects.length)return-1;for(t=0;t<this.intersects.length;t++)if(0!=this.testVisiParam(this.intersects[t].object)&&this.intersects[t].object.name==this.poiskName)return t;for(t=0;t<this.intersects.length;t++)if(0!=this.testVisiParam(this.intersects[t].object)&&this.intersects[t].object.name!=this.xzNull)return t}return-1},this.rayPusk=function(){(o=new THREE.Vector3).setFromMatrixPosition(this.camera.matrixWorld),this.raycaster.ray.origin.copy(o),this.raycaster.ray.direction.set(this.point.x,this.point.y,.5).unproject(this.camera).sub(o).normalize(),this.intersects=this.raycaster.intersectObjects(this.arrChild,!0)},this.naCont=!1,this.mousemove=function(t){0==h.devas&&0==h.naCont||(null!=t.data?h.event=t.data.originalEvent:h.event=t,0!=h._activ&&(h.restartPoint(t),h.mouseRay(),h.intersects.length&&0==h.devas&&h.event.preventDefault()))},this.zdvigX=0,this.scale=1,this.pV=new THREE.Vector2(0,0);var l={x:0,y:0};this.restartPoint=function(t){t&&t.target&&(l=t.target.getBoundingClientRect()),0==h.devas?(h.pV.x=t.clientX,h.pV.y=t.clientY):(h.pV.x=t.touches[0].clientX,h.pV.y=t.touches[0].clientY),h.pV.x-=l.x,h.pV.y-=l.y,1==h.isRect(h.pV)?(h.point.x=-(this.rect.x-h.pV.x)/this.rect.width*2-1,h.point.y=-(-(this.rect.y-h.pV.y)/this.rect.height*2-1)):99999!=h.point.x&&(h.point.x=99999)},this.isRect=function(t){return t.x>=this.rect.x&&t.x<=this.rect.x+this.rect.width&&t.y>=this.rect.y&&t.y<=this.rect.y+this.rect.height},this.mouseup=function(t){null!=t.data?h.event=t.data.originalEvent:h.event=t,h.intersects&&0!=h._activ&&(0==h.devas?(-1==h.boolNumOld?h.eventSob.dispatcherEvent("up",null):(h.event3D.originalEvent=h.event,h.eventSob.dispatcherEvent("up",h.event3D)),h.intersects.length&&h.event.preventDefault()):(h.mouseRay(),-1==h.boolNumOld?h.eventSob.dispatcherEvent("up",null):(h.event3D.originalEvent=h.event,h.eventSob.dispatcherEvent("up",h.event3D),h.uuid="nullMy")))},this.mousedown=function(t){null!=t.data?h.event=t.data.originalEvent:h.event=t,h.restartPoint(t),0!=h._activ&&(0==h.devas?(-1==h.boolNumOld?h.eventSob.dispatcherEvent("down",null):(h.event3D.originalEvent=h.event,h.eventSob.dispatcherEvent("down",h.event3D)),h.intersects.length&&h.event.preventDefault()):(h.mouseRay(),-1==h.boolNumOld?h.eventSob.dispatcherEvent("down",null):(h.event3D.originalEvent=h.event,h.eventSob.dispatcherEvent("down",h.event3D))))},this.mouseout=function(t){h.naCont=!1,h.restartPoint(t),h.point.x=99999,h.mouseRay()},this.mouseover=function(t){h.naCont=!0,h.restartPoint(t),h.mouseRay()},this.touchend=function(t){},this.mousewheel=function(t){null!=t.data?h.event=t.data.originalEvent:h.event=t,h.restartPoint(t),0!=h._activ&&(-1==h.boolNumOld?h.eventSob.dispatcherEvent("down",null):(h.event3D.originalEvent=h.event,h.eventSob.dispatcherEvent("wheel",t)))},this.addDragEvent=function(t,e){this.cont=t,this.div=e,0==h.devas?(window.addEventListener("mouseup",h.mouseup),e.addEventListener("mousedown",h.mousedown),e.addEventListener("mouseout",h.mouseout),e.addEventListener("mouseover",h.mouseover)):(window.addEventListener("touchend",h.mouseup),e.addEventListener("touchstart",h.mousedown))},this.sizeWindow=function(t,e){this.pointWH.x=t,this.pointWH.y=e}}i.d(e,"a",function(){return r}),r.prototype={set activ(t){this._activ!=t&&(this._activ=t)},get activ(){return this._activ}}},function(t,e,i){"use strict";function n(t){var e,i;function n(t){var e=window.document.URL.toString();e.split("/");if(e.indexOf("?")>0){var i=e.split("?")[1].split("&"),n=new Array(i.length),a=new Array(i.length);i=e.split("?")[1].split("&"),n=new Array(i.length),a=new Array(i.length);var r=0;for(r=0;r<i.length;r++){var s=i[r].split("=");n[r]=s[0],""!=s[1]?a[r]=unescape(s[1]):a[r]=null}for(r=0;r<i.length;r++)if(n[r]==t)return a[r];return null}}this.ser=window.location.href,this.server=void 0,this.server2=void 0,this.id=null,this.key=null,this.url=null,this.urlSave=null,this.aS,this.init=function(){e=this.ser.split("?"),this.server2=e[0],i=e[0].split("/"),this.aS=i,this.server="";for(var t=0;t<i.length-1;t++)this.server+=i[t]+"/";this.id=n("id"),this.key=n("key"),this.url=n("url"),this.urlSave=n("urlSave")},this.load=function(t,e){var i=this.server+"src/phpBase.php";$.post(i,t,function(t){e&&e(t)})},this.savePhoto=function(t,e,i){var n=this.server+"src/forModel.php";$.post(n,{file:t,image:e},function(){i&&i()})},this.init()}i.d(e,"a",function(){return a});var a=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="ViewServer";var i=this;this.fun=e,this.id=void 0;var a=new n;this.openId=function(t){this.id=t;var e="save/"+t+"/config.json";$.ajax({url:e,success:function(t){var e;"string"==typeof t?e=JSON.parse(t):e=t;i.fun("setObj",e)},error:function(t){i.fun("message","Что то случилось с конфигом","Не верный ид==",i.id),console.error("Что то случилось с конфигом")}})},this.saveGetObjId=function(t){var e=JSON.stringify(t);if(null==this.id);else{var i="../save/"+this.id+"/config.json";a.load({tip:"saveJSON",link:i,text:e},function(t){trace("sdfdfd",t)})}},this.openURL=function(){var t=function(t,e){var i=window.document.URL.toString();e&&(i=e);var n=i.split("/");if(i.indexOf("?")>0){var n=i.split("?"),a=n[1].split("&"),r=new Array(a.length),s=new Array(a.length);n=i.split("?"),a=n[1].split("&"),r=new Array(a.length),s=new Array(a.length);var o=0;for(o=0;o<a.length;o++){var h=a[o].split("=");r[o]=h[0],""!=h[1]?s[o]=unescape(h[1]):s[o]=null}for(o=0;o<a.length;o++)if(r[o]==t)return s[o];return null}}("id");null!=t?this.openId(t):i.fun("openStart")}}},function(t,e,i){"use strict";i.r(e),function(t){var n=i(4);i.d(e,"Main",function(){return n.a}),t.Main=n.a}.call(this,i(0))},function(module,__webpack_exports__,__webpack_require__){"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}var MenedsherMaterial=function(){function t(e,i){_classCallCheck(this,t),this.type="MenedsherMaterial",window.menedsherMaterial=this;this.fun=i,this.par=e,this.geterMat,this._materialBase=void 0,this.setConfig=function(t,e,i){this.geterMat=new GeterMat(t,e,i,this)},this.getArrOtObj=function(t,e,i){if(t&&t.info&&t.info.color[e])return[t.info.color[e].art,t.info.text,t.info.size,t.info.color[e].pri,t.info.color[e].niz];if(0==i&&null!=t.plus){for(var n=[],a=0;a<t.plus.length;a++)n[a]=t.plus[a];return n}if(1==i&&null!=t.plus1){var r=[];for(a=0;a<t.plus1.length;a++)r[a]=t.plus1[a];return r}return null}}return _createClass(t,[{key:"materialBase",set:function(t){this._materialBase=t},get:function(){return this._materialBase}}]),t}();function GeterMat(visi3D,matarialArray,linkServ,par){var self=this;this.par=par,this.type="GeterMat",this.visi3D=visi3D,this.matarialArray=matarialArray.materials;var matarialArray=this.matarialArray;this.idColor=null;var loader=new THREE.TextureLoader,rt,textur;this.obj={},this.getTestTitle=function(t,e){var i,n=null;if(null!=t)for(var a=0;a<matarialArray.length;a++)if(i=!0,null==e&&-1!=t.indexOf("base")&&(i=!1),i&&-1!=t.indexOf(matarialArray[a].title))return n=this.getIDReturn(matarialArray[a].id);return n},this.getTestTitleObj=function(t,e){t.material&&(null!=e?(rt=this.getIDReturn(e))&&(t.material=rt):(rt=this.getTestTitle(t.material.name))&&(t.material=rt));for(var i=0;i<t.children.length;i++)this.getTestTitleObj(t.children[i],e)},this.getIDReturn=function(id){for(var r=null,p=-1,i=0;i<matarialArray.length;i++)matarialArray[i].id==id&&(p=i);if(-1==p)return null;if(null!=this.obj[id])return this.obj[id];var comand="new THREE."+matarialArray[p].key+"()",m=eval(comand);return m.idObj=matarialArray[p],this.startMat(m,id),this.obj[id]=m,m.idUz=id,m},this.get=function(t,e,i){var n,a,r=-1;if(null!=i){n=t+"",t="2456567567867896789";for(var s=0;s<this.matarialArray.length;s++)if(a=this.matarialArray[s].title+"",-1!=n.indexOf(a)){t=this.matarialArray[s].title;break}}for(s=0;s<this.matarialArray.length;s++)this.matarialArray[s].title==t&&(r=s);-1!=r?this.getId(this.matarialArray[r].id,e):e(null)},this.getId=function(id,_fun){for(var p=-1,i=0;i<this.matarialArray.length;i++)if(this.matarialArray[i].id==id){p=i;break}if(-1!=p){if(null!=this.obj[id])return 1==this.obj[id].bLoad?_fun(this.obj[id]):this.obj[id].arrFun&&this.obj[id].arrFun.push(_fun),this.obj[id];var sadsfdg=1,comand="new THREE."+this.matarialArray[p].key+"()",m=eval(comand);return m.idObj=matarialArray[p],m.bLoad=!1,m.arrFun=[_fun],this.startMat(m,id),this.obj[id]=m,m}_fun(null)},this.objToMater=function(t,e){for(var i in t)null!=e[i]&&(e[i]instanceof THREE.Color?e[i]=new THREE.Color(t[i]):e[i]=t[i]);if(t.textur)for(var n=0;n<t.textur.length;n++)(textur=loader.load(t.textur[n].link,function(){self.visi3D.intRend=1})).wrapS=textur.wrapT=THREE.RepeatWrapping,textur.repeat.x=t.textur[n].rx,textur.repeat.y=t.textur[n].ry,e[t.textur[n].name]=textur;if(e.needsUpdate=!0,e.bLoad=!0,e.arrFun)for(n=0;n<e.arrFun.length;n++)e.arrFun[n](e)},this.startMat=function(t,e){var i,n=linkServ+"/resources/data/"+e+"/config.json"+self.par.par.par.par.par.par.plus;$.ajax({url:n,success:function(e){if("string"==typeof e){var n=JSON.parse(e);i=n}else i=e;1==i.mirro&&(t.envMap=self.visi3D.getEnvMap()),self.objToMater(i.obj,t)},error:function(t){self.start()}})}}}]);